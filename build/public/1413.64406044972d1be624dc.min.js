(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1413,7214,6503,6027,3014,9743,3230,588,2735,882,560,3382,71,999,3034,9191,3564,831,7927,7913,7804,5482],{7927:(w,y,u)=>{"use strict";var v,h;v=[u(32230),u(7237),u(85233)],h=function(f,c,d){const s={};s.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?r(n,e):m(e)},s.success=function(e,n){s.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:n||5e3})},s.error=function(e,n){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}s.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:n||1e4})},s.remove=function(e){$("#alert_button_"+e).remove()};function m(e){app.parseAndTranslate("alert",e,function(n){let t=$("#"+e.alert_id);if(t.length)return r(t,e);t=n,t.fadeIn(200),c.get("toaster/tray").prepend(t),typeof e.closefn=="function"&&t.find("button").on("click",function(){return e.closefn(),a(t),!1}),e.timeout&&l(t,e),typeof e.clickfn=="function"&&t.addClass("pointer").on("click",function(o){$(o.target).is(".close")||e.clickfn(t,e),a(t)}),d.fire("action:alert.new",{alert:t,params:e})})}function r(e,n){e.find("strong").translateHtml(n.title),e.find("p").translateHtml(n.message),e.attr("class","alert alert-dismissable alert-"+n.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),n.timeout&&l(e,n),d.fire("action:alert.update",{alert:e,params:n}),e.off("click").removeClass("pointer"),typeof n.clickfn=="function"&&e.addClass("pointer").on("click",function(t){$(t.target).is(".close")||n.clickfn(),a(e)})}function a(e){e.fadeOut(500,function(){$(this).remove()})}function l(e,n){const t=n.timeout,o=setTimeout(function(){a(e),typeof n.timeoutfn=="function"&&n.timeoutfn(e,n)},t);e.attr("timeoutId",o),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(t+450)+"ms linear, background-color "+(t+450)+"ms ease-in"),e.addClass("animate"),d.fire("action:alert.animate",{alert:e,params:n})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return s}.apply(y,v),h!==void 0&&(w.exports=h)},74344:(w,y,u)=>{"use strict";var v,h;v=[u(85233)],h=(f=>{const c={},d=config.relative_path+"/api/v3";function s(m,r){m.url=m.url.startsWith("/api")?config.relative_path+m.url:d+m.url;async function a(l){({options:m}=await f.fire("filter:api.options",{options:m})),$.ajax(m).done(e=>{l(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})}).fail(e=>{let n;e.responseJSON&&(n=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),l(new Error(n||e.statusText))})}if(typeof r=="function"){a(r);return}return new Promise((l,e)=>{a(function(n,t){n?e(n):l(t)})})}return c.get=(m,r,a)=>s({url:m+(r&&Object.keys(r).length?"?"+$.param(r):"")},a),c.head=(m,r,a)=>s({url:m+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"head"},a),c.post=(m,r,a)=>s({url:m,method:"post",data:JSON.stringify(r||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),c.patch=(m,r,a)=>s({url:m,method:"patch",data:JSON.stringify(r||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),c.put=(m,r,a)=>s({url:m,method:"put",data:JSON.stringify(r||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),c.del=(m,r,a)=>s({url:m,method:"delete",data:JSON.stringify(r),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),c.delete=c.del,c}).apply(y,v),h!==void 0&&(w.exports=h)},7237:(w,y,u)=>{"use strict";var v;v=function(){const h={};return h.core={"topic/teaser":function(f){return f?$('[component="category/topic"][data-tid="'+f+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(f,c){return $('[component="topic"][data-'+f+'="'+c+'"]')},post:function(f,c){return $('[component="post"][data-'+f+'="'+c+'"]')},"post/content":function(f){return $('[component="post"][data-pid="'+f+'"] [component="post/content"]')},"post/header":function(f){return $('[component="post"][data-pid="'+f+'"] [component="post/header"]')},"post/anchor":function(f){return $('[component="post"][data-index="'+f+'"] [component="post/anchor"]')},"post/vote-count":function(f){return $('[component="post"][data-pid="'+f+'"] [component="post/vote-count"]')},"post/bookmark-count":function(f){return $('[component="post"][data-pid="'+f+'"] [component="post/bookmark-count"]')},"user/postcount":function(f){return $('[component="user/postcount"][data-uid="'+f+'"]')},"user/reputation":function(f){return $('[component="user/reputation"][data-uid="'+f+'"]')},"category/topic":function(f,c){return $('[component="category/topic"][data-'+f+'="'+c+'"]')},"categories/category":function(f,c){return $('[component="categories/category"][data-'+f+'="'+c+'"]')},"chat/message":function(f){return $('[component="chat/message"][data-mid="'+f+'"]')},"chat/message/body":function(f){return $('[component="chat/message"][data-mid="'+f+'"] [component="chat/message/body"]')},"chat/recent/room":function(f){return $('[component="chat/recent/room"][data-roomid="'+f+'"]')}},h.get=function(){const f=Array.prototype.slice.call(arguments,1);return h.core[arguments[0]]&&f.length?h.core[arguments[0]].apply(this,f):$('[component="'+arguments[0]+'"]')},h}.call(y,u,y,w),v!==void 0&&(w.exports=v)},47913:(w,y,u)=>{w.exports=u(66485)},45482:(w,y,u)=>{w.exports=u(35729)},83713:(w,y,u)=>{w.exports=u(51077)},38259:(w,y,u)=>{w.exports=u(65616)},11120:w=>{"use strict";w.exports=function(y,u,v){u.setGlobal("true",!0),u.setGlobal("false",!1);const h={displayMenuItem:c,buildMetaTag:d,buildLinkTag:s,stringify:m,escape:r,stripTags:a,generateCategoryBackground:l,generateChildrenCategories:e,generateTopicClass:n,membershipBtn:t,spawnPrivilegeStates:o,localeToHTML:p,renderTopicImage:b,renderTopicEvents:F,renderEvents:S,renderDigestAvatar:N,userAgentIcons:A,buildAvatar:I,register:C,__escape:f};function f(i){return i}function c(i,g){const E=i.navigation[g];return!(!E||E.route.match("/users")&&i.user&&!i.user.privileges["view:users"]||E.route.match("/tags")&&i.user&&!i.user.privileges["view:tags"]||E.route.match("/groups")&&i.user&&!i.user.privileges["view:groups"])}function d(i){const g=i.name?'name="'+i.name+'" ':"",E=i.property?'property="'+i.property+'" ':"",x=i.content?'content="'+i.content.replace(/\n/g," ")+'" ':"";return"<meta "+g+E+x+`/>
	`}function s(i){const g=["link","rel","as","type","href","sizes","title","crossorigin"],[E,x,T,k,P,R,z,B]=g.map(D=>i[D]?`${D}="${i[D]}" `:"");return"<link "+E+x+T+k+R+z+P+B+`/>
	`}function m(i){return JSON.stringify(i).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function r(i){return y.escapeHTML(i)}function a(i){return y.stripHTMLTags(i)}function l(i){if(!i)return"";const g=[];return i.bgColor&&g.push("background-color: "+i.bgColor),i.color&&g.push("color: "+i.color),i.backgroundImage&&(g.push("background-image: url("+i.backgroundImage+")"),i.imageClass&&g.push("background-size: "+i.imageClass)),g.join("; ")+";"}function e(i){let g="";return!i||!i.children||!i.children.length||(i.children.forEach(function(E){if(E&&!E.isSection){const x=E.link?E.link:v+"/category/"+E.slug;g+='<span class="category-children-item pull-left"><div role="presentation" class="icon pull-left" style="'+l(E)+'"><i class="fa fa-fw '+E.icon+'"></i></div><a href="'+x+'"><small>'+E.name+"</small></a></span>"}}),g=g&&'<span class="category-children">'+g+"</span>"),g}function n(i){return["locked","pinned","deleted","unread","scheduled"].filter(E=>!!i[E]).join(" ")}function t(i){return i.isMember&&i.name!=="administrators"?'<button class="btn btn-danger" data-action="leave" data-group="'+i.displayName+'"'+(i.disableLeave?" disabled":"")+'><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>':i.isPending&&i.name!=="administrators"?'<button class="btn btn-warning disabled"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>':i.isInvited?'<button class="btn btn-link" data-action="rejectInvite" data-group="'+i.displayName+'">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="'+i.name+'"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>':!i.disableJoinRequests&&i.name!=="administrators"?'<button class="btn btn-success" data-action="join" data-group="'+i.displayName+'"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>':""}function o(i,g){const E=[];for(const x in g)g.hasOwnProperty(x)&&E.push({name:x,state:g[x]});return E.map(function(x){const T=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],k=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],P=["groups:moderate"],R=i==="guests"&&(T.includes(x.name)||x.name.startsWith("groups:admin:"))||i==="spiders"&&!k.includes(x.name)||i==="Global Moderators"&&P.includes(x.name);return'<td class="text-center" data-privilege="'+x.name+'" data-value="'+x.state+'"><input autocomplete="off" type="checkbox"'+(x.state?" checked":"")+(R?' disabled="disabled"':"")+" /></td>"}).join("")}function p(i,g){return i=i||g||"en-GB",i.replace("_","-")}function b(i){return i.thumb?'<img src="'+i.thumb+'" class="img-circle user-img" title="'+i.user.username+'" />':'<img component="user/picture" data-uid="'+i.user.uid+'" src="'+i.user.picture+'" class="user-img" title="'+i.user.username+'" />'}function F(i,g){if(g==="most_votes")return"";const E=this.posts[i].eventStart,x=this.posts[i].eventEnd,T=this.events.filter(k=>k.timestamp>=E&&k.timestamp<x);return T.length?S.call(this,T):""}function S(i){return i.reduce((g,E)=>(g+=`<li component="topic/event" class="timeline-event" data-topic-event-id="${E.id}" data-topic-event-type="${E.type}">
				<div class="timeline-badge">
					<i class="fa ${E.icon||"fa-circle"}"></i>
				</div>
				<span class="timeline-text">
					${E.href?`<a href="${v}${E.href}">${E.text}</a>`:E.text}&nbsp;
				</span>
			`,E.user&&(E.user.system?g+='<span class="timeline-text">[[global:system-user]]</span>&nbsp;':g+=`<span><a href="${v}/user/${E.user.userslug}">${I(E.user,"xs",!0)}&nbsp;${E.user.username}</a></span>&nbsp;`),g+=`<span class="timeago timeline-text" title="${E.timestampISO}"></span>`,this.privileges.isAdminOrMod&&(g+=`&nbsp;<span component="topic/event/delete" data-topic-event-id="${E.id}" data-topic-event-type="${E.type} class="timeline-text pointer" title="[[topic:delete-event]]"><i class="fa fa-trash"></i></span>`),g),"")}function N(i){return i.teaser?i.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+i.teaser.user.picture+'" title="'+i.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+i.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+i.teaser.user["icon:text"]+"</div>":i.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+i.user.picture+'" title="'+i.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+i.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+i.user["icon:text"]+"</div>"}function A(i){let g="";switch(i.platform){case"Linux":g+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":g+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":g+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":g+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":g+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":g+='<i class="fa fa-fw fa-mobile"></i>';break;default:g+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(i.browser){case"Chrome":g+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":g+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":g+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":g+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":g+='<i class="fa fa-fw fa-edge"></i>';break;default:g+='<i class="fa fa-fw fa-question-circle"></i>';break}return g}function I(i,g,E,x,T){i||(i=this);const k=['alt="'+i.username+'"','title="'+i.username+'"','data-uid="'+i.uid+'"','loading="lazy"'],P=[];return x=x||"",["xs","sm","sm2x","md","lg","xl"].includes(g)?x+=" avatar-"+g:isNaN(parseInt(g,10))?x+=" avatar-sm":P.push("width: "+g+"px;","height: "+g+"px;","line-height: "+g+"px;","font-size: "+parseInt(g,10)/16+"rem;"),k.unshift('class="avatar '+x+(E?" avatar-rounded":"")+'"'),T?k.push('component="'+T+'"'):k.push('component="avatar/'+(i.picture?"picture":"icon")+'"'),i.picture?"<img "+k.join(" ")+' src="'+i.picture+'" style="'+P.join(" ")+'" />':(P.push("background-color: "+i["icon:bgColor"]+";"),"<span "+k.join(" ")+' style="'+P.join(" ")+'">'+i["icon:text"]+"</span>")}function C(){Object.keys(h).forEach(function(i){u.registerHelper(i,h[i])})}return h}},59265:(w,y,u)=>{"use strict";var v,h;const f=u(11120);v=[u(96795),u(59006)],h=function(c,d){return f(c,d,config.relative_path)}.apply(y,v),h!==void 0&&(w.exports=h)},22568:(w,y,u)=>{"use strict";var v,h,f;(function(c){h=[u(20648)],v=c,f=typeof v=="function"?v.apply(y,h):v,f!==void 0&&(w.exports=f)})(function(c){const d=c("[^\\p{L}\\s\\d\\-_]","g"),s=/[^\w\s\d\-_]/g,m=/^\s+|\s+$/g,r=/\s+/g,a=/-+/g,l=/-$/g,e=/^-/g,n=/^[\w\d\s.,\-@]+$/;return function(o,p){return o?(o=String(o).replace(m,""),n.test(o)?o=o.replace(s,"-"):o=c.replace(o,d,"-"),o=p?o:o.toLocaleLowerCase(),o=o.replace(r,"-"),o=o.replace(a,"-"),o=o.replace(l,""),o=o.replace(e,""),o):""}})},27145:(w,y,u)=>{"use strict";w=u.nmd(w);var v,h;v=[u(59006),u(32230),u(85233)],h=function(f,c,d){const s={};s.init=function(){const e=this;f.render("modules/taskbar",{}).then(function(n){e.taskbar=$(n),e.tasklist=e.taskbar.find("ul"),$(document.body).append(e.taskbar),e.taskbar.on("click","li",async function(){const t=$(this),o=t.attr("data-module"),p=t.attr("data-uuid"),b=await app.require(o);return t.hasClass("active")?b.minimize(p):(r(),b.load(p),s.toggleNew(p,!1),s.tasklist.removeClass("active"),t.addClass("active")),!1})}),$(window).on("action:app.loggedOut",function(){s.closeAll()})},s.close=async function(e,n){const t=s.tasklist.find('[data-module="'+w+'"][data-uuid="'+n+'"]');let o="close";if(e==="chat"&&(o="closeByUUID"),t.length){const p=await app.require(e);p&&typeof p[o]=="function"&&p[o](n)}},s.closeAll=function(e){let n="[data-uuid]";e&&(n='[data-module="'+e+'"]'+n),s.tasklist.find(n).each(function(t,o){s.close(e||o.getAttribute("data-module"),o.getAttribute("data-uuid"))})},s.discard=function(e,n){s.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').remove(),m()},s.push=function(e,n,t,o){o=o||function(){};const p=s.tasklist.find('li[data-uuid="'+n+'"]'),b={module:e,uuid:n,options:t,element:p};d.fire("filter:taskbar.push",b),!p.length&&b.module?a(b,o):o(p)},s.get=function(e){return $('[data-module="'+e+'"]').map(function(t,o){return $(o).data()})},s.minimize=function(e,n){s.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},s.toggleNew=function(e,n,t){s.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",n),t||d.fire("action:taskbar.toggleNew",e)},s.updateActive=function(e){const n=s.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},s.isActive=function(e){return s.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function m(){s.tasklist.find("li").length>0?s.taskbar.attr("data-active","1"):s.taskbar.removeAttr("data-active")}function r(){s.tasklist.find(".active").removeClass("active")}function a(e,n){c.translate(e.options.title,function(t){const o=$("<div></div>").text(t||"NodeBB Task").html(),p=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+o+'" component="taskbar/title">'+o+"</span></a>").attr({title:o,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&r(),s.tasklist.append(p),m(),e.element=p,p.data(e),d.fire("action:taskbar.pushed",e),n(p)})}const l=function(e,n,t){switch(n){case"title":e.find('[component="taskbar/title"]').text(t);break;case"icon":e.find("i").attr("class","fa fa-"+t);break;case"image":e.find("a").css("background-image",t?'url("'+t.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",t);break}};return s.update=function(e,n,t){const o=s.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]');if(!o.length)return;const p=o.data();Object.keys(t).forEach(function(b){p[b]=t[b],l(o,b,t[b])}),o.data(p)},s}.apply(y,v),h!==void 0&&(w.exports=h)},62023:(w,y,u)=>{"use strict";var v,h;v=[u(74344),u(31369),u(7927),u(50431),u(59006),u(32230),u(62526)],h=function(f,c,d,s,m,r){const a={};return a.get=l=>f.get(`/topics/${l}/thumbs`,{}),a.getByPid=l=>f.get(`/posts/${l}`,{}).then(e=>a.get(e.tid)),a.delete=(l,e)=>f.del(`/topics/${l}/thumbs`,{path:e}),a.deleteAll=l=>{a.get(l).then(e=>{Promise.all(e.map(n=>a.delete(l,n.url)))})},a.upload=l=>new Promise(e=>{s.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${l}/thumbs`},function(n){e(n)})}),a.modal={},a.modal.open=function(l){const{id:e,pid:n}=l;let{modal:t}=l,o;return new Promise(p=>{Promise.all([a.get(e),n?a.getByPid(n):[]]).then(b=>new Promise(F=>{const S=b.reduce((N,A)=>N.concat(A));o=S.length,F(S)})).then(b=>m.render("modals/topic-thumbs",{thumbs:b})).then(b=>{t?r.translate(b,function(F){t.find(".bootbox-body").html(F),a.modal.handleSort({modal:t,numThumbs:o})}):(t=c.dialog({title:"[[modules:thumbs.modal.title]]",message:b,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(a.upload(e).then(()=>{a.modal.open({...l,modal:t}),Promise.all([u.e(1006),u.e(2265),u.e(9915),u.e(7804)]).then(function(){var F=[u(44541)];(S=>{S.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),p()}).apply(null,F)}).catch(u.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),a.modal.handleDelete({...l,modal:t}),a.modal.handleSort({modal:t,numThumbs:o}))})})},a.modal.handleDelete=l=>{l.modal.get(0).addEventListener("click",n=>{n.target.closest('button[data-action="remove"]')&&c.confirm("[[modules:thumbs.modal.confirm-remove]]",t=>{if(!t)return;const o=n.target.closest(".media[data-id]").getAttribute("data-id"),p=n.target.closest(".media[data-path]").getAttribute("data-path");f.del(`/topics/${o}/thumbs`,{path:p}).then(()=>{a.modal.open(l)}).catch(d.error)})})},a.modal.handleSort=({modal:l,numThumbs:e})=>{if(e>1){const n=l.find(".topic-thumbs-modal");n.sortable({items:"[data-id]"}),n.on("sortupdate",a.modal.handleSortChange)}},a.modal.handleSortChange=(l,e)=>{const n=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(n).forEach((t,o)=>{const p=t.getAttribute("data-id");let b=t.getAttribute("data-path");b=b.replace(new RegExp(`^${config.upload_url}`),""),f.put(`/topics/${p}/thumbs/order`,{path:b,order:o}).catch(d.error)})},a}.apply(y,v),h!==void 0&&(w.exports=h)},50431:(w,y,u)=>{"use strict";var v,h;v=[u(86569)],h=function(){const f={};f.show=function(r,a){const l=r.hasOwnProperty("fileSize")&&r.fileSize!==void 0?parseInt(r.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:r.hasOwnProperty("showHelp")&&r.showHelp!==void 0?r.showHelp:!0,fileSize:l,title:r.title||"[[global:upload_file]]",description:r.description||"",button:r.button||"[[global:upload]]",accept:r.accept?r.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const n=e.find("#uploadForm");n.attr("action",r.route),n.find("#params").val(JSON.stringify(r.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return c(e,l,a),!1})})},f.hideAlerts=function(r){$(r).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function c(r,a,l){d(r,"status","[[uploads:uploading-file]]"),r.find("#upload-progress-bar").css("width","0%"),r.find("#upload-progress-box").show().removeClass("hide");const e=r.find("#fileInput");if(!e.val())return d(r,"error","[[uploads:select-file-to-upload]]");if(!m(e[0],a))return d(r,"error","[[error:file-too-big, "+a+"]]");f.ajaxSubmit(r,l)}function d(r,a,l){f.hideAlerts(r),a==="error"&&r.find("#fileUploadSubmitBtn").removeClass("disabled"),r.find("#alert-"+a).translateText(l).removeClass("hide")}f.ajaxSubmit=function(r,a){r.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=s(e),d(r,"error",e.responseJSON?e.responseJSON.error||e.statusText:"error uploading, code : "+e.status)},uploadProgress:function(e,n,t,o){r.find("#upload-progress-bar").css("width",o+"%")},success:function(e){let n=s(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(n=e.response.images),a(n[0].url),d(r,"success","[[uploads:upload-success]]"),setTimeout(function(){f.hideAlerts(r),r.modal("hide")},750)}})};function s(r){if(typeof r=="string")try{return $.parseJSON(r)}catch{return{error:"[[error:parse-error]]"}}return r}function m(r,a){return window.FileReader&&a?r.files[0].size<=a*1e3:!0}return f}.apply(y,v),h!==void 0&&(w.exports=h)},66485:(w,y,u)=>{"use strict";var v,h;v=[u(74344),u(7927)],h=function(f,c){var d={},s;d.init=function(e,n){var t=e.find(".draft-icon");function o(){m(),s=setTimeout(function(){a(e,t,n)},1e3)}e.on("keyup","textarea, input.handle, input.title",o),e.on("click",'input[type="checkbox"]',o),e.on("thumb.uploaded",o),t.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){var p=[];try{p=localStorage.getItem("drafts:open"),p=JSON.parse(p)||[]}catch{console.warn("[composer/drafts] Could not read list of open/available drafts"),p=[]}p.length&&p.forEach(function(b){d.updateVisibility("open",b)})}),d.migrateGuest(),d.migrateThumbs(...arguments)};function m(){s&&(clearTimeout(s),s=0)}d.getDraft=function(e){return console.warn("[composer/drafts] drafts.getDraft is deprecated! Use drafts.get() instead."),localStorage.getItem(e)};function r(e){return parseInt(e,10)>0?localStorage:sessionStorage}d.get=function(e){var n=e.split(":")[1],t=r(n),o={text:t.getItem(e)};return["cid","title","tags","uuid"].forEach(function(p){const b=t.getItem(e+":"+p);b&&(o[p]=b)}),parseInt(n,10)||(o.handle=t.getItem(e+":handle")),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:o,storage:t}),o};function a(e,n,t){if(l(app.user.uid?"localStorage":"sessionStorage")&&t&&t.save_id&&e.length){const F=e.find("input.title"),S=F&&F.val();var o=e.find("textarea").val(),p=r(app.user.uid);if(t.hasOwnProperty("cid")&&!t.save_id.endsWith(":cid:"+t.cid)&&(d.removeDraft(t.save_id),t.save_id=t.save_id.replace(/cid:\d+$/,"cid:"+t.cid)),o.length||S&&S.length){if(p.setItem(t.save_id,o),p.setItem(`${t.save_id}:uuid`,e.attr("data-uuid")),t.hasOwnProperty("cid")){const N=e.find("input.tags").val();p.setItem(t.save_id+":tags",N),p.setItem(t.save_id+":title",S)}if(!app.user.uid){var b=e.find("input.handle").val();p.setItem(t.save_id+":handle",b)}$(window).trigger("action:composer.drafts.save",{storage:p,postData:t,postContainer:e}),n.toggleClass("active",!0)}else d.removeDraft(t.save_id)}}d.removeDraft=function(e){if(!e)return;m(),d.updateVisibility("available",e),d.updateVisibility("open",e);var n=e.split(":")[1],t=r(n);Object.keys(t).filter(p=>p.startsWith(e)).forEach(p=>t.removeItem(p))},d.updateVisibility=function(e,n,t){if(!(!l(app.user.uid?"localStorage":"sessionStorage")||!n)){var o=[];try{o=localStorage.getItem("drafts:"+e),o=o?JSON.parse(o):[]}catch{console.warn("[composer/drafts] Could not read list of open drafts"),o=[]}var p=o.indexOf(n);t&&p===-1?o.push(n):!t&&p!==-1&&o.splice(p,1),localStorage.setItem("drafts:"+e,JSON.stringify(o))}},d.migrateGuest=function(){if(l("localStorage")&&app.user.uid){var e=/^composer:\d+:\w+:\d+(:\w+)?$/,n=Object.keys(sessionStorage).filter(function(p){return e.test(p)}),t=new Set([]),o=n.map(function(p){var b=p.split(":");return b[1]=app.user.uid,t.add(b.slice(0,4).join(":")),b.join(":")});return n.forEach(function(p,b){localStorage.setItem(o[b],sessionStorage.getItem(p)),sessionStorage.removeItem(p)}),t.forEach(function(p){d.updateVisibility("available",p,1)}),t}},d.migrateThumbs=function(e,n){if(!app.uid)return;const t=e.attr("data-uuid"),o=d.get(n.save_id);o&&o.uuid&&f.put(`/topics/${o.uuid}/thumbs`,{tid:t}).then(()=>{Promise.all([u.e(6177),u.e(2526),u.e(1006),u.e(2265),u.e(9915),u.e(5482)]).then(function(){var p=[u(44541)];(function(b){b.updateThumbCount(t,e)}).apply(null,p)}).catch(u.oe)})},d.loadOpen=function(){if(!(ajaxify.data.template.login||ajaxify.data.template.register)){var e,n=[];try{e=localStorage.getItem("drafts:available"),n=localStorage.getItem("drafts:open"),e=JSON.parse(e)||[],n=JSON.parse(n)||[]}catch{console.warn("[composer/drafts] Could not read list of open/available drafts"),e=[],n=[]}e.length&&e.forEach(function(t){if(t){var o=t.split(":"),p=o[1],b=o[2],F=o[3],S=d.get(t);if(n.indexOf(t)===-1&&parseInt(app.user.uid,10)===parseInt(p,10)){if(!S||S.text&&S.title&&!S.text.title&&!S.text.length){d.updateVisibility("available",t),d.updateVisibility("open",t);return}Promise.all([u.e(6177),u.e(2526),u.e(1006),u.e(2265),u.e(9915),u.e(5482)]).then(function(){var N=[u(44541)];(function(A){b==="cid"?A.newTopic({cid:F,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(S.handle),title:utils.escapeHTML(S.title),body:utils.escapeHTML(S.text),tags:String(S.tags||"").split(",")}):b==="tid"?f.get("/topics/"+F,{},function(I,C){if(I)return c.error(I);A.newReply(F,void 0,C.title,utils.escapeHTML(S.text))}):b==="pid"&&A.editPost(F)}).apply(null,N)}).catch(u.oe)}}})}};function l(e){var n;try{n=window[e];var t="__storage_test__";return n.setItem(t,t),n.removeItem(t),!0}catch(o){return o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&n&&n.length!==0}}return d}.apply(y,v),h!==void 0&&(w.exports=h)},35729:(w,y,u)=>{"use strict";var v,h;v=[u(83713),u(38259),u(62023),u(10577)],h=function(f,c,d,s){var m={},r={picture:function(){var l=this;l.find("#files").click()},upload:function(){var l=this;l.find("#files").click()},thumbs:function(){m.exitFullscreen();var l=this;Promise.all([u.e(1006),u.e(2265),u.e(9915),u.e(7913)]).then(function(){var e=[u(44541)];(function(n){const t=l.get(0).getAttribute("data-uuid"),o=n.posts[t];(o.action==="topics.post"||o.action==="posts.edit"&&o.isMain)&&d.modal.open({id:t,pid:o.pid}).then(()=>{l.trigger("thumb.uploaded"),n.updateThumbCount(t,l)})}).apply(null,e)}).catch(u.oe)},tags:function(){var l=this;l.find(".tags-container").toggleClass("hidden")},zen:function(){var l=this;$(window).one("resize",function(){function e(){s.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),c.reposition(l),$(window).off("resize",e))}s.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),l.find(".write").focus(),$(window).on("resize",e),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",s.exit))}),s.toggle(l.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:l})}},a=[];return m.exitFullscreen=function(){s.isEnabled&&s.isFullscreen&&s.exit()},m.addComposerButtons=function(){for(var l=0,e=a.length;l<e;l++)$(".formatting-bar .formatting-group #fileForm").before('<li tabindex="-1" data-format="'+a[l].name+'" title="'+(a[l].title||"")+'"><i class="'+a[l].iconClass+'"></i></li>')},m.addButton=function(l,e,n,t){t=t||l.replace("fa fa-",""),r[t]=e,a.push({name:t,iconClass:l,title:n})},m.getDispatchTable=function(){return r},m.addButtonDispatch=function(l,e){r[l]=e},m.addHandler=function(l){l.on("click",".formatting-bar li",function(e){var n=$(this).attr("data-format"),t=$(this).parents('[component="composer"]').find("textarea")[0];r.hasOwnProperty(n)&&(r[n].call(l,t,t.selectionStart,t.selectionEnd,e),f.render(l))})},m}.apply(y,v),h!==void 0&&(w.exports=h)},51077:(w,y,u)=>{"use strict";var v,h;v=[u(85233)],h=function(f){var c={};return c.render=function(d,s){if(s=s||function(){},!d.find(".preview-container").is(":visible"))return s();var m=d.find("textarea");socket.emit("plugins.composer.renderPreview",m.val(),function(r,a){r||(a=$("<div>"+a+"</div>"),a.find("img:not(.not-responsive)").addClass("img-responsive"),d.find(".preview").html(a),f.fire("action:composer.preview"),s())})},c.matchScroll=function(d){if(d.find(".preview-container").is(":visible")){var s=d.find("textarea"),m=d.find(".preview");if(s.length&&m.length){var r=s[0].scrollHeight-s.height();if(r===0)return;var a=s.scrollTop()/r;m.scrollTop(Math.max(m[0].scrollHeight-m.height(),0)*a)}}},c.handleToggler=function(d){c.env=utils.findBootstrapEnvironment();var s=d.find(".write-container .toggle-preview"),m=d.find(".preview-container .toggle-preview"),r=$(".preview-container"),a=$(".write-container");function l(){n(!1),c.env!=="xs"&&c.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function e(){n(!0),c.env!=="xs"&&c.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function n(t){c.env==="xs"||c.env==="sm"?(r.toggleClass("hide",!1),a.toggleClass("maximized",!1),s.toggleClass("hide",!0),r.toggleClass("hidden-xs hidden-sm",!t),a.toggleClass("hidden-xs hidden-sm",t),t&&c.render(d)):(r.toggleClass("hide",!t),a.toggleClass("maximized",!t),s.toggleClass("hide",t)),c.matchScroll(d)}c.toggle=n,m.on("click",function(){l(),d.find(".write").focus()}),s.on("click",function(){e(),d.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||c.env==="xs"||c.env==="sm"?l():e()},c}.apply(y,v),h!==void 0&&(w.exports=h)},65616:(w,y,u)=>{"use strict";var v,h;v=[u(27145)],h=function(f){var c={},d=0,s=.3,m=.05,r=992,a=$("body"),l=$(window),e=$('[component="navbar"]'),n=document.body,t=e[0];function o(){return localStorage.getItem("composer:resizeRatio")||.5}function p(A){localStorage.setItem("composer:resizeRatio",Math.min(A,1))}function b(){var A;t?A=t.getBoundingClientRect():A={bottom:0};var I=Math.max(A.bottom,0),C={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return C.width=C.right,C.height=C.bottom,C.boundedTop=I,C.boundedHeight=C.bottom-I,C}function F(A,I){var C=b(),i=A[0],g=window.getComputedStyle(i),E=parseInt(g.getPropertyValue("min-height"),10),x=Math.max(E/window.innerHeight,s);if(C.width>=r){const P=(C.height-C.boundedHeight)/C.height;I=Math.min(Math.max(I,x+P),1);var T=I*C.boundedHeight/C.height;i.style.top=((1-T)*100).toString()+"%";var k=i.getBoundingClientRect();n.style.paddingBottom=(k.bottom-k.top).toString()+"px"}else A.removeAttr("style"),n.style.paddingBottom=0;A.ratio=I,i.style.visibility="visible",f.updateActive(A.attr("data-uuid"))}var S=F,N=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return N&&(S=function(A,I){N(function(){F(A,I),setTimeout(function(){l.trigger("action:composer.resize"),A.trigger("action:composer.resize")},0)})}),c.reposition=function(A){var I=o();I>=1-m&&(I=1,A.addClass("maximized")),S(A,I)},c.maximize=function(A,I){I?S(A,1):c.reposition(A)},c.handleResize=function(A){var I=0,C=0,i=0,g=A.find(".resizer"),E=g[0];function x(R){var z=E.getBoundingClientRect(),B=(z.top+z.bottom)/2;I=(B-R.clientY)/2,C=R.clientY,l.on("mousemove",T),l.on("mouseup",k),a.on("touchmove",P)}function T(R){var z=R.clientY-I,B=b(),D=(B.height-z)/B.boundedHeight;S(A,D)}function k(R){R.preventDefault(),i=R.clientY,A.find("textarea").focus(),l.off("mousemove",T),l.off("mouseup",k),a.off("touchmove",P);var z=i-I,B=b(),D=(B.height-z)/B.boundedHeight;i-C===0&&A.hasClass("maximized")?(A.removeClass("maximized"),D=!d||d>=1-m?.5:d,S(A,D)):i-C===0||D>=1-m?(S(A,1),A.addClass("maximized"),d=D):A.removeClass("maximized"),p(D)}function P(R){R.preventDefault(),T(R.touches[0])}g.on("mousedown",function(R){R.preventDefault(),x(R)}).on("touchstart",function(R){R.preventDefault(),x(R.touches[0])}).on("touchend",k)},c}.apply(y,v),h!==void 0&&(w.exports=h)},10577:w=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var y=typeof window<"u"&&typeof window.document<"u"?window.document:{},u=w.exports,v=function(){for(var c,d=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],s=0,m=d.length,r={};s<m;s++)if(c=d[s],c&&c[1]in y){for(s=0;s<c.length;s++)r[d[0][s]]=c[s];return r}return!1}(),h={change:v.fullscreenchange,error:v.fullscreenerror},f={request:function(c,d){return new Promise(function(s,m){var r=function(){this.off("change",r),s()}.bind(this);this.on("change",r),c=c||y.documentElement;var a=c[v.requestFullscreen](d);a instanceof Promise&&a.then(r).catch(m)}.bind(this))},exit:function(){return new Promise(function(c,d){if(!this.isFullscreen){c();return}var s=function(){this.off("change",s),c()}.bind(this);this.on("change",s);var m=y[v.exitFullscreen]();m instanceof Promise&&m.then(s).catch(d)}.bind(this))},toggle:function(c,d){return this.isFullscreen?this.exit():this.request(c,d)},onchange:function(c){this.on("change",c)},onerror:function(c){this.on("error",c)},on:function(c,d){var s=h[c];s&&y.addEventListener(s,d,!1)},off:function(c,d){var s=h[c];s&&y.removeEventListener(s,d,!1)},raw:v};if(!v){u?w.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(f,{isFullscreen:{get:function(){return Boolean(y[v.fullscreenElement])}},element:{enumerable:!0,get:function(){return y[v.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(y[v.fullscreenEnabled])}}}),u?w.exports=f:window.screenfull=f})()}}]);

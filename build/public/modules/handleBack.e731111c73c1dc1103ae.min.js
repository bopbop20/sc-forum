"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[3892,7214,6503,6027,2344,8786,71,8306,7927],{78989:(_,v,w)=>{var x,d;x=[w(31369)],d=function(n){const a={};return a.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return n.prompt("[[global:enter_page_number]]",function(r){a.loadPage(r)}),!1})},a.loadPage=function(r,m){if(m=m||function(){},r=parseInt(r,10),!utils.isNumber(r)||r<1||r>ajaxify.data.pagination.pageCount)return;const o=utils.params();o.page=r;const f=window.location.pathname+"?"+$.param(o);ajaxify.go(f,m)},a.nextPage=function(r){a.loadPage(ajaxify.data.pagination.currentPage+1,r)},a.previousPage=function(r){a.loadPage(ajaxify.data.pagination.currentPage-1,r)},a}.apply(v,x),d!==void 0&&(_.exports=d)},7927:(_,v,w)=>{var x,d;x=[w(32230),w(7237),w(85233)],d=function(n,a,r){const m={};m.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const s=$("#"+e.alert_id);s.length?f(s,e):o(e)},m.success=function(e,s){m.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:s||5e3})},m.error=function(e,s){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}m.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:s||1e4})},m.remove=function(e){$("#alert_button_"+e).remove()};function o(e){app.parseAndTranslate("alert",e,function(s){let l=$("#"+e.alert_id);if(l.length)return f(l,e);l=s,l.fadeIn(200),a.get("toaster/tray").prepend(l),typeof e.closefn=="function"&&l.find("button").on("click",function(){return e.closefn(),h(l),!1}),e.timeout&&A(l,e),typeof e.clickfn=="function"&&l.addClass("pointer").on("click",function(y){$(y.target).is(".close")||e.clickfn(l,e),h(l)}),r.fire("action:alert.new",{alert:l,params:e})})}function f(e,s){e.find("strong").translateHtml(s.title),e.find("p").translateHtml(s.message),e.attr("class","alert alert-dismissable alert-"+s.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),s.timeout&&A(e,s),r.fire("action:alert.update",{alert:e,params:s}),e.off("click").removeClass("pointer"),typeof s.clickfn=="function"&&e.addClass("pointer").on("click",function(l){$(l.target).is(".close")||s.clickfn(),h(e)})}function h(e){e.fadeOut(500,function(){$(this).remove()})}function A(e,s){const l=s.timeout,y=setTimeout(function(){h(e),typeof s.timeoutfn=="function"&&s.timeoutfn(e,s)},l);e.attr("timeoutId",y),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(l+450)+"ms linear, background-color "+(l+450)+"ms ease-in"),e.addClass("animate"),r.fire("action:alert.animate",{alert:e,params:s})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return m}.apply(v,x),d!==void 0&&(_.exports=d)},7237:(_,v,w)=>{var x;x=function(){const d={};return d.core={"topic/teaser":function(n){return n?$('[component="category/topic"][data-tid="'+n+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(n,a){return $('[component="topic"][data-'+n+'="'+a+'"]')},post:function(n,a){return $('[component="post"][data-'+n+'="'+a+'"]')},"post/content":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/content"]')},"post/header":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/header"]')},"post/anchor":function(n){return $('[component="post"][data-index="'+n+'"] [component="post/anchor"]')},"post/vote-count":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/vote-count"]')},"post/bookmark-count":function(n){return $('[component="post"][data-pid="'+n+'"] [component="post/bookmark-count"]')},"user/postcount":function(n){return $('[component="user/postcount"][data-uid="'+n+'"]')},"user/reputation":function(n){return $('[component="user/reputation"][data-uid="'+n+'"]')},"category/topic":function(n,a){return $('[component="category/topic"][data-'+n+'="'+a+'"]')},"categories/category":function(n,a){return $('[component="categories/category"][data-'+n+'="'+a+'"]')},"chat/message":function(n){return $('[component="chat/message"][data-mid="'+n+'"]')},"chat/message/body":function(n){return $('[component="chat/message"][data-mid="'+n+'"] [component="chat/message/body"]')},"chat/recent/room":function(n){return $('[component="chat/recent/room"][data-roomid="'+n+'"]')}},d.get=function(){const n=Array.prototype.slice.call(arguments,1);return d.core[arguments[0]]&&n.length?d.core[arguments[0]].apply(this,n):$('[component="'+arguments[0]+'"]')},d}.call(v,w,v,_),x!==void 0&&(_.exports=x)},66044:(_,v,w)=>{var x,d;x=[w(7237),w(66603),w(42840),w(78989)],d=function(n,a,r,m){const o={};let f;o.init=function(e){f=e,h(),$(window).off("action:popstate",A).on("action:popstate",A)},o.onBackClicked=A;function h(){$('[component="category"]').on("click",'[component="topic/header"]',function(){const e=$(this).parents("[data-index]").attr("data-index"),s=$(window).scrollTop();$('[component="category/topic"]').each(function(l,y){if($(y).offset().top-s>0)return a.setItem("category:bookmark",$(y).attr("data-index")),a.setItem("category:bookmark:clicked",e),a.setItem("category:bookmark:offset",$(y).offset().top-s),!1})})}function A(e){const s=e&&ajaxify.data.template.unread;if(ajaxify.data.template.category||ajaxify.data.template.recent||ajaxify.data.template.popular||s){let l=a.getItem("category:bookmark"),y=a.getItem("category:bookmark:clicked");if(a.removeItem("category:bookmark"),a.removeItem("category:bookmark:clicked"),!utils.isNumber(l))return;if(l=Math.max(0,parseInt(l,10)||0),y=Math.max(0,parseInt(y,10)||0),config.usePagination){const C=Math.ceil((parseInt(l,10)+1)/config.topicsPerPage);parseInt(C,10)!==ajaxify.data.pagination.currentPage?m.loadPage(C,function(){o.scrollToTopic(l,y)}):o.scrollToTopic(l,y)}else{if(l===0){o.scrollToTopic(l,y);return}$('[component="category"]').empty(),f(Math.max(0,l-1)+1,function(){o.scrollToTopic(l,y)})}}}return o.highlightTopic=function(e){const s=n.get("category/topic","index",e);s.length&&!s.hasClass("highlight")&&(s.addClass("highlight"),setTimeout(function(){s.removeClass("highlight")},5e3))},o.scrollToTopic=function(e,s){if(!utils.isNumber(e))return;const l=n.get("category/topic","index",e);if(l.length){const y=a.getItem("category:bookmark:offset");a.removeItem("category:bookmark:offset"),$(window).scrollTop(l.offset().top-y),o.highlightTopic(s),r.update()}},o}.apply(v,x),d!==void 0&&(_.exports=d)},42840:(_,v,w)=>{var x,d;x=[w(78989),w(7237),w(85233),w(7927)],d=function(n,a,r,m){const o={};let f=0,h=0,A,e,s,l,y,C=!1,B=!0;o.scrollActive=!1;let g=$(".pagination-block"),V=g.find(".pagination-text"),z=g.find("meter"),G=g.find(".progress-bar"),T,S,J,N,R;$(window).on("action:ajaxify.start",function(){$(window).off("keydown",L)}),o.init=function(t,i,c,p,I){f=0,o.selector=t,o.callback=I,o.toTop=c||function(){},o.toBottom=p||function(){},g=$(".pagination-block"),V=g.find(".pagination-text"),z=g.find("meter"),G=g.find(".progress-bar"),J=$(".scroller-thumb-icon"),N=J.height(),R=N/2,T=$(".scroller-thumb"),S=T.find(".thumb-text"),$(window).off("scroll",o.delayedUpdate).on("scroll",o.delayedUpdate),g.find(".dropdown-menu").off("click").on("click",function(k){k.stopPropagation()}),g.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",function(){setTimeout(async function(){utils.findBootstrapEnvironment()==="lg"&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&g.find("#myNextPostBtn").removeAttr("disabled")},100)}),g.find(".pageup").off("click").on("click",o.scrollUp),g.find(".pagedown").off("click").on("click",o.scrollDown),g.find(".pagetop").off("click").on("click",o.toTop),g.find(".pagebottom").off("click").on("click",o.toBottom),g.find("#myNextPostBtn").off("click").on("click",Q),g.find("input").on("keydown",function(k){if(k.which===13){const u=$(this);if(!utils.isNumber(u.val())){u.val("");return}const b=parseInt(u.val(),10),P=H(b);u.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(P)}}),ajaxify.data.template.topic&&Z(),q(),o.setCount(i),o.update(0)};let Y=0;async function Q(){async function t(i){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,i),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let i=await t(f);Y===i&&(i=await t(i)),i&&f!==i+1?(Y=i,$(window).one("action:ajaxify.end",function(){g.find(".dropdown-menu").is(":hidden")&&g.find(".dropdown-toggle").dropdown("toggle")}),o.scrollToIndex(i,!0,0)):(m.alert({message:"[[topic:no-more-next-post]]",type:"info"}),Y=1)}}function U(t){const i=T.parent(),c=i.offset();return t<c.top?t=c.top:t>c.top+i.height()-N&&(t=c.top+i.height()-N),t}function W(t){if(!T.length||T.is(":hidden"))return;const i=T.parent(),c=i.offset();let p=(t-1)/ajaxify.data.postcount;t===h&&(p=1);const k={top:U(c.top+(i.height()-N)*p),left:T.offset().left};T.offset(k),S.text(t+"/"+ajaxify.data.postcount),O(t)}function Z(){if(!T.length)return;const t=T.parent();t.on("click",function(u){if($(u.target).hasClass("scroller-container")){const b=i(u.pageY);return o.scrollToIndex(b-1,!0,0),!1}});function i(u){const b=U(u-R),P=t.offset(),D=(b-P.top)/(t.height()-N);return f=Math.max(1,Math.ceil(ajaxify.data.postcount*D)),f>ajaxify.data.postcount?ajaxify.data.count:f}let c=!1;r.on("action:ajaxify.end",function(){y=null}),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",function(){W(f)}),T.on("mousedown",function(){c=!0,$(window).on("mousemove",I),B=!0});function p(){$(window).off("mousemove",I),c&&(o.scrollToIndex(f-1,!0,0),g.find('[data-toggle="dropdown"]').trigger("click")),F(),c=!1,B=!1}function I(u){const b=U(u.pageY-R);T.offset({top:b,left:T.offset().left});const P=i(u.pageY);return o.updateTextAndProgressBar(),S.text(P+"/"+ajaxify.data.postcount),B&&k(),B=!1,u.stopPropagation(),!1}function k(){F(),e=setInterval(function(){O(f)},250)}$(window).off("mousemove",I),$(window).off("mouseup",p).on("mouseup",p),T.on("touchstart",function(u){C=!0,s=Math.min($(window).width(),Math.max(0,u.touches[0].clientX)),l=Math.min($(window).height(),Math.max(0,u.touches[0].clientY)),B=!0}),T.on("touchmove",function(u){const b=$(window).width(),P=$(window).height(),D=Math.abs(s-Math.min(b,Math.max(0,u.touches[0].clientX))),E=Math.abs(l-Math.min(P,Math.max(0,u.touches[0].clientY)));if(s=Math.min(b,Math.max(0,u.touches[0].clientX)),l=Math.min(P,Math.max(0,u.touches[0].clientY)),E>=D&&B&&(C=!0,k()),C&&u.cancelable){u.preventDefault(),u.stopPropagation();const j=U(l+$(window).scrollTop()-R);T.offset({top:j,left:T.offset().left});const M=i(l+$(window).scrollTop());o.updateTextAndProgressBar(),S.text(M+"/"+ajaxify.data.postcount),B&&O(M)}B=!1}),T.on("touchend",function(){F(),C&&(o.scrollToIndex(f-1,!0,0),C=!1,g.find('[data-toggle="dropdown"]').trigger("click"))})}function F(){e&&(clearInterval(e),e=0)}function O(t,i){i=i||function(){},!(y===t||g.find(".post-content").is(":hidden"))&&(y=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},function(c,p){if(c)return m.error(c);app.parseAndTranslate("partials/topic/navigation-post",{post:p},function(I){g.find(".post-content").html(I).find(".timeago").timeago()}),i()}))}function q(){config.usePagination||$(window).off("keydown",L).on("keydown",L)}function L(t){if(t.target.nodeName==="BODY"){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(t.which===36&&o.toTop)return o.toTop(),!1;if(t.which===35&&o.toBottom)return o.toBottom(),!1}}function H(t){const c=window.location.pathname.replace(config.relative_path,"").split("/");return c[1]+"/"+c[2]+"/"+c[3]+(t?"/"+t:"")}o.getCount=()=>h,o.setCount=function(t){t=parseInt(t,10),t!==h&&(h=t,o.updateTextAndProgressBar())},o.show=function(){X(!0)},o.disable=function(){h=0,f=1,o.callback=null,o.selector=null,$(window).off("scroll",o.delayedUpdate),X(!1)};function X(t){const i=ajaxify.removeRelativePath(window.location.pathname.slice(1));t&&!i.startsWith("topic")&&!i.startsWith("category")||g.toggleClass("ready",t)}return o.delayedUpdate=function(){A||(A=setTimeout(function(){o.update(),A=void 0},100))},o.update=function(t){t=typeof t=="number"?t:void 0;let i=f;const c=$(o.selector);c.length&&(i=parseInt(c.first().attr("data-index"),10)+1);const p=$(window).scrollTop(),I=$(window).height(),k=$(document).height(),u=p+I/2;let b=Number.MAX_VALUE;c.each(function(){const E=$(this),j=parseInt(E.attr("data-index"),10);if(j>=0){const M=Math.abs(u-(E.offset().top+E.outerHeight(!0)/2));if(M>b)return!1;M<b&&(i=j+1,b=M)}});const P=p===0&&parseInt(c.first().attr("data-index"),10)===0,D=p+I>k-100&&parseInt(c.last().attr("data-index"),10)===h-1;if(P?i=1:D&&(i=h),t===void 0&&ajaxify.data.template.topic)if(P)t=0;else{const E=a.get("post/anchor",f-1);E.length&&(t=E.get(0).getBoundingClientRect().top)}typeof o.callback=="function"&&o.callback(i,h,t),i!==f&&(f=i,o.updateTextAndProgressBar(),W(f)),X(!!h)},o.getIndex=()=>f,o.setIndex=t=>{f=t+1,o.updateTextAndProgressBar(),W(f)},o.updateTextAndProgressBar=function(){if(!utils.isNumber(f))return;f=f>h?h:f,V.translateHtml("[[global:pagination.out_of, "+f+", "+h+"]]");const t=(f-1)/(h-1||1);z.val(t),G.width(t*100+"%")},o.scrollUp=function(){const t=$(window);if(config.usePagination&&t.scrollTop()<=0)return n.previousPage(function(){$("body,html").scrollTop($(document).height()-t.height())});$("body,html").animate({scrollTop:t.scrollTop()-t.height()})},o.scrollDown=function(){const t=$(window);if(config.usePagination&&t.scrollTop()>=$(document).height()-t.height())return n.nextPage();$("body,html").animate({scrollTop:t.scrollTop()+t.height()})},o.scrollTop=function(t){$(o.selector+'[data-index="'+t+'"]').length?o.scrollToIndex(t,!0):ajaxify.go(H())},o.scrollBottom=function(t){parseInt(t,10)<0||($(o.selector+'[data-index="'+t+'"]').length?o.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(H(t))))},o.scrollToIndex=function(t,i,c){const p=!!a.get("topic").length,I=!!a.get("category").length;if(!utils.isNumber(t)||!p&&!I)return;if(c=c!==void 0?c:400,o.scrollActive=!0,p&&a.get("post/anchor",t).length)return o.scrollToPostIndex(t,i,c);if(I&&$('[component="category/topic"][data-index="'+t+'"]').length)return o.scrollToTopicIndex(t,i,c);if(!config.usePagination){o.scrollActive=!1,t=parseInt(t,10)+1,ajaxify.go(H(t));return}const k=p?o.scrollToPostIndex:o.scrollToTopicIndex,u=1+Math.floor(t/config.postsPerPage);parseInt(u,10)!==ajaxify.data.pagination.currentPage?n.loadPage(u,function(){k(t,i,c)}):k(t,i,c)},o.scrollToPostIndex=function(t,i,c){const p=a.get("post","index",t);o.scrollToElement(p,i,c,t)},o.scrollToTopicIndex=function(t,i,c){const p=$('[component="category/topic"][data-index="'+t+'"]');o.scrollToElement(p,i,c,t)},o.scrollToElement=async(t,i,c,p=null)=>{if(!t.length){o.scrollActive=!1;return}await r.fire("filter:navigator.scroll",{scrollTo:t,highlight:i,duration:c,newIndex:p});const I=t.outerHeight(!0),k=a.get("navbar").outerHeight(!0)||0,u=$(".topic-header").outerHeight(!0)||0,b=$(window).height();$(window).off("scroll",o.delayedUpdate),c=c!==void 0?c:400,o.scrollActive=!0;let P=!1;function D(){function j(){setTimeout(()=>{$(window).on("scroll",o.delayedUpdate),r.fire("action:navigator.scrolled",{scrollTo:t,highlight:i,duration:c,newIndex:p})},50)}function M(){if(P){j();return}P=!0,o.scrollActive=!1,E();const tt=t.get(0).getBoundingClientRect();p?o.setIndex(p):o.update(tt.top)}let K=0;if(I<b-k-u?K=t.offset().top-b/2+I/2:K=t.offset().top-k-u,c===0){$(window).scrollTop(K),M(),j();return}$("html, body").animate({scrollTop:K+"px"},c,M)}function E(){i&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout(function(){t.removeClass("highlight")},1e4))}D()},o}.apply(v,x),d!==void 0&&(_.exports=d)},66603:(_,v,w)=>{var x;x=function(){function d(){this._store={},this._keys=[]}d.prototype.isMock=!0,d.prototype.setItem=function(r,m){r=String(r),this._keys.indexOf(r)===-1&&this._keys.push(r),this._store[r]=m},d.prototype.getItem=function(r){return r=String(r),this._keys.indexOf(r)===-1?null:this._store[r]},d.prototype.removeItem=function(r){r=String(r),this._keys=this._keys.filter(function(m){return m!==r}),this._store[r]=null},d.prototype.clear=function(){this._keys=[],this._store={}},d.prototype.key=function(r){return r=parseInt(r,10)||0,this._keys[r]},Object.defineProperty&&Object.defineProperty(d.prototype,"length",{get:function(){return this._keys.length}});let n;const a=Date.now().toString();try{if(n=window.localStorage,n.setItem(a,a),n.getItem(a)!==a)throw Error("localStorage behaved unexpectedly");return n.removeItem(a),n}catch(r){console.warn(r),console.warn("localStorage failed, falling back on sessionStorage");try{if(n=window.sessionStorage,n.setItem(a,a),n.getItem(a)!==a)throw Error("sessionStorage behaved unexpectedly");return n.removeItem(a),n}catch(m){return console.warn(m),console.warn("sessionStorage failed, falling back on memory storage"),new d}}}.call(v,w,v,_),x!==void 0&&(_.exports=x)}}]);

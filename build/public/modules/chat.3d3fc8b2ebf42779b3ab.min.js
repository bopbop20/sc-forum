"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9617,7214,6503,6027,3014,71,3034,831,7927,3216,4337,1837],{7927:(A,E,d)=>{var v,h;v=[d(32230),d(7237),d(85233)],h=function(u,l,y){const a={};a.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:new Date().getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const o=$("#"+e.alert_id);o.length?f(o,e):p(e)},a.success=function(e,o){a.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:o||5e3})},a.error=function(e,o){if(e=e&&e.message||e,e==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}a.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:o||1e4})},a.remove=function(e){$("#alert_button_"+e).remove()};function p(e){app.parseAndTranslate("alert",e,function(o){let t=$("#"+e.alert_id);if(t.length)return f(t,e);t=o,t.fadeIn(200),l.get("toaster/tray").prepend(t),typeof e.closefn=="function"&&t.find("button").on("click",function(){return e.closefn(),g(t),!1}),e.timeout&&i(t,e),typeof e.clickfn=="function"&&t.addClass("pointer").on("click",function(n){$(n.target).is(".close")||e.clickfn(t,e),g(t)}),y.fire("action:alert.new",{alert:t,params:e})})}function f(e,o){e.find("strong").translateHtml(o.title),e.find("p").translateHtml(o.message),e.attr("class","alert alert-dismissable alert-"+o.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),o.timeout&&i(e,o),y.fire("action:alert.update",{alert:e,params:o}),e.off("click").removeClass("pointer"),typeof o.clickfn=="function"&&e.addClass("pointer").on("click",function(t){$(t.target).is(".close")||o.clickfn(),g(e)})}function g(e){e.fadeOut(500,function(){$(this).remove()})}function i(e,o){const t=o.timeout,n=setTimeout(function(){g(e),typeof o.timeoutfn=="function"&&o.timeoutfn(e,o)},t);e.attr("timeoutId",n),e.css("transition-property","none"),e.removeClass("animate"),setTimeout(function(){e.css("transition-property",""),e.css("transition","width "+(t+450)+"ms linear, background-color "+(t+450)+"ms ease-in"),e.addClass("animate"),y.fire("action:alert.animate",{alert:e,params:o})},50),e.on("mouseenter",function(){$(this).css("transition-duration",0)})}return a}.apply(E,v),h!==void 0&&(A.exports=h)},74344:(A,E,d)=>{var v,h;v=[d(85233)],h=(u=>{const l={},y=config.relative_path+"/api/v3";function a(p,f){p.url=p.url.startsWith("/api")?config.relative_path+p.url:y+p.url;async function g(i){({options:p}=await u.fire("filter:api.options",{options:p})),$.ajax(p).done(e=>{i(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})}).fail(e=>{let o;e.responseJSON&&(o=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),i(new Error(o||e.statusText))})}if(typeof f=="function"){g(f);return}return new Promise((i,e)=>{g(function(o,t){o?e(o):i(t)})})}return l.get=(p,f,g)=>a({url:p+(f&&Object.keys(f).length?"?"+$.param(f):"")},g),l.head=(p,f,g)=>a({url:p+(f&&Object.keys(f).length?"?"+$.param(f):""),method:"head"},g),l.post=(p,f,g)=>a({url:p,method:"post",data:JSON.stringify(f||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},g),l.patch=(p,f,g)=>a({url:p,method:"patch",data:JSON.stringify(f||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},g),l.put=(p,f,g)=>a({url:p,method:"put",data:JSON.stringify(f||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},g),l.del=(p,f,g)=>a({url:p,method:"delete",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},g),l.delete=l.del,l}).apply(E,v),h!==void 0&&(A.exports=h)},93216:(A,E,d)=>{var v,h;v=[d(7237),d(27145),d(32230),d(85233),d(31369),d(7927),d(74344)],h=function(u,l,y,a,p,f,g){const i={};let e=!1;i.openChat=function(t,n){if(!app.user.uid)return f.error("[[error:not-logged-in]]");function c(r){i.load(r.attr("data-uuid")),i.center(r),i.focusInput(r)}i.modalExists(t)?c(i.getModal(t)):g.get(`/chats/${t}`,{uid:n||app.user.uid}).then(r=>{r.users=r.users.filter(function(m){return m&&parseInt(m.uid,10)!==parseInt(app.user.uid,10)}),r.uid=n||app.user.uid,r.isSelf=!0,i.createModal(r,c)}).catch(f.error)},i.newChat=function(t,n){function c(){g.post("/chats",{uids:[t]}).then(({roomId:r})=>{ajaxify.data.template.chats?ajaxify.go("chats/"+r):i.openChat(r),n(null,r)}).catch(f.error)}if(n=n||function(){},!app.user.uid)return f.error("[[error:not-logged-in]]");if(parseInt(t,10)===parseInt(app.user.uid,10))return f.error("[[error:cant-chat-with-yourself]]");socket.emit("modules.chats.isDnD",t,function(r,m){if(r)return f.error(r);if(!m)return c();p.confirm("[[modules:chat.confirm-chat-with-dnd-user]]",function(I){I&&c()})})},i.loadChatsDropdown=function(t){socket.emit("modules.chats.getRecentChats",{uid:app.user.uid,after:0},function(n,c){if(n)return f.error(n);const r=c.rooms.filter(function(m){return m.teaser});y.toggleTimeagoShorthand(function(){for(let m=0;m<r.length;m+=1)r[m].teaser.timeago=$.timeago(new Date(parseInt(r[m].teaser.timestamp,10)));y.toggleTimeagoShorthand(),app.parseAndTranslate("partials/chats/dropdown",{rooms:r},function(m){t.find("*").not(".navigation-link").remove(),t.prepend(m),app.createUserTooltips(t,"right"),t.off("click").on("click","[data-roomid]",function(I){if($(I.target).parents(".user-link").length)return;const s=$(this).attr("data-roomid");ajaxify.currentPage.match(/^chats\//)?ajaxify.go("user/"+app.user.userslug+"/chats/"+s):i.openChat(s)}),$('[component="chats/mark-all-read"]').off("click").on("click",function(){socket.emit("modules.chats.markAllRead",function(I){if(I)return f.error(I)})})})})})},i.onChatMessageReceived=function(t){const n=t.self===1;t.message.self=t.self,e=t.self===0,i.modalExists(t.roomId)?o(t):ajaxify.data.template.chats||g.get(`/chats/${t.roomId}`,{}).then(c=>{c.users=c.users.filter(function(r){return r&&parseInt(r.uid,10)!==parseInt(app.user.uid,10)}),c.silent=!0,c.uid=app.user.uid,c.isSelf=n,i.createModal(c)}).catch(f.error)};function o(t){const n=i.getModal(t.roomId),c=t.message.fromUser.username,r=t.self===1;d.e(6862).then(function(){var m=[d(46862)];(function(I){n.find('[data-mid="'+t.message.messageId+'"]').length||I.appendChatMessage(n.find(".chat-content"),t.message),n.is(":visible")?(l.updateActive(n.attr("data-uuid")),I.isAtBottom(n.find(".chat-content"))&&I.scrollToBottom(n.find(".chat-content"))):ajaxify.data.template.chats||i.toggleNew(n.attr("data-uuid"),!0,!0),!r&&(!n.is(":visible")||!app.isFocused)&&l.push("chat",n.attr("data-uuid"),{title:"[[modules:chat.chatting_with]] "+(t.roomName||c),touid:t.message.fromUser.uid,roomId:t.roomId,isSelf:!1})}).apply(null,m)}).catch(d.oe)}return i.onUserStatusChange=function(t){const n=i.getModal(t.uid);app.updateUserStatus(n.find('[component="user/status"]'),t.status)},i.onRoomRename=function(t){const n=$("<div></div>").html(t.newName).text(),c=i.getModal(t.roomId);c.find('[component="chat/room/name"]').text(n),l.update("chat",c.attr("data-uuid"),{title:n}),a.fire("action:chat.renamed",Object.assign(t,{modal:c}))},i.getModal=function(t){return $("#chat-modal-"+t)},i.modalExists=function(t){return $("#chat-modal-"+t).length!==0},i.createModal=function(t,n){n=n||function(){},Promise.all([d.e(2441),d.e(1006),d.e(4271),d.e(9789)]).then(function(){var c=[d(75203),d(30524),d(46862)];(function(r,m,I){app.parseAndTranslate("chat",t,function(s){if(i.modalExists(t.roomId))return n(i.getModal(t.roomId));const k=utils.generateUUID();let x=!1;s.attr("id","chat-modal-"+t.roomId),s.attr("data-roomid",t.roomId),s.attr("intervalId",0),s.attr("data-uuid",k),s.css("position","fixed"),s.appendTo($("body")),s.find(".timeago").timeago(),i.center(s),app.loadJQueryUI(function(){s.find(".modal-content").resizable({handles:"n, e, s, w, se",minHeight:250,minWidth:400}),s.find(".modal-content").on("resize",function(C,N){N.originalSize.height!==N.size.height&&s.find(".modal-body").css("height",i.calculateChatListHeight(s))}),s.draggable({start:function(){l.updateActive(k)},stop:function(){i.focusInput(s)},distance:10,handle:".modal-header"})}),r.apply(s.find('[component="chat/messages"]')),s.find("#chat-close-btn").on("click",function(){i.close(s)});function R(){const C=u.get("chat/input").val();$(window).one("action:ajaxify.end",function(){u.get("chat/input").val(C)}),ajaxify.go("user/"+app.user.userslug+"/chats/"+s.attr("data-roomid")),i.close(s)}s.find(".modal-header").on("dblclick",R),s.find('button[data-action="maximize"]').on("click",R),s.find('button[data-action="minimize"]').on("click",function(){const C=s.attr("data-uuid");i.minimize(C)}),s.on("mouseup",function(){l.updateActive(s.attr("data-uuid")),x&&(x=!1)}),s.on("mousemove",function(C){C.which===1&&(x=!0)}),s.on("mousemove keypress click",function(){e&&(socket.emit("modules.chats.markRead",t.roomId),e=!1)}),m.addActionHandlers(s.find('[component="chat/messages"]'),t.roomId),m.addRenameHandler(s.attr("data-roomid"),s.find('[data-action="rename"]'),t.roomName),m.addLeaveHandler(s.attr("data-roomid"),s.find('[data-action="leave"]')),m.addSendHandlers(s.attr("data-roomid"),s.find(".chat-input"),s.find('[data-action="send"]')),m.addMemberHandler(s.attr("data-roomid"),s.find('[data-action="members"]')),m.createAutoComplete(s.find('[component="chat/input"]')),m.addScrollHandler(s.attr("data-roomid"),t.uid,s.find(".chat-content")),m.addScrollBottomHandler(s.find(".chat-content")),m.addCharactersLeftHandler(s),m.addIPHandler(s),m.addUploadHandler({dragDropAreaEl:s.find(".modal-content"),pasteEl:s,uploadFormEl:s.find('[component="chat/upload"]'),inputEl:s.find('[component="chat/input"]')}),I.addSocketListeners(),l.push("chat",s.attr("data-uuid"),{title:"[[modules:chat.chatting_with]] "+(t.roomName||(t.users.length?t.users[0].username:"")),roomId:t.roomId,icon:"fa-comment",state:"",isSelf:t.isSelf},function(){l.toggleNew(s.attr("data-uuid"),!t.isSelf),a.fire("action:chat.loaded",s),typeof n=="function"&&n(s)})})}).apply(null,c)}).catch(d.oe)},i.focusInput=function(t){setTimeout(function(){t.find('[component="chat/input"]').focus()},20)},i.close=function(t){const n=t.attr("data-uuid");clearInterval(t.attr("intervalId")),t.attr("intervalId",0),t.remove(),t.data("modal",null),l.discard("chat",n),t.attr("data-mobile")&&i.disableMobileBehaviour(t),a.fire("action:chat.closed",{uuid:n,modal:t})},i.closeByUUID=function(t){const n=$('.chat-modal[data-uuid="'+t+'"]');i.close(n)},i.center=function(t){let n=!1;return t.hasClass("hide")&&(t.removeClass("hide"),n=!0),t.css("left",Math.max(0,($(window).width()-$(t).outerWidth())/2+$(window).scrollLeft())+"px"),t.css("top",Math.max(0,$(window).height()/2-$(t).outerHeight()/2)+"px"),n&&t.addClass("hide"),t},i.load=function(t){d.e(6862).then(function(){var n=[d(46862)];(function(c){const r=$('.chat-modal[data-uuid="'+t+'"]');r.removeClass("hide"),l.updateActive(t),c.scrollToBottom(r.find(".chat-content")),i.focusInput(r),socket.emit("modules.chats.markRead",r.attr("data-roomid"));const m=utils.findBootstrapEnvironment();(m==="xs"||m==="sm")&&i.enableMobileBehaviour(r)}).apply(null,n)}).catch(d.oe)},i.enableMobileBehaviour=function(t){app.toggleNavbar(!1),t.attr("data-mobile","1");const n=t.find(".modal-body");n.css("height",i.calculateChatListHeight(t));function c(){n.css("height",i.calculateChatListHeight(t)),d.e(6862).then(function(){var r=[d(46862)];(function(m){m.scrollToBottom(t.find(".chat-content"))}).apply(null,r)}).catch(d.oe)}$(window).on("resize",c),$(window).one("action:ajaxify.start",function(){i.close(t),$(window).off("resize",c)})},i.disableMobileBehaviour=function(){app.toggleNavbar(!0)},i.calculateChatListHeight=function(t){return t.find(".modal-content").outerHeight()-t.find(".modal-header").outerHeight()},i.minimize=function(t){const n=$('.chat-modal[data-uuid="'+t+'"]');n.addClass("hide"),l.minimize("chat",t),clearInterval(n.attr("intervalId")),n.attr("intervalId",0),a.fire("action:chat.minimized",{uuid:t,modal:n})},i.toggleNew=l.toggleNew,i}.apply(E,v),h!==void 0&&(A.exports=h)},7237:(A,E,d)=>{var v;v=function(){const h={};return h.core={"topic/teaser":function(u){return u?$('[component="category/topic"][data-tid="'+u+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(u,l){return $('[component="topic"][data-'+u+'="'+l+'"]')},post:function(u,l){return $('[component="post"][data-'+u+'="'+l+'"]')},"post/content":function(u){return $('[component="post"][data-pid="'+u+'"] [component="post/content"]')},"post/header":function(u){return $('[component="post"][data-pid="'+u+'"] [component="post/header"]')},"post/anchor":function(u){return $('[component="post"][data-index="'+u+'"] [component="post/anchor"]')},"post/vote-count":function(u){return $('[component="post"][data-pid="'+u+'"] [component="post/vote-count"]')},"post/bookmark-count":function(u){return $('[component="post"][data-pid="'+u+'"] [component="post/bookmark-count"]')},"user/postcount":function(u){return $('[component="user/postcount"][data-uid="'+u+'"]')},"user/reputation":function(u){return $('[component="user/reputation"][data-uid="'+u+'"]')},"category/topic":function(u,l){return $('[component="category/topic"][data-'+u+'="'+l+'"]')},"categories/category":function(u,l){return $('[component="categories/category"][data-'+u+'="'+l+'"]')},"chat/message":function(u){return $('[component="chat/message"][data-mid="'+u+'"]')},"chat/message/body":function(u){return $('[component="chat/message"][data-mid="'+u+'"] [component="chat/message/body"]')},"chat/recent/room":function(u){return $('[component="chat/recent/room"][data-roomid="'+u+'"]')}},h.get=function(){const u=Array.prototype.slice.call(arguments,1);return h.core[arguments[0]]&&u.length?h.core[arguments[0]].apply(this,u):$('[component="'+arguments[0]+'"]')},h}.call(E,d,E,A),v!==void 0&&(A.exports=v)},27145:(A,E,d)=>{A=d.nmd(A);var v,h;v=[d(59006),d(32230),d(85233)],h=function(u,l,y){const a={};a.init=function(){const e=this;u.render("modules/taskbar",{}).then(function(o){e.taskbar=$(o),e.tasklist=e.taskbar.find("ul"),$(document.body).append(e.taskbar),e.taskbar.on("click","li",async function(){const t=$(this),n=t.attr("data-module"),c=t.attr("data-uuid"),r=await app.require(n);return t.hasClass("active")?r.minimize(c):(f(),r.load(c),a.toggleNew(c,!1),a.tasklist.removeClass("active"),t.addClass("active")),!1})}),$(window).on("action:app.loggedOut",function(){a.closeAll()})},a.close=async function(e,o){const t=a.tasklist.find('[data-module="'+A+'"][data-uuid="'+o+'"]');let n="close";if(e==="chat"&&(n="closeByUUID"),t.length){const c=await app.require(e);c&&typeof c[n]=="function"&&c[n](o)}},a.closeAll=function(e){let o="[data-uuid]";e&&(o='[data-module="'+e+'"]'+o),a.tasklist.find(o).each(function(t,n){a.close(e||n.getAttribute("data-module"),n.getAttribute("data-uuid"))})},a.discard=function(e,o){a.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]').remove(),p()},a.push=function(e,o,t,n){n=n||function(){};const c=a.tasklist.find('li[data-uuid="'+o+'"]'),r={module:e,uuid:o,options:t,element:c};y.fire("filter:taskbar.push",r),!c.length&&r.module?g(r,n):n(c)},a.get=function(e){return $('[data-module="'+e+'"]').map(function(t,n){return $(n).data()})},a.minimize=function(e,o){a.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]').toggleClass("active",!1)},a.toggleNew=function(e,o,t){a.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",o),t||y.fire("action:taskbar.toggleNew",e)},a.updateActive=function(e){const o=a.tasklist.find("li");o.removeClass("active"),o.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},a.isActive=function(e){return a.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function p(){a.tasklist.find("li").length>0?a.taskbar.attr("data-active","1"):a.taskbar.removeAttr("data-active")}function f(){a.tasklist.find(".active").removeClass("active")}function g(e,o){l.translate(e.options.title,function(t){const n=$("<div></div>").text(t||"NodeBB Task").html(),c=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+n+'" component="taskbar/title">'+n+"</span></a>").attr({title:n,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&f(),a.tasklist.append(c),p(),e.element=c,c.data(e),y.fire("action:taskbar.pushed",e),o(c)})}const i=function(e,o,t){switch(o){case"title":e.find('[component="taskbar/title"]').text(t);break;case"icon":e.find("i").attr("class","fa fa-"+t);break;case"image":e.find("a").css("background-image",t?'url("'+t.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",t);break}};return a.update=function(e,o,t){const n=a.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]');if(!n.length)return;const c=n.data();Object.keys(t).forEach(function(r){c[r]=t[r],i(n,r,t[r])}),n.data(c)},a}.apply(E,v),h!==void 0&&(A.exports=h)}}]);

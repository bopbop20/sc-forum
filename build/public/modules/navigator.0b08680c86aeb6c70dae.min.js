"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[8786,7214,6503,6027,2344,71,7927],{78989:(_,v,b)=>{var P,h;P=[b(31369)],h=function(a){const f={};return f.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return a.prompt("[[global:enter_page_number]]",function(p){f.loadPage(p)}),!1})},f.loadPage=function(p,T){if(T=T||function(){},p=parseInt(p,10),!utils.isNumber(p)||p<1||p>ajaxify.data.pagination.pageCount)return;const o=utils.params();o.page=p;const r=window.location.pathname+"?"+$.param(o);ajaxify.go(r,T)},f.nextPage=function(p){f.loadPage(ajaxify.data.pagination.currentPage+1,p)},f.previousPage=function(p){f.loadPage(ajaxify.data.pagination.currentPage-1,p)},f}.apply(v,P),h!==void 0&&(_.exports=h)},7927:(_,v,b)=>{var P,h;P=[b(32230),b(7237),b(85233)],h=function(a,f,p){const T={};T.alert=function(n){n.alert_id="alert_button_"+(n.alert_id?n.alert_id:new Date().getTime()),n.title=n.title&&n.title.trim()||"",n.message=n.message?n.message.trim():"",n.type=n.type||"info";const s=$("#"+n.alert_id);s.length?r(s,n):o(n)},T.success=function(n,s){T.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:n,type:"success",timeout:s||5e3})},T.error=function(n,s){if(n=n&&n.message||n,n==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}T.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:n,type:"danger",timeout:s||1e4})},T.remove=function(n){$("#alert_button_"+n).remove()};function o(n){app.parseAndTranslate("alert",n,function(s){let u=$("#"+n.alert_id);if(u.length)return r(u,n);u=s,u.fadeIn(200),f.get("toaster/tray").prepend(u),typeof n.closefn=="function"&&u.find("button").on("click",function(){return n.closefn(),g(u),!1}),n.timeout&&j(u,n),typeof n.clickfn=="function"&&u.addClass("pointer").on("click",function(B){$(B.target).is(".close")||n.clickfn(u,n),g(u)}),p.fire("action:alert.new",{alert:u,params:n})})}function r(n,s){n.find("strong").translateHtml(s.title),n.find("p").translateHtml(s.message),n.attr("class","alert alert-dismissable alert-"+s.type+" clearfix"),clearTimeout(parseInt(n.attr("timeoutId"),10)),s.timeout&&j(n,s),p.fire("action:alert.update",{alert:n,params:s}),n.off("click").removeClass("pointer"),typeof s.clickfn=="function"&&n.addClass("pointer").on("click",function(u){$(u.target).is(".close")||s.clickfn(),g(n)})}function g(n){n.fadeOut(500,function(){$(this).remove()})}function j(n,s){const u=s.timeout,B=setTimeout(function(){g(n),typeof s.timeoutfn=="function"&&s.timeoutfn(n,s)},u);n.attr("timeoutId",B),n.css("transition-property","none"),n.removeClass("animate"),setTimeout(function(){n.css("transition-property",""),n.css("transition","width "+(u+450)+"ms linear, background-color "+(u+450)+"ms ease-in"),n.addClass("animate"),p.fire("action:alert.animate",{alert:n,params:s})},50),n.on("mouseenter",function(){$(this).css("transition-duration",0)})}return T}.apply(v,P),h!==void 0&&(_.exports=h)},7237:(_,v,b)=>{var P;P=function(){const h={};return h.core={"topic/teaser":function(a){return a?$('[component="category/topic"][data-tid="'+a+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(a,f){return $('[component="topic"][data-'+a+'="'+f+'"]')},post:function(a,f){return $('[component="post"][data-'+a+'="'+f+'"]')},"post/content":function(a){return $('[component="post"][data-pid="'+a+'"] [component="post/content"]')},"post/header":function(a){return $('[component="post"][data-pid="'+a+'"] [component="post/header"]')},"post/anchor":function(a){return $('[component="post"][data-index="'+a+'"] [component="post/anchor"]')},"post/vote-count":function(a){return $('[component="post"][data-pid="'+a+'"] [component="post/vote-count"]')},"post/bookmark-count":function(a){return $('[component="post"][data-pid="'+a+'"] [component="post/bookmark-count"]')},"user/postcount":function(a){return $('[component="user/postcount"][data-uid="'+a+'"]')},"user/reputation":function(a){return $('[component="user/reputation"][data-uid="'+a+'"]')},"category/topic":function(a,f){return $('[component="category/topic"][data-'+a+'="'+f+'"]')},"categories/category":function(a,f){return $('[component="categories/category"][data-'+a+'="'+f+'"]')},"chat/message":function(a){return $('[component="chat/message"][data-mid="'+a+'"]')},"chat/message/body":function(a){return $('[component="chat/message"][data-mid="'+a+'"] [component="chat/message/body"]')},"chat/recent/room":function(a){return $('[component="chat/recent/room"][data-roomid="'+a+'"]')}},h.get=function(){const a=Array.prototype.slice.call(arguments,1);return h.core[arguments[0]]&&a.length?h.core[arguments[0]].apply(this,a):$('[component="'+arguments[0]+'"]')},h}.call(v,b,v,_),P!==void 0&&(_.exports=P)},42840:(_,v,b)=>{var P,h;P=[b(78989),b(7237),b(85233),b(7927)],h=function(a,f,p,T){const o={};let r=0,g=0,j,n,s,u,B,N=!1,E=!0;o.scrollActive=!1;let d=$(".pagination-block"),V=d.find(".pagination-text"),z=d.find("meter"),G=d.find(".progress-bar"),m,U,J,D,H;$(window).on("action:ajaxify.start",function(){$(window).off("keydown",X)}),o.init=function(t,e,i,l,w){r=0,o.selector=t,o.callback=w,o.toTop=i||function(){},o.toBottom=l||function(){},d=$(".pagination-block"),V=d.find(".pagination-text"),z=d.find("meter"),G=d.find(".progress-bar"),J=$(".scroller-thumb-icon"),D=J.height(),H=D/2,m=$(".scroller-thumb"),U=m.find(".thumb-text"),$(window).off("scroll",o.delayedUpdate).on("scroll",o.delayedUpdate),d.find(".dropdown-menu").off("click").on("click",function(y){y.stopPropagation()}),d.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",function(){setTimeout(async function(){utils.findBootstrapEnvironment()==="lg"&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&d.find("#myNextPostBtn").removeAttr("disabled")},100)}),d.find(".pageup").off("click").on("click",o.scrollUp),d.find(".pagedown").off("click").on("click",o.scrollDown),d.find(".pagetop").off("click").on("click",o.toTop),d.find(".pagebottom").off("click").on("click",o.toBottom),d.find("#myNextPostBtn").off("click").on("click",Q),d.find("input").on("keydown",function(y){if(y.which===13){const c=$(this);if(!utils.isNumber(c.val())){c.val("");return}const x=parseInt(c.val(),10),I=Y(x);c.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(I)}}),ajaxify.data.template.topic&&Z(),q(),o.setCount(e),o.update(0)};let W=0;async function Q(){async function t(e){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,e),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let e=await t(r);W===e&&(e=await t(e)),e&&r!==e+1?(W=e,$(window).one("action:ajaxify.end",function(){d.find(".dropdown-menu").is(":hidden")&&d.find(".dropdown-toggle").dropdown("toggle")}),o.scrollToIndex(e,!0,0)):(T.alert({message:"[[topic:no-more-next-post]]",type:"info"}),W=1)}}function R(t){const e=m.parent(),i=e.offset();return t<i.top?t=i.top:t>i.top+e.height()-D&&(t=i.top+e.height()-D),t}function S(t){if(!m.length||m.is(":hidden"))return;const e=m.parent(),i=e.offset();let l=(t-1)/ajaxify.data.postcount;t===g&&(l=1);const y={top:R(i.top+(e.height()-D)*l),left:m.offset().left};m.offset(y),U.text(t+"/"+ajaxify.data.postcount),O(t)}function Z(){if(!m.length)return;const t=m.parent();t.on("click",function(c){if($(c.target).hasClass("scroller-container")){const x=e(c.pageY);return o.scrollToIndex(x-1,!0,0),!1}});function e(c){const x=R(c-H),I=t.offset(),C=(x-I.top)/(t.height()-D);return r=Math.max(1,Math.ceil(ajaxify.data.postcount*C)),r>ajaxify.data.postcount?ajaxify.data.count:r}let i=!1;p.on("action:ajaxify.end",function(){B=null}),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",function(){S(r)}),m.on("mousedown",function(){i=!0,$(window).on("mousemove",w),E=!0});function l(){$(window).off("mousemove",w),i&&(o.scrollToIndex(r-1,!0,0),d.find('[data-toggle="dropdown"]').trigger("click")),F(),i=!1,E=!1}function w(c){const x=R(c.pageY-H);m.offset({top:x,left:m.offset().left});const I=e(c.pageY);return o.updateTextAndProgressBar(),U.text(I+"/"+ajaxify.data.postcount),E&&y(),E=!1,c.stopPropagation(),!1}function y(){F(),n=setInterval(function(){O(r)},250)}$(window).off("mousemove",w),$(window).off("mouseup",l).on("mouseup",l),m.on("touchstart",function(c){N=!0,s=Math.min($(window).width(),Math.max(0,c.touches[0].clientX)),u=Math.min($(window).height(),Math.max(0,c.touches[0].clientY)),E=!0}),m.on("touchmove",function(c){const x=$(window).width(),I=$(window).height(),C=Math.abs(s-Math.min(x,Math.max(0,c.touches[0].clientX))),k=Math.abs(u-Math.min(I,Math.max(0,c.touches[0].clientY)));if(s=Math.min(x,Math.max(0,c.touches[0].clientX)),u=Math.min(I,Math.max(0,c.touches[0].clientY)),k>=C&&E&&(N=!0,y()),N&&c.cancelable){c.preventDefault(),c.stopPropagation();const M=R(u+$(window).scrollTop()-H);m.offset({top:M,left:m.offset().left});const A=e(u+$(window).scrollTop());o.updateTextAndProgressBar(),U.text(A+"/"+ajaxify.data.postcount),E&&O(A)}E=!1}),m.on("touchend",function(){F(),N&&(o.scrollToIndex(r-1,!0,0),N=!1,d.find('[data-toggle="dropdown"]').trigger("click"))})}function F(){n&&(clearInterval(n),n=0)}function O(t,e){e=e||function(){},!(B===t||d.find(".post-content").is(":hidden"))&&(B=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},function(i,l){if(i)return T.error(i);app.parseAndTranslate("partials/topic/navigation-post",{post:l},function(w){d.find(".post-content").html(w).find(".timeago").timeago()}),e()}))}function q(){config.usePagination||$(window).off("keydown",X).on("keydown",X)}function X(t){if(t.target.nodeName==="BODY"){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(t.which===36&&o.toTop)return o.toTop(),!1;if(t.which===35&&o.toBottom)return o.toBottom(),!1}}function Y(t){const i=window.location.pathname.replace(config.relative_path,"").split("/");return i[1]+"/"+i[2]+"/"+i[3]+(t?"/"+t:"")}o.getCount=()=>g,o.setCount=function(t){t=parseInt(t,10),t!==g&&(g=t,o.updateTextAndProgressBar())},o.show=function(){L(!0)},o.disable=function(){g=0,r=1,o.callback=null,o.selector=null,$(window).off("scroll",o.delayedUpdate),L(!1)};function L(t){const e=ajaxify.removeRelativePath(window.location.pathname.slice(1));t&&!e.startsWith("topic")&&!e.startsWith("category")||d.toggleClass("ready",t)}return o.delayedUpdate=function(){j||(j=setTimeout(function(){o.update(),j=void 0},100))},o.update=function(t){t=typeof t=="number"?t:void 0;let e=r;const i=$(o.selector);i.length&&(e=parseInt(i.first().attr("data-index"),10)+1);const l=$(window).scrollTop(),w=$(window).height(),y=$(document).height(),c=l+w/2;let x=Number.MAX_VALUE;i.each(function(){const k=$(this),M=parseInt(k.attr("data-index"),10);if(M>=0){const A=Math.abs(c-(k.offset().top+k.outerHeight(!0)/2));if(A>x)return!1;A<x&&(e=M+1,x=A)}});const I=l===0&&parseInt(i.first().attr("data-index"),10)===0,C=l+w>y-100&&parseInt(i.last().attr("data-index"),10)===g-1;if(I?e=1:C&&(e=g),t===void 0&&ajaxify.data.template.topic)if(I)t=0;else{const k=f.get("post/anchor",r-1);k.length&&(t=k.get(0).getBoundingClientRect().top)}typeof o.callback=="function"&&o.callback(e,g,t),e!==r&&(r=e,o.updateTextAndProgressBar(),S(r)),L(!!g)},o.getIndex=()=>r,o.setIndex=t=>{r=t+1,o.updateTextAndProgressBar(),S(r)},o.updateTextAndProgressBar=function(){if(!utils.isNumber(r))return;r=r>g?g:r,V.translateHtml("[[global:pagination.out_of, "+r+", "+g+"]]");const t=(r-1)/(g-1||1);z.val(t),G.width(t*100+"%")},o.scrollUp=function(){const t=$(window);if(config.usePagination&&t.scrollTop()<=0)return a.previousPage(function(){$("body,html").scrollTop($(document).height()-t.height())});$("body,html").animate({scrollTop:t.scrollTop()-t.height()})},o.scrollDown=function(){const t=$(window);if(config.usePagination&&t.scrollTop()>=$(document).height()-t.height())return a.nextPage();$("body,html").animate({scrollTop:t.scrollTop()+t.height()})},o.scrollTop=function(t){$(o.selector+'[data-index="'+t+'"]').length?o.scrollToIndex(t,!0):ajaxify.go(Y())},o.scrollBottom=function(t){parseInt(t,10)<0||($(o.selector+'[data-index="'+t+'"]').length?o.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(Y(t))))},o.scrollToIndex=function(t,e,i){const l=!!f.get("topic").length,w=!!f.get("category").length;if(!utils.isNumber(t)||!l&&!w)return;if(i=i!==void 0?i:400,o.scrollActive=!0,l&&f.get("post/anchor",t).length)return o.scrollToPostIndex(t,e,i);if(w&&$('[component="category/topic"][data-index="'+t+'"]').length)return o.scrollToTopicIndex(t,e,i);if(!config.usePagination){o.scrollActive=!1,t=parseInt(t,10)+1,ajaxify.go(Y(t));return}const y=l?o.scrollToPostIndex:o.scrollToTopicIndex,c=1+Math.floor(t/config.postsPerPage);parseInt(c,10)!==ajaxify.data.pagination.currentPage?a.loadPage(c,function(){y(t,e,i)}):y(t,e,i)},o.scrollToPostIndex=function(t,e,i){const l=f.get("post","index",t);o.scrollToElement(l,e,i,t)},o.scrollToTopicIndex=function(t,e,i){const l=$('[component="category/topic"][data-index="'+t+'"]');o.scrollToElement(l,e,i,t)},o.scrollToElement=async(t,e,i,l=null)=>{if(!t.length){o.scrollActive=!1;return}await p.fire("filter:navigator.scroll",{scrollTo:t,highlight:e,duration:i,newIndex:l});const w=t.outerHeight(!0),y=f.get("navbar").outerHeight(!0)||0,c=$(".topic-header").outerHeight(!0)||0,x=$(window).height();$(window).off("scroll",o.delayedUpdate),i=i!==void 0?i:400,o.scrollActive=!0;let I=!1;function C(){function M(){setTimeout(()=>{$(window).on("scroll",o.delayedUpdate),p.fire("action:navigator.scrolled",{scrollTo:t,highlight:e,duration:i,newIndex:l})},50)}function A(){if(I){M();return}I=!0,o.scrollActive=!1,k();const tt=t.get(0).getBoundingClientRect();l?o.setIndex(l):o.update(tt.top)}let K=0;if(w<x-y-c?K=t.offset().top-x/2+w/2:K=t.offset().top-y-c,i===0){$(window).scrollTop(K),A(),M();return}$("html, body").animate({scrollTop:K+"px"},i,A)}function k(){e&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout(function(){t.removeClass("highlight")},1e4))}C()},o}.apply(v,P),h!==void 0&&(_.exports=h)}}]);

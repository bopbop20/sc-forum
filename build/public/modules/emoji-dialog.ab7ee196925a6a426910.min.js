(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4625,7986,2735,1322,2160,5400],{99398:(b,R,c)=>{b.exports=c(18196)},83713:(b,R,c)=>{b.exports=c(51077)},6721:(b,R,c)=>{b.exports=c(70968)},40646:(b,R,c)=>{b.exports=c(82938)},75203:(b,R,c)=>{"use strict";var C;C=function(){const A={};return A.apply=function(y){$(y).on("mousewheel",function(e){const t=this.scrollTop,s=this.scrollHeight,a=Math.round(this.getBoundingClientRect().height);if(e.originalEvent.deltaY<0&&t===0||e.originalEvent.deltaY>0&&a+t>=s)return!1})},A}.call(R,c,R,b),C!==void 0&&(b.exports=C)},18196:(b,R,c)=>{"use strict";var C,A;C=[c(83713)],A=function(y){var e={};return e.insertIntoTextarea=function(t,s){var a={context:this,textarea:t,value:s,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",a),!a.preventDefault){var u=$(a.textarea),d=u.val(),n=u.parents('[component="composer"]');u.val(d.slice(0,a.textarea.selectionStart)+a.value+d.slice(a.textarea.selectionStart)),y.render(n)}},e.wrapSelectionInTextareaWith=function(t,s,a){var u={context:this,textarea:t,leading:s,trailing:a,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",u),!u.preventDefault){a===void 0&&(a=s);var d=$(t),n=d.val(),i=/^(\s*)([\s\S]*?)(\s*)$/.exec(n.slice(t.selectionStart,t.selectionEnd));return i[2]||(i=[null,"",n.slice(t.selectionStart,t.selectionEnd),""]),d.val(n.slice(0,t.selectionStart)+i[1]+s+i[2]+a+i[3]+n.slice(t.selectionEnd)),[i[1].length,i[3].length]}},e.updateTextareaSelection=function(t,s,a){var u={context:this,textarea:t,start:s,end:a,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",u),!u.preventDefault&&(t.setSelectionRange(u.start,u.end),$(u.textarea).focus())},e.getBlockData=function(t,s,a){var u=t.value;s=s.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var d=new RegExp(s,"g"),n,i=[],v;for(u=u.split(`
`).reduce(function(g,D){return g!==null||(g=a<=D.length?D:null,g===null&&(a-=D.length+1)),g},null);(n=d.exec(u))!==null;)i.push(n.index);return v={in:!!(i.reduce(function(g,D){return a>=D+2&&(g+=1),g},0)%2),atEnd:i.reduce(function(g,D){return g||a===D},!1)},v.atEnd=v.in?v.atEnd:!1,v},e}.apply(R,C),A!==void 0&&(b.exports=A)},51077:(b,R,c)=>{"use strict";var C,A;C=[c(85233)],A=function(y){var e={};return e.render=function(t,s){if(s=s||function(){},!t.find(".preview-container").is(":visible"))return s();var a=t.find("textarea");socket.emit("plugins.composer.renderPreview",a.val(),function(u,d){u||(d=$("<div>"+d+"</div>"),d.find("img:not(.not-responsive)").addClass("img-responsive"),t.find(".preview").html(d),y.fire("action:composer.preview"),s())})},e.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var s=t.find("textarea"),a=t.find(".preview");if(s.length&&a.length){var u=s[0].scrollHeight-s.height();if(u===0)return;var d=s.scrollTop()/u;a.scrollTop(Math.max(a[0].scrollHeight-a.height(),0)*d)}}},e.handleToggler=function(t){e.env=utils.findBootstrapEnvironment();var s=t.find(".write-container .toggle-preview"),a=t.find(".preview-container .toggle-preview"),u=$(".preview-container"),d=$(".write-container");function n(){v(!1),e.env!=="xs"&&e.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function i(){v(!0),e.env!=="xs"&&e.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function v(g){e.env==="xs"||e.env==="sm"?(u.toggleClass("hide",!1),d.toggleClass("maximized",!1),s.toggleClass("hide",!0),u.toggleClass("hidden-xs hidden-sm",!g),d.toggleClass("hidden-xs hidden-sm",g),g&&e.render(t)):(u.toggleClass("hide",!g),d.toggleClass("maximized",!g),s.toggleClass("hide",g)),e.matchScroll(t)}e.toggle=v,a.on("click",function(){n(),t.find(".write").focus()}),s.on("click",function(){i(),t.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||e.env==="xs"||e.env==="sm"?n():i()},e}.apply(R,C),A!==void 0&&(b.exports=A)},70968:(b,R,c)=>{var C,A;C=[c,R,c(32230),c(59006),c(99398),c(75203),c(40646)],A=function(y,e,t,s,a,u,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toggleForInsert=e.toggle=e.init=e.dialogActions=void 0;var n=$("html");e.dialogActions={open:function(p){return n.addClass("emoji-insert"),p.addClass("open"),p.appendTo(document.fullscreenElement||"body"),p.find(".emoji-dialog-search").focus(),setTimeout(function(){$(document).off("click",i).on("click",i)},0),p},close:function(p){return $(document).off("click",i),n.removeClass("emoji-insert"),p.removeClass("open")}};function i(p){var o=$("#emoji-dialog");!$(p.target).is(".emoji-dialog *")&&o.length&&e.dialogActions.close(o)}var v={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(v.custom=100);var g=t.Translator.create();function D(p,o){return p<o?-1:p>o?1:0}function S(p){Promise.all([$.getJSON(d.base+"/emoji/categories.json?"+d.buster),$.getJSON(d.base+"/emoji/packs.json?"+d.buster),new Promise(function(o){return d.init(o)})]).then(function(o){var r=o[0],f=o[1],l=Object.keys(r).map(function(h){var E=r[h].map(function(m){return d.table[m]});return{name:h,emojis:E.map(function(m){return{name:m.name,html:d.buildEmoji(m,!0)}}).sort(function(m,w){return D(m.name,w.name)})}}).sort(function(h,E){var m=v[h.name]||0,w=v[E.name]||0;return w-m});return s.render("partials/emoji-dialog",{categories:l,packs:f})}).then(function(o){return g.translate(o)}).then(function(o){var r=$(o).appendTo(document.fullscreenElement||"body");r.find(".emoji-dialog-search").on("input",function(m){var w=m.target.value;if(!w){r.find(".emoji-dialog-search-results").addClass("hidden"),r.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");return}var T=d.search(w).slice(0,100).map(function(P){return'<a class="emoji-link" name="'+P.name+'" href="#">'+d.buildEmoji(P,!1)+"</a>"}).join(`
`);r.find(".tab-pane.emoji-dialog-search-results").html(T),r.find(".emoji-dialog-search-results").removeClass("hidden"),r.find(".nav-tabs .emoji-dialog-search-results a").tab("show")});var f=r.find(".emoji-tabs .tab-content");function l(m){var w=f[0].getBoundingClientRect(),T=Math.ceil(w.width*w.height/(40*40));m.find(".emoji-link img.defer").filter(function(P,I){if(P<=T)return!0;var j=I.getBoundingClientRect();return j.right>w.left&&j.left<w.right&&j.bottom>w.top&&j.top<w.bottom}).removeClass("defer").each(function(P,I){var j=I.getAttribute("data-src");I.setAttribute("src",j)})}var h=r.find(".emoji-tabs .nav-tabs a").click(function(m){m.preventDefault(),$(m.target).tab("show")}).on("show.bs.tab",function(m){l($(m.target.getAttribute("href")))}).eq(1);setTimeout(function(){return h.trigger("show.bs.tab")},10),f.on("scroll",function(){l(f.find(".tab-pane.active"))}),u.apply(f[0]);var E=function(){return e.dialogActions.close(r)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),E),r.find(".close").on("click",E),r.draggable&&r.draggable({handle:".top-bar"}),p(r)}).catch(function(o){console.error("Failed to initialize emoji dialog",o)})}e.init=S;function B(p,o){function r(l){if(l.hasClass("open")){e.dialogActions.close(l);return}l.off("click").on("click",".emoji-link",function(m){m.preventDefault();var w=m.currentTarget.name;o(m,w,l)});var h=p?p.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},E={bottom:"auto",top:"auto",right:"auto",left:"auto"};h.top>440?E.top=h.top-400+"px":E.top=h.top+40+"px",h.left<window.innerWidth/2?E.left=h.left+40+"px":E.left=h.left-400+"px",l.css(E),e.dialogActions.open(l)}var f=$("#emoji-dialog");f.length?r(f):S(r)}e.toggle=B;function _(p,o,r,f){var l;f&&f.target?l=$(f.target):l=$(p).parents(".composer-container").find('[data-format="emoji-add-emoji"]'),l=l[0],B(l,function(h,E){var m=":"+E+": ",w=p.selectionStart,T=p.selectionEnd,P=T+m.length,I=w===T?P:w;a.insertIntoTextarea(p,m),a.updateTextareaSelection(p,I,P),$(p).trigger("input")})}e.toggleForInsert=_}.apply(R,C),A!==void 0&&(b.exports=A)},82938:(b,R,c)=>{var C,A;C=[c,R],A=function(y,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=e.strategy=e.search=e.table=e.buildEmoji=e.buster=e.base=void 0;var t=config.assetBaseUrl+"/plugins/nodebb-plugin-emoji";e.base=t;var s=config["cache-buster"];e.buster=s;function a(n,i){var v=":"+n.name+":",g=i?" defer":"";return n.image?`<img
      `+(i?"data-":"")+'src="'+t+"/emoji/"+n.pack+"/"+n.image+"?"+s+`"
      class="not-responsive emoji emoji-`+n.pack+" emoji--"+n.name+" "+g+`"
      title="`+v+`"
      alt="`+n.character+`"
    />`:`<span
    class="emoji-`+n.pack+" emoji--"+n.name+`"
    title="`+v+`"
  ><span>`+n.character+"</span></span>"}e.buildEmoji=a,e.strategy={match:/\B:([^\s\n:]+)$/,search:function(n,i){i(e.search(n.toLowerCase().replace(/[_-]/g,"")).slice(0,10))},index:1,replace:function(n){return":"+n.name+": "},template:function(n){return a(n)+" "+n.name},cache:!0};var u;function d(n){return u=u||Promise.all([new Promise(function(i,v){c.e(2645).then(function(){var g=[c(91919)];i.apply(null,g)}.bind(this)).catch(v.bind(this))}),new Promise(function(i,v){c.e(320).then(function(){var g=[c(78726)];i.apply(null,g)}.bind(this)).catch(v.bind(this))}),new Promise(function(i,v){Promise.all([c.e(6177),c.e(2526),c.e(588)]).then(function(){var g=[c(45482)];i.apply(null,g)}.bind(this)).catch(v.bind(this))}),$.getJSON(t+"/emoji/table.json?"+s)]).then(function(i){var v=i[0],g=i[1],D=i[2],S=i[3];e.table=S;var B=Object.keys(e.table).map(function(o){var r=e.table[o];return{name:o,aliases:r.aliases,keywords:r.keywords,character:r.character,image:r.image,pack:r.pack}});function _(o,r){for(var f=r.length,l=0;l<f;l+=1)if(v(o,r[l]))return r[l];return null}function p(o){function r(f,l){var h=l*(1+g(o,f));return f.startsWith(o)?h-2:h}return B.filter(function(f){if(v(o,f.name))return f.score=r(f.name,1),!0;var l=_(o,f.aliases);if(l)return f.score=r(l,3),!0;var h=_(o,f.keywords);return h?(f.score=r(h,7),!0):!1}).sort(function(f,l){return f.score-l.score}).sort(function(f,l){var h=+f.name.startsWith(o),E=+l.name.startsWith(o);return E-h})}e.search=p,D.addButtonDispatch("emoji-add-emoji",function(o,r,f,l){new Promise(function(h,E){c.e(5400).then(function(){var m=[c(6721)];h.apply(null,m)}.bind(this)).catch(E.bind(this))}).then(function(h){var E=h.toggleForInsert;return E(o,r,f,l)})})}).catch(function(i){var v=Error("[[emoji:meta-load-failed]]");throw console.error(v),app.alertError(v),i}),n&&u.then(function(){return setTimeout(n,0)}),u}e.init=d}.apply(R,C),A!==void 0&&(b.exports=A)}}]);

(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4271,8894,2735,8306,6862],{30524:(I,w,f)=>{"use strict";var A,y;A=[f(7237),f(32230),f(42441),f(81018),f(18596),f(46862),f(2585),f(85233),f(31369),f(7927),f(93216),f(74344),f(33371)],y=function(c,r,n,i,p,o,g,v,m,x,u,h,D){const e={initialised:!1};let l=!1;return e.init=function(){const t=utils.findBootstrapEnvironment();e.initialised||(e.addSocketListeners(),e.addGlobalEventListeners()),i.init(),e.addEventListeners(),e.setActive(),(t==="md"||t==="lg")&&e.addHotkeys(),$(document).ready(function(){v.fire("action:chat.loaded",$(".chats-full"))}),e.initialised=!0,o.scrollToBottom($(".expanded-chat ul.chat-content")),p.init(),ajaxify.data.hasOwnProperty("roomId")&&c.get("chat/input").focus()},e.addEventListeners=function(){e.addSendHandlers(ajaxify.data.roomId,$(".chat-input"),$('.expanded-chat button[data-action="send"]')),e.addPopoutHandler(),e.addActionHandlers(c.get("chat/messages"),ajaxify.data.roomId),e.addMemberHandler(ajaxify.data.roomId,c.get("chat/controls").find('[data-action="members"]')),e.addRenameHandler(ajaxify.data.roomId,c.get("chat/controls").find('[data-action="rename"]')),e.addLeaveHandler(ajaxify.data.roomId,c.get("chat/controls").find('[data-action="leave"]')),e.addScrollHandler(ajaxify.data.roomId,ajaxify.data.uid,$(".chat-content")),e.addScrollBottomHandler($(".chat-content")),e.addCharactersLeftHandler($('[component="chat/main-wrapper"]')),e.addIPHandler($('[component="chat/main-wrapper"]')),e.createAutoComplete($('[component="chat/input"]')),e.addUploadHandler({dragDropAreaEl:$(".chats-full"),pasteEl:$('[component="chat/input"]'),uploadFormEl:$('[component="chat/upload"]'),inputEl:$('[component="chat/input"]')}),$('[data-action="close"]').on("click",function(){e.switchChat()})},e.addUploadHandler=function(t){D.init({dragDropAreaEl:t.dragDropAreaEl,pasteEl:t.pasteEl,uploadFormEl:t.uploadFormEl,route:"/api/post/upload",callback:function(a){const s=t.inputEl;let d=s.val();a.forEach(E=>{d=d+(d?`
`:"")+(E.isImage?"!":"")+`[${E.filename}](${E.url})`}),s.val(d)}})},e.addIPHandler=function(t){t.on("click",".chat-ip-button",function(){const a=$(this).parent(),s=a.parents("[data-mid]").attr("data-mid");socket.emit("modules.chats.getIP",s,function(d,E){if(d)return x.error(d);a.html(E)})})},e.addPopoutHandler=function(){$('[data-action="pop-out"]').on("click",function(){const t=c.get("chat/input").val(),a=ajaxify.data.roomId;app.previousUrl&&app.previousUrl.match(/chats/)?ajaxify.go("user/"+ajaxify.data.userslug+"/chats",function(){u.openChat(a,ajaxify.data.uid)},!0):(window.history.go(-1),u.openChat(a,ajaxify.data.uid)),$(window).one("action:chat.loaded",function(){c.get("chat/input").val(t)})})},e.addScrollHandler=function(t,a,s){let d=!1;s.off("scroll").on("scroll",function(){if(o.toggleScrollUpAlert(s),d)return;const E=(s[0].scrollHeight-s.height())*.1;if(s.scrollTop()>=E)return;d=!0;const C=parseInt(s.children("[data-mid]").length,10);h.get(`/chats/${t}/messages`,{uid:a,start:C}).then(k=>{if(k=k.messages,!k){d=!1;return}if(k=k.filter(function(S){return!$('[component="chat/message"][data-mid="'+S.messageId+'"]').length}),!k.length){d=!1;return}o.parseMessage(k,function(S){const j=s.scrollTop(),H=s[0].scrollHeight;S=$(S),s.prepend(S),S.find(".timeago").timeago(),S.find("img:not(.not-responsive)").addClass("img-responsive"),s.scrollTop(s[0].scrollHeight-H+j),d=!1})}).catch(x.error)})},e.addScrollBottomHandler=function(t){t.parent().find('[component="chat/messages/scroll-up-alert"]').off("click").on("click",function(){o.scrollToBottom(t)})},e.addCharactersLeftHandler=function(t){t.find('[component="chat/input"]').on("change keyup paste",function(){o.updateRemainingLength(t)})},e.addActionHandlers=function(t,a){t.on("click","[data-action]",function(){const s=$(this).parents("[data-mid]").attr("data-mid");switch(this.getAttribute("data-action")){case"edit":{const E=$('[data-roomid="'+a+'"] [component="chat/input"]');o.prepEdit(E,s,a);break}case"delete":o.delete(s,a);break;case"restore":o.restore(s,a);break}})},e.addHotkeys=function(){n.bind("ctrl+up",function(){const a=$(".chats-list .bg-info").prev();a.length&&e.switchChat(a.attr("data-roomid"))}),n.bind("ctrl+down",function(){const a=$(".chats-list .bg-info").next();a.length&&e.switchChat(a.attr("data-roomid"))}),n.bind("up",function(t){if(t.target===c.get("chat/input").get(0)){const a=c.get("chat/messages").find('.chat-message[data-self="1"]').last();if(!a.length)return;const s=a.attr("data-mid"),d=c.get("chat/input");o.prepEdit(d,s,ajaxify.data.roomId)}})},e.addMemberHandler=function(t,a){let s;a.on("click",function(){app.parseAndTranslate("partials/modals/manage_room",{},function(d){s=m.dialog({title:"[[modules:chat.manage-room]]",message:d}),s.attr("component","chat/manage-modal"),e.refreshParticipantsList(t,s),e.addKickHandler(t,s);const E=s.find("input"),C=s.find(".text-danger");f.e(6193).then(function(){var k=[f(86193),f(32230)];(function(S,j){S.user(E,function(H,T){C.text(""),h.post(`/chats/${t}/users`,{uids:[T.item.user.uid]}).then(b=>{e.refreshParticipantsList(t,s,b),E.val("")}).catch(b=>{j.translate(b.message,function(L){C.text(L)})})})}).apply(null,k)}).catch(f.oe)})})},e.addKickHandler=function(t,a){a.on("click",'[data-action="kick"]',function(){const s=parseInt(this.getAttribute("data-uid"),10);h.delete(`/chats/${t}/users/${s}`,{}).then(d=>{e.refreshParticipantsList(t,a,d)}).catch(x.error)})},e.addLeaveHandler=function(t,a){a.on("click",function(){m.confirm({size:"small",title:"[[modules:chat.leave]]",message:'<p>[[modules:chat.leave-prompt]]</p><p class="help-block">[[modules:chat.leave-help]]</p>',callback:function(s){s&&h.delete(`/chats/${t}/users/${app.user.uid}`,{}).then(()=>{const d=a.parents(".chat-modal");d.length?u.close(d):ajaxify.go("chats")}).catch(x.error)}})})},e.refreshParticipantsList=async(t,a,s)=>{const d=a.find(".list-group");if(!s)try{s=await h.get(`/chats/${t}/users`,{})}catch{r.translate("[[error:invalid-data]]",function(C){d.find("li").text(C)})}app.parseAndTranslate("partials/modals/manage_room_users",s,function(E){d.html(E)})},e.addRenameHandler=function(t,a,s){let d;a.on("click",function(){app.parseAndTranslate("partials/modals/rename_room",{name:s||ajaxify.data.roomName},function(C){d=m.dialog({title:"[[modules:chat.rename-room]]",message:C,buttons:{save:{label:"[[global:save]]",className:"btn-primary",callback:E}}})})});function E(){h.put(`/chats/${t}`,{name:d.find("#roomName").val()}).catch(x.error)}},e.addSendHandlers=function(t,a,s){a.off("keypress").on("keypress",function(d){if(d.which===13&&!d.shiftKey)return o.sendMessage(t,a),!1}),s.off("click").on("click",function(){return o.sendMessage(t,a),a.focus(),!1})},e.createAutoComplete=function(t){if(!t.length)return;const a={element:t,strategies:[],options:{style:{"z-index":2e4,flex:0,top:"inherit"},placement:"top"}};$(window).trigger("chat:autocomplete:init",a),a.strategies.length&&g.setup(a)},e.leave=function(t){const a=t.attr("data-roomid");h.delete(`/chats/${a}/users/${app.user.uid}`,{}).then(()=>{parseInt(a,10)===parseInt(ajaxify.data.roomId,10)?ajaxify.go("user/"+ajaxify.data.userslug+"/chats"):t.remove();const s=u.getModal(a);s.length&&u.close(s)}).catch(x.error)},e.switchChat=function(t){t||(t="");const a="user/"+ajaxify.data.userslug+"/chats/"+t+window.location.search;self.fetch?fetch(config.relative_path+"/api/"+a,{credentials:"include"}).then(function(s){s.ok?s.json().then(function(d){app.parseAndTranslate("partials/chats/message-window",d,function(E){c.get("chat/main-wrapper").html(E),E.find(".timeago").timeago(),ajaxify.data=d,e.setActive(),e.addEventListeners(),v.fire("action:chat.loaded",$(".chats-full")),o.scrollToBottom($(".expanded-chat ul.chat-content")),history.pushState&&history.pushState({url:a},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+a)})}):console.warn("[search] Received "+s.status)}).catch(function(s){console.warn("[search] "+s.message)}):ajaxify.go(a)},e.addGlobalEventListeners=function(){$(window).on("mousemove keypress click",function(){l&&ajaxify.data.roomId&&(socket.emit("modules.chats.markRead",ajaxify.data.roomId),l=!1)})},e.addSocketListeners=function(){socket.on("event:chats.receive",function(t){if(parseInt(t.roomId,10)===parseInt(ajaxify.data.roomId,10))l=t.self===0,t.message.self=t.self,o.appendChatMessage($(".expanded-chat .chat-content"),t.message);else if(ajaxify.data.template.chats){const a=$("[data-roomid="+t.roomId+"]");if(a.length>0)a.addClass("unread");else{const s=c.get("chat/recent");app.parseAndTranslate("partials/chats/recent_room",{rooms:{roomId:t.roomId,lastUser:t.message.fromUser,usernames:t.message.fromUser.username,unread:!0}},function(d){s.prepend(d)})}}}),socket.on("event:user_status_change",function(t){app.updateUserStatus($('.chats-list [data-uid="'+t.uid+'"] [component="user/status"]'),t.status)}),o.addSocketListeners(),socket.on("event:chats.roomRename",function(t){const s=c.get("chat/recent/room",t.roomId).find('[component="chat/title"]');ajaxify.data.roomName=t.newName,s.text(t.newName)})},e.setActive=function(){ajaxify.data.roomId&&(socket.emit("modules.chats.markRead",ajaxify.data.roomId),$('[data-roomid="'+ajaxify.data.roomId+'"]').toggleClass("unread",!1),$('.expanded-chat [component="chat/input"]').focus()),$(".chats-list li").removeClass("bg-info"),$('.chats-list li[data-roomid="'+ajaxify.data.roomId+'"]').addClass("bg-info"),c.get("chat/nav-wrapper").attr("data-loaded",ajaxify.data.roomId?"1":"0")},e}.apply(w,A),y!==void 0&&(I.exports=y)},46862:(I,w,f)=>{"use strict";var A,y;A=[f(7237),f(32230),f(59006),f(85233),f(31369),f(7927),f(44882),f(74344)],y=function(c,r,n,i,p,o,g,v){const m={};m.sendMessage=async function(e,l){let t=l.val(),a=l.attr("data-mid");if(!t.trim().length)return;l.val(""),l.removeAttr("data-mid"),m.updateRemainingLength(l.parent());const s={roomId:e,message:t,mid:a};i.fire("action:chat.sent",s),{roomId:e,message:t,mid:a}=await i.fire("filter:chat.send",s),a?v.put(`/chats/${e}/messages/${a}`,{message:t}).catch(d=>(l.val(t),l.attr("data-mid",a),m.updateRemainingLength(l.parent()),o.error(d))):v.post(`/chats/${e}`,{message:t}).catch(d=>(l.val(t),m.updateRemainingLength(l.parent()),d.message==="[[error:email-not-confirmed-chat]]"?g.showEmailConfirmWarning(d.message):o.alert({alert_id:"chat_spam_error",title:"[[global:alert.error]]",message:d.message,type:"danger",timeout:1e4})))},m.updateRemainingLength=function(e){const l=e.find('[component="chat/input"]');e.find('[component="chat/message/length"]').text(l.val().length),e.find('[component="chat/message/remaining"]').text(config.maximumChatMessageLength-l.val().length),i.fire("action:chat.updateRemainingLength",{parent:e})},m.appendChatMessage=function(e,l){const t=parseInt(e.find(".chat-message").last().attr("data-uid"),10),a=parseInt(e.find(".chat-message").last().attr("data-timestamp"),10);Array.isArray(l)||(l.newSet=t!==parseInt(l.fromuid,10)||parseInt(l.timestamp,10)>parseInt(a,10)+1e3*60*3),m.parseMessage(l,function(s){x(e,s)})};function x(e,l){const t=$(l),a=m.isAtBottom(e);t.appendTo(e),t.find(".timeago").timeago(),t.find("img:not(.not-responsive)").addClass("img-responsive"),a&&m.scrollToBottom(e),i.fire("action:chat.received",{messageEl:t})}m.parseMessage=function(e,l){function t(a){r.translate(a,l)}Array.isArray(e)?n.render("partials/chats/message"+(Array.isArray(e)?"s":""),{messages:e}).then(t):n.render("partials/chats/"+(e.system?"system-message":"message"),{messages:e}).then(t)},m.isAtBottom=function(e,l){if(e.length)return e[0].scrollHeight-(e.outerHeight()+e.scrollTop())<(l||100)},m.scrollToBottom=function(e){e&&e.length&&(e.scrollTop(e[0].scrollHeight-e.height()),e.parent().find('[component="chat/messages/scroll-up-alert"]').addClass("hidden"))},m.toggleScrollUpAlert=function(e){const l=m.isAtBottom(e,300);e.parent().find('[component="chat/messages/scroll-up-alert"]').toggleClass("hidden",l)},m.prepEdit=function(e,l,t){socket.emit("modules.chats.getRaw",{mid:l,roomId:t},function(a,s){if(a)return o.error(a);e.val().length===0&&(e.attr("data-mid",l).addClass("editing"),e.val(s).focus(),i.fire("action:chat.prepEdit",{inputEl:e,messageId:l,roomId:t}))})},m.addSocketListeners=function(){socket.removeListener("event:chats.edit",u),socket.on("event:chats.edit",u),socket.removeListener("event:chats.delete",h),socket.on("event:chats.delete",h),socket.removeListener("event:chats.restore",D),socket.on("event:chats.restore",D)};function u(e){e.messages.forEach(function(l){const t=parseInt(l.fromuid,10)===parseInt(app.user.uid,10);l.self=t?1:0,m.parseMessage(l,function(a){const s=c.get("chat/message",l.messageId);s.length&&(s.replaceWith(a),c.get("chat/message",l.messageId).find(".timeago").timeago())})})}function h(e){c.get("chat/message",e).toggleClass("deleted",!0).find('[component="chat/message/body"]').translateHtml("[[modules:chat.message-deleted]]")}function D(e){c.get("chat/message",e.messageId).toggleClass("deleted",!1).find('[component="chat/message/body"]').html(e.content)}return m.delete=function(e,l){r.translate("[[modules:chat.delete_message_confirm]]",function(t){p.confirm(t,function(a){a&&v.delete(`/chats/${l}/messages/${e}`,{}).then(()=>{c.get("chat/message",e).toggleClass("deleted",!0)}).catch(o.error)})})},m.restore=function(e,l){v.post(`/chats/${l}/messages/${e}`,{}).then(()=>{c.get("chat/message",e).toggleClass("deleted",!1)}).catch(o.error)},m}.apply(w,A),y!==void 0&&(I.exports=y)},2585:(I,w,f)=>{I.exports=f(61006)},83713:(I,w,f)=>{I.exports=f(51077)},44882:(I,w,f)=>{"use strict";var A,y;A=[f(31369),f(32230),f(66603),f(7927),f(85233)],y=function(c,r,n,i,p){const o={};let g,v;o.show=function(){p.one("action:ajaxify.end",()=>{x(),m(),o.showEmailConfirmWarning()})},o.showEmailConfirmWarning=function(u){if(!config.emailPrompt||!app.user.uid||parseInt(n.getItem("email-confirm-dismiss"),10)===1)return;const h={alert_id:"email_confirm",type:"warning",timeout:0,closefn:()=>{n.setItem("email-confirm-dismiss",1)}};app.user.email?!app.user["email:confirmed"]&&!app.user.isEmailConfirmSent?(h.message=u||"[[error:email-not-confirmed]]",h.clickfn=function(){i.remove("email_confirm"),ajaxify.go("/me/edit/email")},i.alert(h)):!app.user["email:confirmed"]&&app.user.isEmailConfirmSent&&(h.message="[[error:email-not-confirmed-email-sent]]",i.alert(h)):(h.message="[[error:no-email-to-confirm]]",h.clickfn=function(){i.remove("email_confirm"),ajaxify.go("user/"+app.user.userslug+"/edit/email")},i.alert(h))};function m(){!config.cookies.enabled||!navigator.cookieEnabled||app.inAdmin||n.getItem("cookieconsent")==="1"||(config.cookies.message=r.unescape(config.cookies.message),config.cookies.dismiss=r.unescape(config.cookies.dismiss),config.cookies.link=r.unescape(config.cookies.link),config.cookies.link_url=r.unescape(config.cookies.link_url),app.parseAndTranslate("partials/cookie-consent",config.cookies,function(u){$(document.body).append(u),$(document.body).addClass("cookie-consent-open");const h=$(".cookie-consent");h.find("button").on("click",function(){n.setItem("cookieconsent","1"),h.remove(),$(document.body).removeClass("cookie-consent-open")})}))}function x(){const u=utils.params({full:!0});g=u.has("loggedin"),v=u.get("register"),g&&(i.alert({type:"success",title:"[[global:welcome_back]] "+app.user.username+"!",message:"[[global:you_have_successfully_logged_in]]",timeout:5e3}),u.delete("loggedin")),v&&(c.alert({message:utils.escapeHTML(decodeURIComponent(v))}),u.delete("register")),u.has("lang")&&u.get("lang")===config.defaultLang&&(console.info(`The "lang" parameter was passed in to set the language to "${u.get("lang")}", but that is already the forum default language.`),u.delete("lang"));const h=u.toString();ajaxify.updateHistory(ajaxify.currentPage+(h?`?${h}`:"")+document.location.hash,!0)}return o.showInvalidSession=function(){c.alert({title:"[[error:invalid-session]]",message:"[[error:invalid-session-text]]",closeButton:!1,callback:function(){window.location.reload()}})},o.showSessionMismatch=function(){c.alert({title:"[[error:session-mismatch]]",message:"[[error:session-mismatch-text]]",closeButton:!1,callback:function(){window.location.reload()}})},o}.apply(w,A),y!==void 0&&(I.exports=y)},66603:(I,w,f)=>{"use strict";var A;A=function(){function y(){this._store={},this._keys=[]}y.prototype.isMock=!0,y.prototype.setItem=function(n,i){n=String(n),this._keys.indexOf(n)===-1&&this._keys.push(n),this._store[n]=i},y.prototype.getItem=function(n){return n=String(n),this._keys.indexOf(n)===-1?null:this._store[n]},y.prototype.removeItem=function(n){n=String(n),this._keys=this._keys.filter(function(i){return i!==n}),this._store[n]=null},y.prototype.clear=function(){this._keys=[],this._store={}},y.prototype.key=function(n){return n=parseInt(n,10)||0,this._keys[n]},Object.defineProperty&&Object.defineProperty(y.prototype,"length",{get:function(){return this._keys.length}});let c;const r=Date.now().toString();try{if(c=window.localStorage,c.setItem(r,r),c.getItem(r)!==r)throw Error("localStorage behaved unexpectedly");return c.removeItem(r),c}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(c=window.sessionStorage,c.setItem(r,r),c.getItem(r)!==r)throw Error("sessionStorage behaved unexpectedly");return c.removeItem(r),c}catch(i){return console.warn(i),console.warn("sessionStorage failed, falling back on memory storage"),new y}}}.call(w,f,w,I),A!==void 0&&(I.exports=A)},33371:(I,w,f)=>{"use strict";var A,y;A=[f(7927)],y=function(c){const r={};return r.init=function(n){const i=n.uploadFormEl;i.length&&(i.attr("action",config.relative_path+n.route),n.dragDropAreaEl&&r.handleDragDrop({container:n.dragDropAreaEl,callback:function(p){r.ajaxSubmit({uploadForm:i,upload:p,callback:n.callback})}}),n.pasteEl&&r.handlePaste({container:n.pasteEl,callback:function(p){r.ajaxSubmit({uploadForm:i,upload:p,callback:n.callback})}}))},r.handleDragDrop=function(n){let i=!1;const p=n.container,o=n.container.find(".imagedrop");p.on("dragenter",function(){i||(o.css("top","0px"),o.css("height",p.height()+"px"),o.css("line-height",p.height()+"px"),o.show(),o.on("dragleave",function(){o.hide(),o.off("dragleave")}))}),o.on("drop",function(m){m.preventDefault();const x=m.originalEvent.dataTransfer.files;if(x.length){let h;if(window.FormData){h=new FormData;for(var u=0;u<x.length;++u)h.append("files[]",x[u],x[u].name)}n.callback({files:x,formData:h})}return o.hide(),!1});function g(v){return v.preventDefault(),!1}$(document).off("dragstart").on("dragstart",function(){i=!0}).off("dragend").on("dragend, mouseup",function(){i=!1}),o.on("dragover",g),o.on("dragenter",g)},r.handlePaste=function(n){n.container.on("paste",function(p){const o=(p.clipboardData||p.originalEvent.clipboardData||{}).items,g=[],v=[];let m=null;window.FormData&&(m=new FormData),[].forEach.call(o,function(x){const u=x.getAsFile();if(u){const h=utils.generateUUID()+"-"+u.name;m&&m.append("files[]",u,h),g.push(u),v.push(h)}}),g.length&&n.callback({files:g,fileNames:v,formData:m})})},r.ajaxSubmit=function(n){const i=[...n.upload.files];for(let o=0;o<i.length;++o){const g=i[o].type.match(/image./);if(g&&!app.user.privileges["upload:post:image"]||!g&&!app.user.privileges["upload:post:file"])return c.error("[[error:no-privileges]]");if(i[o].size>parseInt(config.maximumFileSize,10)*1024)return n.uploadForm[0].reset(),c.error("[[error:file-too-big, "+config.maximumFileSize+"]]")}const p=Date.now();n.uploadForm.off("submit").on("submit",function(){return $(this).ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},resetForm:!0,clearForm:!0,formData:n.upload.formData,error:function(o){let g=o.responseJSON&&(o.responseJSON.error||o.responseJSON.status&&o.responseJSON.status.message)||"[[error:parse-error]]";o&&o.status===413&&(g=o.statusText||"Request Entity Too Large"),c.error(g),c.remove(p)},uploadProgress:function(o,g,v,m){c.alert({alert_id:p,message:"[[modules:composer.uploading, "+m+"%]]"})},success:function(o){const g=o.response.images;if(g&&g.length)for(var v=0;v<g.length;++v)g[v].filename=i[v].name,g[v].isImage=/image./.test(i[v].type);n.callback(g)},complete:function(){n.uploadForm[0].reset(),setTimeout(c.remove,100,p)}}),!1}),n.uploadForm.submit()},r}.apply(w,A),y!==void 0&&(I.exports=y)},51077:(I,w,f)=>{"use strict";var A,y;A=[f(85233)],y=function(c){var r={};return r.render=function(n,i){if(i=i||function(){},!n.find(".preview-container").is(":visible"))return i();var p=n.find("textarea");socket.emit("plugins.composer.renderPreview",p.val(),function(o,g){o||(g=$("<div>"+g+"</div>"),g.find("img:not(.not-responsive)").addClass("img-responsive"),n.find(".preview").html(g),c.fire("action:composer.preview"),i())})},r.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var i=n.find("textarea"),p=n.find(".preview");if(i.length&&p.length){var o=i[0].scrollHeight-i.height();if(o===0)return;var g=i.scrollTop()/o;p.scrollTop(Math.max(p[0].scrollHeight-p.height(),0)*g)}}},r.handleToggler=function(n){r.env=utils.findBootstrapEnvironment();var i=n.find(".write-container .toggle-preview"),p=n.find(".preview-container .toggle-preview"),o=$(".preview-container"),g=$(".write-container");function v(){x(!1),r.env!=="xs"&&r.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function m(){x(!0),r.env!=="xs"&&r.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function x(u){r.env==="xs"||r.env==="sm"?(o.toggleClass("hide",!1),g.toggleClass("maximized",!1),i.toggleClass("hide",!0),o.toggleClass("hidden-xs hidden-sm",!u),g.toggleClass("hidden-xs hidden-sm",u),u&&r.render(n)):(o.toggleClass("hide",!u),g.toggleClass("maximized",!u),i.toggleClass("hide",u)),r.matchScroll(n)}r.toggle=x,p.on("click",function(){v(),n.find(".write").focus()}),i.on("click",function(){m(),n.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||r.env==="xs"||r.env==="sm"?v():m()},r}.apply(w,A),y!==void 0&&(I.exports=y)}}]);

(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5400,7986,2735,2160],{99398:(p,C,f)=>{p.exports=f(18196)},83713:(p,C,f)=>{p.exports=f(51077)},6721:(p,C,f)=>{p.exports=f(70968)},75203:(p,C,f)=>{"use strict";var _;_=function(){const h={};return h.apply=function(j){$(j).on("mousewheel",function(e){const t=this.scrollTop,i=this.scrollHeight,n=Math.round(this.getBoundingClientRect().height);if(e.originalEvent.deltaY<0&&t===0||e.originalEvent.deltaY>0&&n+t>=i)return!1})},h}.call(C,f,C,p),_!==void 0&&(p.exports=_)},18196:(p,C,f)=>{"use strict";var _,h;_=[f(83713)],h=function(j){var e={};return e.insertIntoTextarea=function(t,i){var n={context:this,textarea:t,value:i,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",n),!n.preventDefault){var o=$(n.textarea),r=o.val(),m=o.parents('[component="composer"]');o.val(r.slice(0,n.textarea.selectionStart)+n.value+r.slice(n.textarea.selectionStart)),j.render(m)}},e.wrapSelectionInTextareaWith=function(t,i,n){var o={context:this,textarea:t,leading:i,trailing:n,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",o),!o.preventDefault){n===void 0&&(n=i);var r=$(t),m=r.val(),d=/^(\s*)([\s\S]*?)(\s*)$/.exec(m.slice(t.selectionStart,t.selectionEnd));return d[2]||(d=[null,"",m.slice(t.selectionStart,t.selectionEnd),""]),r.val(m.slice(0,t.selectionStart)+d[1]+i+d[2]+n+d[3]+m.slice(t.selectionEnd)),[d[1].length,d[3].length]}},e.updateTextareaSelection=function(t,i,n){var o={context:this,textarea:t,start:i,end:n,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",o),!o.preventDefault&&(t.setSelectionRange(o.start,o.end),$(o.textarea).focus())},e.getBlockData=function(t,i,n){var o=t.value;i=i.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var r=new RegExp(i,"g"),m,d=[],E;for(o=o.split(`
`).reduce(function(s,x){return s!==null||(s=n<=x.length?x:null,s===null&&(n-=x.length+1)),s},null);(m=r.exec(o))!==null;)d.push(m.index);return E={in:!!(d.reduce(function(s,x){return n>=x+2&&(s+=1),s},0)%2),atEnd:d.reduce(function(s,x){return s||n===x},!1)},E.atEnd=E.in?E.atEnd:!1,E},e}.apply(C,_),h!==void 0&&(p.exports=h)},51077:(p,C,f)=>{"use strict";var _,h;_=[f(85233)],h=function(j){var e={};return e.render=function(t,i){if(i=i||function(){},!t.find(".preview-container").is(":visible"))return i();var n=t.find("textarea");socket.emit("plugins.composer.renderPreview",n.val(),function(o,r){o||(r=$("<div>"+r+"</div>"),r.find("img:not(.not-responsive)").addClass("img-responsive"),t.find(".preview").html(r),j.fire("action:composer.preview"),i())})},e.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var i=t.find("textarea"),n=t.find(".preview");if(i.length&&n.length){var o=i[0].scrollHeight-i.height();if(o===0)return;var r=i.scrollTop()/o;n.scrollTop(Math.max(n[0].scrollHeight-n.height(),0)*r)}}},e.handleToggler=function(t){e.env=utils.findBootstrapEnvironment();var i=t.find(".write-container .toggle-preview"),n=t.find(".preview-container .toggle-preview"),o=$(".preview-container"),r=$(".write-container");function m(){E(!1),e.env!=="xs"&&e.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function d(){E(!0),e.env!=="xs"&&e.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function E(s){e.env==="xs"||e.env==="sm"?(o.toggleClass("hide",!1),r.toggleClass("maximized",!1),i.toggleClass("hide",!0),o.toggleClass("hidden-xs hidden-sm",!s),r.toggleClass("hidden-xs hidden-sm",s),s&&e.render(t)):(o.toggleClass("hide",!s),r.toggleClass("maximized",!s),i.toggleClass("hide",s)),e.matchScroll(t)}e.toggle=E,n.on("click",function(){m(),t.find(".write").focus()}),i.on("click",function(){d(),t.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||e.env==="xs"||e.env==="sm"?m():d()},e}.apply(C,_),h!==void 0&&(p.exports=h)},70968:(p,C,f)=>{var _,h;_=[f,C,f(32230),f(59006),f(99398),f(75203),f(40646)],h=function(j,e,t,i,n,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toggleForInsert=e.toggle=e.init=e.dialogActions=void 0;var m=$("html");e.dialogActions={open:function(l){return m.addClass("emoji-insert"),l.addClass("open"),l.appendTo(document.fullscreenElement||"body"),l.find(".emoji-dialog-search").focus(),setTimeout(function(){$(document).off("click",d).on("click",d)},0),l},close:function(l){return $(document).off("click",d),m.removeClass("emoji-insert"),l.removeClass("open")}};function d(l){var u=$("#emoji-dialog");!$(l.target).is(".emoji-dialog *")&&u.length&&e.dialogActions.close(u)}var E={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(E.custom=100);var s=t.Translator.create();function x(l,u){return l<u?-1:l>u?1:0}function k(l){Promise.all([$.getJSON(r.base+"/emoji/categories.json?"+r.buster),$.getJSON(r.base+"/emoji/packs.json?"+r.buster),new Promise(function(u){return r.init(u)})]).then(function(u){var c=u[0],A=u[1],v=Object.keys(c).map(function(b){var w=c[b].map(function(a){return r.table[a]});return{name:b,emojis:w.map(function(a){return{name:a.name,html:r.buildEmoji(a,!0)}}).sort(function(a,g){return x(a.name,g.name)})}}).sort(function(b,w){var a=E[b.name]||0,g=E[w.name]||0;return g-a});return i.render("partials/emoji-dialog",{categories:v,packs:A})}).then(function(u){return s.translate(u)}).then(function(u){var c=$(u).appendTo(document.fullscreenElement||"body");c.find(".emoji-dialog-search").on("input",function(a){var g=a.target.value;if(!g){c.find(".emoji-dialog-search-results").addClass("hidden"),c.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");return}var D=r.search(g).slice(0,100).map(function(T){return'<a class="emoji-link" name="'+T.name+'" href="#">'+r.buildEmoji(T,!1)+"</a>"}).join(`
`);c.find(".tab-pane.emoji-dialog-search-results").html(D),c.find(".emoji-dialog-search-results").removeClass("hidden"),c.find(".nav-tabs .emoji-dialog-search-results a").tab("show")});var A=c.find(".emoji-tabs .tab-content");function v(a){var g=A[0].getBoundingClientRect(),D=Math.ceil(g.width*g.height/(40*40));a.find(".emoji-link img.defer").filter(function(T,S){if(T<=D)return!0;var I=S.getBoundingClientRect();return I.right>g.left&&I.left<g.right&&I.bottom>g.top&&I.top<g.bottom}).removeClass("defer").each(function(T,S){var I=S.getAttribute("data-src");S.setAttribute("src",I)})}var b=c.find(".emoji-tabs .nav-tabs a").click(function(a){a.preventDefault(),$(a.target).tab("show")}).on("show.bs.tab",function(a){v($(a.target.getAttribute("href")))}).eq(1);setTimeout(function(){return b.trigger("show.bs.tab")},10),A.on("scroll",function(){v(A.find(".tab-pane.active"))}),o.apply(A[0]);var w=function(){return e.dialogActions.close(c)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),w),c.find(".close").on("click",w),c.draggable&&c.draggable({handle:".top-bar"}),l(c)}).catch(function(u){console.error("Failed to initialize emoji dialog",u)})}e.init=k;function R(l,u){function c(v){if(v.hasClass("open")){e.dialogActions.close(v);return}v.off("click").on("click",".emoji-link",function(a){a.preventDefault();var g=a.currentTarget.name;u(a,g,v)});var b=l?l.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},w={bottom:"auto",top:"auto",right:"auto",left:"auto"};b.top>440?w.top=b.top-400+"px":w.top=b.top+40+"px",b.left<window.innerWidth/2?w.left=b.left+40+"px":w.left=b.left-400+"px",v.css(w),e.dialogActions.open(v)}var A=$("#emoji-dialog");A.length?c(A):k(c)}e.toggle=R;function P(l,u,c,A){var v;A&&A.target?v=$(A.target):v=$(l).parents(".composer-container").find('[data-format="emoji-add-emoji"]'),v=v[0],R(v,function(b,w){var a=":"+w+": ",g=l.selectionStart,D=l.selectionEnd,T=D+a.length,S=g===D?T:g;n.insertIntoTextarea(l,a),n.updateTextareaSelection(l,S,T),$(l).trigger("input")})}e.toggleForInsert=P}.apply(C,_),h!==void 0&&(p.exports=h)}}]);

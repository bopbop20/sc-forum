"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4507,7214,6503,6027,71,5655,7927],{6500:(C,S,f)=>{var y,l;y=[f(18340),f(7927),f(85233)],l=function(c,d,r){const m={};m.init=function(){c.load("core.api",$(".core-api-settings")),$("#save").on("click",A),r.on("action:settings.sorted-list.itemLoaded",({element:a})=>{a.addEventListener("click",u=>{u.target.closest("input[readonly]")&&(u.target.selectionStart=0,u.target.selectionEnd=u.target.value.length)})})};function A(){c.save("core.api",$(".core-api-settings"),function(){d.alert({type:"success",alert_id:"core.api-saved",title:"Settings Saved",timeout:5e3}),ajaxify.refresh()})}return m}.apply(S,y),l!==void 0&&(C.exports=l)},7927:(C,S,f)=>{var y,l;y=[f(32230),f(7237),f(85233)],l=function(c,d,r){const m={};m.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:new Date().getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const e=$("#"+t.alert_id);e.length?a(e,t):A(t)},m.success=function(t,e){m.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:e||5e3})},m.error=function(t,e){if(t=t&&t.message||t,t==="[[error:revalidate-failure]]"){socket.disconnect(),app.reconnect();return}m.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:e||1e4})},m.remove=function(t){$("#alert_button_"+t).remove()};function A(t){app.parseAndTranslate("alert",t,function(e){let i=$("#"+t.alert_id);if(i.length)return a(i,t);i=e,i.fadeIn(200),d.get("toaster/tray").prepend(i),typeof t.closefn=="function"&&i.find("button").on("click",function(){return t.closefn(),u(i),!1}),t.timeout&&n(i,t),typeof t.clickfn=="function"&&i.addClass("pointer").on("click",function(s){$(s.target).is(".close")||t.clickfn(i,t),u(i)}),r.fire("action:alert.new",{alert:i,params:t})})}function a(t,e){t.find("strong").translateHtml(e.title),t.find("p").translateHtml(e.message),t.attr("class","alert alert-dismissable alert-"+e.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),e.timeout&&n(t,e),r.fire("action:alert.update",{alert:t,params:e}),t.off("click").removeClass("pointer"),typeof e.clickfn=="function"&&t.addClass("pointer").on("click",function(i){$(i.target).is(".close")||e.clickfn(),u(t)})}function u(t){t.fadeOut(500,function(){$(this).remove()})}function n(t,e){const i=e.timeout,s=setTimeout(function(){u(t),typeof e.timeoutfn=="function"&&e.timeoutfn(t,e)},i);t.attr("timeoutId",s),t.css("transition-property","none"),t.removeClass("animate"),setTimeout(function(){t.css("transition-property",""),t.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),t.addClass("animate"),r.fire("action:alert.animate",{alert:t,params:e})},50),t.on("mouseenter",function(){$(this).css("transition-duration",0)})}return m}.apply(S,y),l!==void 0&&(C.exports=l)},7237:(C,S,f)=>{var y;y=function(){const l={};return l.core={"topic/teaser":function(c){return c?$('[component="category/topic"][data-tid="'+c+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(c,d){return $('[component="topic"][data-'+c+'="'+d+'"]')},post:function(c,d){return $('[component="post"][data-'+c+'="'+d+'"]')},"post/content":function(c){return $('[component="post"][data-pid="'+c+'"] [component="post/content"]')},"post/header":function(c){return $('[component="post"][data-pid="'+c+'"] [component="post/header"]')},"post/anchor":function(c){return $('[component="post"][data-index="'+c+'"] [component="post/anchor"]')},"post/vote-count":function(c){return $('[component="post"][data-pid="'+c+'"] [component="post/vote-count"]')},"post/bookmark-count":function(c){return $('[component="post"][data-pid="'+c+'"] [component="post/bookmark-count"]')},"user/postcount":function(c){return $('[component="user/postcount"][data-uid="'+c+'"]')},"user/reputation":function(c){return $('[component="user/reputation"][data-uid="'+c+'"]')},"category/topic":function(c,d){return $('[component="category/topic"][data-'+c+'="'+d+'"]')},"categories/category":function(c,d){return $('[component="categories/category"][data-'+c+'="'+d+'"]')},"chat/message":function(c){return $('[component="chat/message"][data-mid="'+c+'"]')},"chat/message/body":function(c){return $('[component="chat/message"][data-mid="'+c+'"] [component="chat/message/body"]')},"chat/recent/room":function(c){return $('[component="chat/recent/room"][data-roomid="'+c+'"]')}},l.get=function(){const c=Array.prototype.slice.call(arguments,1);return l.core[arguments[0]]&&c.length?l.core[arguments[0]].apply(this,c):$('[component="'+arguments[0]+'"]')},l}.call(S,f,S,C),y!==void 0&&(C.exports=y)},18340:(C,S,f)=>{var y,l;y=[f(85233),f(7927)],l=function(c,d){let r,m=[],A=0,a;function u(n,t){typeof n!="string"&&(n=$(n),n=n.data("type")||n.attr("type")||n.prop("tagName"));const e=r.plugins[n.toLowerCase()];if(e==null)return;const i=e[t];return typeof i=="function"?i:null}return a={deepClone:function(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n},createElement:function(n,t,e){const i=document.createElement(n);for(const s in t)t.hasOwnProperty(s)&&i.setAttribute(s,t[s]);return e&&i.appendChild(document.createTextNode(e)),i},initElement:function(n){const t=u(n,"init");t?.call(r,$(n))},destructElement:function(n){const t=u(n,"destruct");t?.call(r,$(n))},createElementOfType:function(n,t,e){let i;const s=u(n,"create");return s!=null?i=$(s.call(r,n,t,e)):(e==null&&(e={}),n!=null&&(e.type=n),i=$(a.createElement(t||"input",e))),i.data("type",n),a.initElement(i),i},cleanArray:function(n,t,e){const i=[];if(!t&&e)return n;for(let s=0;s<n.length;s+=1){let o=n[s];t&&(o===!!o?o=+o:o&&typeof o.trim=="function"&&(o=o.trim())),(e||o!=null&&o.length)&&i.push(o)}return i},isTrue:function(n){return n==="true"||+n==1},isFalse:function(n){return n==="false"||+n==0},readValue:function(n){let t=!a.isFalse(n.data("empty"));const e=!a.isFalse(n.data("trim")),i=n.data("split"),s=u(n,"get");let o;if(s!=null)return s.call(r,n,e,t);if(i!=null){t=a.isTrue(n.data("empty")),o=n.val();const h=o!=null&&o.split(i||",")||[];return a.cleanArray(h,e,t)}if(o=n.val(),e&&o!=null&&typeof o.trim=="function"&&(o=o.trim()),t||o!==void 0&&(o==null||o.length!==0))return o},fillField:function(n,t){const e=u(n,"set");let i=n.data("trim");if(i=i!=="false"&&+i!=0,e!=null)return e.call(r,n,t,i);t instanceof Array&&(t=t.join(n.data("split")||(i?", ":","))),i&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),i&&(t=t.trim())):t="",t!==void 0&&n.val(t)},initFields:function(n){$("[data-key]",n).each(function(t,e){e=$(e);const i=u(e,"init"),s=e.data("key").split(".");let o=r.get();i?.call(r,e);for(let h=0;h<s.length;h+=1){const g=s[h];g&&o!=null&&(o=o[g])}a.fillField(e,o)})},registerReadyJobs:function(n){return A+=n,A},beforeReadyJobsDecreased:function(n){if(n==null&&(n=1),A>0&&(A-=n,A<=0)){for(let t=0;t<m.length;t+=1)m[t]();m=[]}},whenReady:function(n){A<=0?n():m.push(n)},serializeForm:function(n){const t=n.serializeObject();return n.find('input[type="checkbox"]').each(function(e,i){i=$(i),i.is(":checked")||(t[i.attr("name")]="off")}),n.find("select[multiple]").each(function(e,i){i=$(i),t[i.attr("name")]=JSON.stringify(i.val())}),t},persistSettings:function(n,t,e,i){t!=null&&t._!=null&&typeof t._!="string"&&(t=a.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:n,values:t},function(s){e&&(s?d.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${s.message}]]`,timeout:5e3}):d.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof i=="function"&&i(s)})},use:function(n){try{n._=JSON.parse(n._)}catch{}r.cfg=n}},r={helper:a,plugins:{},cfg:{},get:function(){return r.cfg!=null&&r.cfg._!==void 0?r.cfg._:r.cfg},registerPlugin:function(n,t){t==null?t=n.types:n.types=t,typeof n.use=="function"&&n.use.call(r);for(let e=0;e<t.length;e+=1){const i=t[e].toLowerCase();r.plugins[i]==null&&(r.plugins[i]=n)}},set:function(n,t,e,i,s){s==null&&(s=!0),a.whenReady(function(){a.use(t),a.initFields(e||"form"),a.persistSettings(n,t,s,i)})},sync:function(n,t,e){socket.emit("admin.settings.get",{hash:n},function(i,s){i?typeof e=="function"&&e(i):a.whenReady(function(){a.use(s),a.initFields(t||"form"),typeof e=="function"&&e()})})},persist:function(n,t,e,i){const s=[],o=$("[data-key]",t||"form").toArray();i==null&&(i=!0);for(let h=0;h<o.length;h+=1){const g=$(o[h]),R=a.readValue(g);let p=r.get();const v=g.data("key").split("."),k=v[v.length-1];if(v.length>1)for(let E=0;E<v.length-1;E+=1){const D=v[E];D&&p!=null&&(p=p[D])}p!=null?R!=null?p[k]=R:delete p[k]:s.push(g.data("key"))}s.length&&d.alert({title:"Attributes Not Saved",message:"'"+s.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),a.persistSettings(n,r.cfg,i,e)},load:function(n,t,e){e=e||function(){};const i=t.attr("data-socket-get");socket.emit(i||"admin.settings.get",{hash:n},function(s,o){if(s)return e(s);$(t).find("select[multiple]").each(function(g,R){const p=$(R).attr("name");if(p&&o.hasOwnProperty(p))try{o[p]=JSON.parse(o[p])}catch{}}),ajaxify.data[i?n:"settings"]=o,a.whenReady(function(){$(t).find("[data-sorted-list]").each(function(g,R){u(R,"get").call(r,$(R),n)})}),$(t).deserialize(o),$(t).find('input[type="checkbox"]').each(function(){$(this).parents(".mdl-switch").toggleClass("is-checked",$(this).is(":checked"))}),c.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const h=document.getElementById("save");h&&f.e(2441).then(function(){var g=[f(42441)];(function(R){R.bind("ctrl+s",function(p){h.click(),p.preventDefault()})}).apply(null,g)}).catch(f.oe),e(null,o)})},save:function(n,t,e){t=$(t);const i=t.get(0).elements;if(r.check(i)&&t.length){const o=a.serializeForm(t);a.whenReady(function(){const g=t.find("[data-sorted-list]");g.length&&g.each((R,p)=>{u(p,"set").call(r,$(p),o)})});const h=t.attr("data-socket-set");socket.emit(h||"admin.settings.set",{hash:n,values:o},function(g){app.flags._unsaved=!1,ajaxify.data[h?n:"settings"]=o,typeof e=="function"?e(g):g?d.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${g.message}]]`,type:"error",timeout:2500}):d.alert({title:"[[admin/admin:changes-saved]]",type:"success",timeout:2500})})}},check:function(n){const t=e=>{const i=e.target.closest(".form-group");i&&i.classList.add("has-error"),e.target.removeEventListener("invalid",t)};return Array.prototype.map.call(n,e=>{const i=e.closest(".form-group");return i&&i.classList.remove("has-error"),e.addEventListener("invalid",t),e.reportValidity()}).every(Boolean)}},a.registerReadyJobs(1),Promise.all([f.e(6177),f.e(2526),f.e(6069)]).then(function(){var n=[f(16631),f(73143),f(7448),f(15101),f(846),f(88839),f(53411),f(66370)];(function(){for(let t=0;t<arguments.length;t+=1)r.registerPlugin(arguments[t]);a.beforeReadyJobsDecreased()}).apply(null,n)}).catch(f.oe),r}.apply(S,y),l!==void 0&&(C.exports=l)}}]);

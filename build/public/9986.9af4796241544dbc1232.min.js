(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9986,2344],{78989:(Y,K,I)=>{"use strict";var B,A;B=[I(31369)],A=function(C){const d={};return d.init=function(){$("body").on("click",'[component="pagination/select-page"]',function(){return C.prompt("[[global:enter_page_number]]",function(h){d.loadPage(h)}),!1})},d.loadPage=function(h,b){if(b=b||function(){},h=parseInt(h,10),!utils.isNumber(h)||h<1||h>ajaxify.data.pagination.pageCount)return;const n=utils.params();n.page=h;const a=window.location.pathname+"?"+$.param(n);ajaxify.go(a,b)},d.nextPage=function(h){d.loadPage(ajaxify.data.pagination.currentPage+1,h)},d.previousPage=function(h){d.loadPage(ajaxify.data.pagination.currentPage-1,h)},d}.apply(K,B),A!==void 0&&(Y.exports=A)},42840:(Y,K,I)=>{"use strict";var B,A;B=[I(78989),I(7237),I(85233),I(7927)],A=function(C,d,h,b){const n={};let a=0,f=0,v,_,P,M,c,p=!1,u=!0;n.scrollActive=!1;let s=$(".pagination-block"),W=s.find(".pagination-text"),V=s.find("meter"),X=s.find(".progress-bar"),g,N,z,F,J;$(window).on("action:ajaxify.start",function(){$(window).off("keydown",j)}),n.init=function(t,e,r,m,y){a=0,n.selector=t,n.callback=y,n.toTop=r||function(){},n.toBottom=m||function(){},s=$(".pagination-block"),W=s.find(".pagination-text"),V=s.find("meter"),X=s.find(".progress-bar"),z=$(".scroller-thumb-icon"),F=z.height(),J=F/2,g=$(".scroller-thumb"),N=g.find(".thumb-text"),$(window).off("scroll",n.delayedUpdate).on("scroll",n.delayedUpdate),s.find(".dropdown-menu").off("click").on("click",function(T){T.stopPropagation()}),s.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",function(){setTimeout(async function(){utils.findBootstrapEnvironment()==="lg"&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&s.find("#myNextPostBtn").removeAttr("disabled")},100)}),s.find(".pageup").off("click").on("click",n.scrollUp),s.find(".pagedown").off("click").on("click",n.scrollDown),s.find(".pagetop").off("click").on("click",n.toTop),s.find(".pagebottom").off("click").on("click",n.toBottom),s.find("#myNextPostBtn").off("click").on("click",i),s.find("input").on("keydown",function(T){if(T.which===13){const l=$(this);if(!utils.isNumber(l.val())){l.val("");return}const x=parseInt(l.val(),10),E=D(x);l.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(E)}}),ajaxify.data.template.topic&&Q(),H(),n.setCount(e),n.update(0)};let o=0;async function i(){async function t(e){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,e),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let e=await t(a);o===e&&(e=await t(e)),e&&a!==e+1?(o=e,$(window).one("action:ajaxify.end",function(){s.find(".dropdown-menu").is(":hidden")&&s.find(".dropdown-toggle").dropdown("toggle")}),n.scrollToIndex(e,!0,0)):(b.alert({message:"[[topic:no-more-next-post]]",type:"info"}),o=1)}}function w(t){const e=g.parent(),r=e.offset();return t<r.top?t=r.top:t>r.top+e.height()-F&&(t=r.top+e.height()-F),t}function R(t){if(!g.length||g.is(":hidden"))return;const e=g.parent(),r=e.offset();let m=(t-1)/ajaxify.data.postcount;t===f&&(m=1);const T={top:w(r.top+(e.height()-F)*m),left:g.offset().left};g.offset(T),N.text(t+"/"+ajaxify.data.postcount),S(t)}function Q(){if(!g.length)return;const t=g.parent();t.on("click",function(l){if($(l.target).hasClass("scroller-container")){const x=e(l.pageY);return n.scrollToIndex(x-1,!0,0),!1}});function e(l){const x=w(l-J),E=t.offset(),G=(x-E.top)/(t.height()-F);return a=Math.max(1,Math.ceil(ajaxify.data.postcount*G)),a>ajaxify.data.postcount?ajaxify.data.count:a}let r=!1;h.on("action:ajaxify.end",function(){c=null}),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",function(){R(a)}),g.on("mousedown",function(){r=!0,$(window).on("mousemove",y),u=!0});function m(){$(window).off("mousemove",y),r&&(n.scrollToIndex(a-1,!0,0),s.find('[data-toggle="dropdown"]').trigger("click")),Z(),r=!1,u=!1}function y(l){const x=w(l.pageY-J);g.offset({top:x,left:g.offset().left});const E=e(l.pageY);return n.updateTextAndProgressBar(),N.text(E+"/"+ajaxify.data.postcount),u&&T(),u=!1,l.stopPropagation(),!1}function T(){Z(),_=setInterval(function(){S(a)},250)}$(window).off("mousemove",y),$(window).off("mouseup",m).on("mouseup",m),g.on("touchstart",function(l){p=!0,P=Math.min($(window).width(),Math.max(0,l.touches[0].clientX)),M=Math.min($(window).height(),Math.max(0,l.touches[0].clientY)),u=!0}),g.on("touchmove",function(l){const x=$(window).width(),E=$(window).height(),G=Math.abs(P-Math.min(x,Math.max(0,l.touches[0].clientX))),U=Math.abs(M-Math.min(E,Math.max(0,l.touches[0].clientY)));if(P=Math.min(x,Math.max(0,l.touches[0].clientX)),M=Math.min(E,Math.max(0,l.touches[0].clientY)),U>=G&&u&&(p=!0,T()),p&&l.cancelable){l.preventDefault(),l.stopPropagation();const L=w(M+$(window).scrollTop()-J);g.offset({top:L,left:g.offset().left});const O=e(M+$(window).scrollTop());n.updateTextAndProgressBar(),N.text(O+"/"+ajaxify.data.postcount),u&&S(O)}u=!1}),g.on("touchend",function(){Z(),p&&(n.scrollToIndex(a-1,!0,0),p=!1,s.find('[data-toggle="dropdown"]').trigger("click"))})}function Z(){_&&(clearInterval(_),_=0)}function S(t,e){e=e||function(){},!(c===t||s.find(".post-content").is(":hidden"))&&(c=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},function(r,m){if(r)return b.error(r);app.parseAndTranslate("partials/topic/navigation-post",{post:m},function(y){s.find(".post-content").html(y).find(".timeago").timeago()}),e()}))}function H(){config.usePagination||$(window).off("keydown",j).on("keydown",j)}function j(t){if(t.target.nodeName==="BODY"){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(t.which===36&&n.toTop)return n.toTop(),!1;if(t.which===35&&n.toBottom)return n.toBottom(),!1}}function D(t){const r=window.location.pathname.replace(config.relative_path,"").split("/");return r[1]+"/"+r[2]+"/"+r[3]+(t?"/"+t:"")}n.getCount=()=>f,n.setCount=function(t){t=parseInt(t,10),t!==f&&(f=t,n.updateTextAndProgressBar())},n.show=function(){k(!0)},n.disable=function(){f=0,a=1,n.callback=null,n.selector=null,$(window).off("scroll",n.delayedUpdate),k(!1)};function k(t){const e=ajaxify.removeRelativePath(window.location.pathname.slice(1));t&&!e.startsWith("topic")&&!e.startsWith("category")||s.toggleClass("ready",t)}return n.delayedUpdate=function(){v||(v=setTimeout(function(){n.update(),v=void 0},100))},n.update=function(t){t=typeof t=="number"?t:void 0;let e=a;const r=$(n.selector);r.length&&(e=parseInt(r.first().attr("data-index"),10)+1);const m=$(window).scrollTop(),y=$(window).height(),T=$(document).height(),l=m+y/2;let x=Number.MAX_VALUE;r.each(function(){const U=$(this),L=parseInt(U.attr("data-index"),10);if(L>=0){const O=Math.abs(l-(U.offset().top+U.outerHeight(!0)/2));if(O>x)return!1;O<x&&(e=L+1,x=O)}});const E=m===0&&parseInt(r.first().attr("data-index"),10)===0,G=m+y>T-100&&parseInt(r.last().attr("data-index"),10)===f-1;if(E?e=1:G&&(e=f),t===void 0&&ajaxify.data.template.topic)if(E)t=0;else{const U=d.get("post/anchor",a-1);U.length&&(t=U.get(0).getBoundingClientRect().top)}typeof n.callback=="function"&&n.callback(e,f,t),e!==a&&(a=e,n.updateTextAndProgressBar(),R(a)),k(!!f)},n.getIndex=()=>a,n.setIndex=t=>{a=t+1,n.updateTextAndProgressBar(),R(a)},n.updateTextAndProgressBar=function(){if(!utils.isNumber(a))return;a=a>f?f:a,W.translateHtml("[[global:pagination.out_of, "+a+", "+f+"]]");const t=(a-1)/(f-1||1);V.val(t),X.width(t*100+"%")},n.scrollUp=function(){const t=$(window);if(config.usePagination&&t.scrollTop()<=0)return C.previousPage(function(){$("body,html").scrollTop($(document).height()-t.height())});$("body,html").animate({scrollTop:t.scrollTop()-t.height()})},n.scrollDown=function(){const t=$(window);if(config.usePagination&&t.scrollTop()>=$(document).height()-t.height())return C.nextPage();$("body,html").animate({scrollTop:t.scrollTop()+t.height()})},n.scrollTop=function(t){$(n.selector+'[data-index="'+t+'"]').length?n.scrollToIndex(t,!0):ajaxify.go(D())},n.scrollBottom=function(t){parseInt(t,10)<0||($(n.selector+'[data-index="'+t+'"]').length?n.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(D(t))))},n.scrollToIndex=function(t,e,r){const m=!!d.get("topic").length,y=!!d.get("category").length;if(!utils.isNumber(t)||!m&&!y)return;if(r=r!==void 0?r:400,n.scrollActive=!0,m&&d.get("post/anchor",t).length)return n.scrollToPostIndex(t,e,r);if(y&&$('[component="category/topic"][data-index="'+t+'"]').length)return n.scrollToTopicIndex(t,e,r);if(!config.usePagination){n.scrollActive=!1,t=parseInt(t,10)+1,ajaxify.go(D(t));return}const T=m?n.scrollToPostIndex:n.scrollToTopicIndex,l=1+Math.floor(t/config.postsPerPage);parseInt(l,10)!==ajaxify.data.pagination.currentPage?C.loadPage(l,function(){T(t,e,r)}):T(t,e,r)},n.scrollToPostIndex=function(t,e,r){const m=d.get("post","index",t);n.scrollToElement(m,e,r,t)},n.scrollToTopicIndex=function(t,e,r){const m=$('[component="category/topic"][data-index="'+t+'"]');n.scrollToElement(m,e,r,t)},n.scrollToElement=async(t,e,r,m=null)=>{if(!t.length){n.scrollActive=!1;return}await h.fire("filter:navigator.scroll",{scrollTo:t,highlight:e,duration:r,newIndex:m});const y=t.outerHeight(!0),T=d.get("navbar").outerHeight(!0)||0,l=$(".topic-header").outerHeight(!0)||0,x=$(window).height();$(window).off("scroll",n.delayedUpdate),r=r!==void 0?r:400,n.scrollActive=!0;let E=!1;function G(){function L(){setTimeout(()=>{$(window).on("scroll",n.delayedUpdate),h.fire("action:navigator.scrolled",{scrollTo:t,highlight:e,duration:r,newIndex:m})},50)}function O(){if(E){L();return}E=!0,n.scrollActive=!1,U();const tt=t.get(0).getBoundingClientRect();m?n.setIndex(m):n.update(tt.top)}let q=0;if(y<x-T-l?q=t.offset().top-x/2+y/2:q=t.offset().top-T-l,r===0){$(window).scrollTop(q),O(),L();return}$("html, body").animate({scrollTop:q+"px"},r,O)}function U(){e&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout(function(){t.removeClass("highlight")},1e4))}G()},n}.apply(K,B),A!==void 0&&(Y.exports=A)},69986:(Y,K,I)=>{"use strict";var B,A;B=[I(32230),I(7237),I(42840),I(16943),I(85233),I(7927)],A=function(C,d,h,b,n,a){const f={};let v={};const _=({notifications:c})=>new Promise(p=>{C.toggleTimeagoShorthand(function(){for(let u=0;u<c.length;u+=1)c[u].timeago=$.timeago(new Date(parseInt(c[u].datetime,10)));C.toggleTimeagoShorthand(),p({notifications:c})})});n.on("filter:notifications.load",_),f.loadNotifications=function(c,p){p=p||function(){},socket.emit("notifications.get",null,function(u,s){if(u)return a.error(u);const W=s.unread.concat(s.read).sort(function(V,X){return parseInt(V.datetime,10)>parseInt(X.datetime,10)?-1:1});n.fire("filter:notifications.load",{notifications:W}).then(({notifications:V})=>{app.parseAndTranslate("partials/notifications_list",{notifications:V},function(X){c.html(X),c.off("click").on("click","[data-nid]",function(g){const N=$(this);if(M(N)&&(g.stopPropagation(),g.preventDefault(),d.get("notifications/list").dropdown("toggle")),!N.hasClass("unread"))return;const F=N.attr("data-nid");P(F,!0)}),d.get("notifications").on("click",".mark-all-read",f.markAllRead),c.on("click",".mark-read",function(){const g=$(this).parents("li"),N=g.hasClass("unread"),z=g.attr("data-nid");return P(z,N,function(){g.toggleClass("unread")}),!1}),n.fire("action:notifications.loaded",{notifications:W,list:c}),p()})})})},f.onNewNotification=function(c){ajaxify.currentPage==="notifications"&&ajaxify.refresh(),socket.emit("notifications.getCount",function(p,u){if(p)return a.error(p);f.updateNotifCount(u)}),v[c.nid]||(v[c.nid]=!0)};function P(c,p,u){socket.emit("notifications.mark"+(p?"Read":"Unread"),c,function(s){if(s)return a.error(s);p&&v[c]&&delete v[c],u&&u()})}function M(c){const p=c.attr("data-pid"),u=c.attr("data-path"),s=d.get("post","pid",p);return u.startsWith(config.relative_path+"/post/")&&p&&s.length&&ajaxify.data.template.topic?(h.scrollToIndex(s.attr("data-index"),!0),!0):!1}return f.updateNotifCount=function(c){const p=d.get("notifications/icon");c=Math.max(0,c),c>0?p.removeClass("fa-bell-o").addClass("fa-bell"):p.removeClass("fa-bell").addClass("fa-bell-o"),p.toggleClass("unread-count",c>0),p.attr("data-content",c>99?"99+":c);const u={count:c,updateFavicon:!0};n.fire("action:notification.updateCount",u),u.updateFavicon&&b.setBubble(c>99?"99+":c),h.setAppBadge&&h.setAppBadge(c)},f.markAllRead=function(){socket.emit("notifications.markAllRead",function(c){c&&a.error(c),v={}})},f}.apply(K,B),A!==void 0&&(Y.exports=A)},16943:(Y,K,I)=>{var B,A;/*!
* Tinycon - A small library for manipulating the Favicon
* Tom Moor, http://tommoor.com
* Copyright (c) 2015 Tom Moor
* @license MIT Licensed
*/(function(){var C={},d=null,h=null,b=null,n=null,a={},f=Math.ceil(window.devicePixelRatio)||1,v=16*f,_={width:7,height:9,font:10*f+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},P=function(){var o=navigator.userAgent.toLowerCase();return function(i){return o.indexOf(i)!==-1}}(),M={ie:P("trident"),chrome:P("chrome"),webkit:P("chrome")||P("safari"),safari:P("safari")&&!P("chrome"),mozilla:P("mozilla")&&!P("chrome")&&!P("safari")},c=function(){for(var o=document.getElementsByTagName("link"),i=0,w=o.length;i<w;i++)if((o[i].getAttribute("rel")||"").match(/\bicon\b/i))return o[i];return!1},p=function(){for(var o=document.getElementsByTagName("link"),i=0,w=o.length;i<w;i++){var R=typeof o[i]<"u";R&&(o[i].getAttribute("rel")||"").match(/\bicon\b/i)&&o[i].parentNode.removeChild(o[i])}},u=function(){if(!h||!d){var o=c();d=o?o.getAttribute("href"):"/favicon.ico",h||(h=d)}return d},s=function(){return n||(n=document.createElement("canvas"),n.width=v,n.height=v),n},W=function(o){if(o){p();var i=document.createElement("link");i.type="image/x-icon",i.rel="icon",i.href=o,document.getElementsByTagName("head")[0].appendChild(i)}},V=function(o){window.console&&window.console.log(o)},X=function(o,R){if(!s().getContext||M.ie||M.safari||a.fallback==="force")return g(o);var w=s().getContext("2d"),R=R||"#000000",Q=u();b=document.createElement("img"),b.onload=function(){w.clearRect(0,0,v,v),w.drawImage(b,0,0,b.width,b.height,0,0,v,v),(o+"").length>0&&N(w,o,R),z()},!Q.match(/^data/)&&a.crossOrigin&&(b.crossOrigin="anonymous"),b.src=Q},g=function(o){if(a.fallback){var i=document.title;i[0]==="("&&(i=i.slice(i.indexOf(" "))),(o+"").length>0?document.title="("+o+") "+i:document.title=i}},N=function(o,i,w){typeof i=="number"&&i>99&&a.abbreviate&&(i=F(i));var R=(i+"").length-1,Q=a.width*f+6*f*R,Z=a.height*f,S=v-Z,H=v-Q-f,j=16*f,D=16*f,k=2*f;o.font=(M.webkit?"bold ":"")+a.font,o.fillStyle=a.background,o.strokeStyle=a.background,o.lineWidth=f,o.beginPath(),o.moveTo(H+k,S),o.quadraticCurveTo(H,S,H,S+k),o.lineTo(H,j-k),o.quadraticCurveTo(H,j,H+k,j),o.lineTo(D-k,j),o.quadraticCurveTo(D,j,D,j-k),o.lineTo(D,S+k),o.quadraticCurveTo(D,S,D-k,S),o.closePath(),o.fill(),o.beginPath(),o.strokeStyle="rgba(0,0,0,0.3)",o.moveTo(H+k/2,j),o.lineTo(D-k/2,j),o.stroke(),o.fillStyle=a.color,o.textAlign="right",o.textBaseline="top",o.fillText(i,f===2?29:15,M.mozilla?7*f:6*f)},z=function(){s().getContext&&W(s().toDataURL())},F=function(o){for(var i=[["G",1e9],["M",1e6],["k",1e3]],w=0;w<i.length;++w)if(o>=i[w][1]){o=J(o/i[w][1])+i[w][0];break}return o},J=function(o,i){var w=new Number(o);return w.toFixed(i)};C.setOptions=function(o){a={},o.colour&&(o.color=o.colour);for(var i in _)a[i]=o.hasOwnProperty(i)?o[i]:_[i];return this},C.setImage=function(o){return d=o,z(),this},C.setBubble=function(o,i){return o=o||"",X(o,i),this},C.reset=function(){d=h,W(h)},C.setOptions(_),B=C,A=typeof B=="function"?B.call(K,I,K,Y):B,A!==void 0&&(Y.exports=A)})()}}]);

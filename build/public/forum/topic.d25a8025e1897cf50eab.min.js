"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9285,4781,1375,8306],{64451:(T,R,e)=>{var P,h;P=[e(25142),e(60392),e(54939),e(91748),e(60447),e(42840),e(69241),e(7237),e(66603),e(85233),e(74344),e(7927)],h=function(s,f,p,A,y,v,D,x,u,r,k,I){const o={};let i=0,d="";$(window).on("action:ajaxify.start",function(n,l){A.removeListeners(),String(l.url).startsWith("topic/")||(v.disable(),x.get("navbar/title").find("span").text("").hide(),I.remove("bookmark"))}),o.init=function(){const n=!i||parseInt(i,10)!==parseInt(ajaxify.data.tid,10);i=ajaxify.data.tid,d=ajaxify.currentPage,r.fire("action:topic.loading"),app.enterRoom("topic_"+i),n&&(y.signaturesShown={}),y.onTopicPageLoad(x.get("post")),v.init('[component="post"]',ajaxify.data.postcount,o.toTop,o.toBottom,utils.debounce(o.navigatorCallback,500)),p.init(i),f.init(i,$(".topic")),A.init(),D.handleSort("topicPostSort","topic/"+ajaxify.data.slug),config.usePagination||s.init($('[component="topic"]'),y.loadMorePosts),w(),S(),M(),W(),t(),E(i),$(window).on("scroll",utils.debounce(g,250)),a(),r.fire("action:topic.loaded",ajaxify.data)};function a(){e.e(2441).then(function(){var n=[e(42441)];(l=>{config.topicSearchEnabled&&e.e(7073).then(function(){var c=[e(7073)];(function(m){l.bind(["command+f","ctrl+f"],function(C){C.preventDefault(),$("#search-fields input").val("in:topic-"+ajaxify.data.tid+" "),m.showAndFocusInput()}),r.onPage("action:ajaxify.cleanup",()=>{l.unbind(["command+f","ctrl+f"])})}).apply(null,c)}).catch(e.oe),l.bind("j",()=>{const c=v.getIndex(),m=v.getCount();c!==m&&v.scrollToIndex(c,!0,0)}),l.bind("k",()=>{const c=v.getIndex();c!==1&&v.scrollToIndex(c-2,!0,0)})}).apply(null,n)}).catch(e.oe)}o.toTop=function(){v.scrollTop(0)},o.toBottom=function(){socket.emit("topics.postcount",ajaxify.data.tid,function(n,l){if(n)return I.error(n);v.scrollBottom(l-1)})};function E(n){if(window.location.hash){const m=$(utils.escapeHTML(window.location.hash));if(m.length)return v.scrollToElement(m,!0,0)}const l=ajaxify.data.bookmark||u.getItem("topic:"+n+":bookmark"),c=ajaxify.data.postIndex;if(c>1){if(x.get("post/anchor",c-1).length)return v.scrollToPostIndex(c-1,!0,0)}else l&&(!config.usePagination||config.usePagination&&ajaxify.data.pagination.currentPage===1)&&ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(I.alert({alert_id:"bookmark",message:"[[topic:bookmark_instructions]]",timeout:0,type:"info",clickfn:function(){v.scrollToIndex(parseInt(l,10),!0)},closefn:function(){u.removeItem("topic:"+n+":bookmark")}}),setTimeout(function(){I.remove("bookmark")},1e4))}function w(){x.get("topic").on("click","blockquote .toggle",function(){const n=$(this).parent("blockquote"),l=$(this);n.toggleClass("uncollapsed");const c=!n.hasClass("uncollapsed");l.toggleClass("fa-angle-down",c).toggleClass("fa-angle-up",!c)})}function S(){x.get("topic").on("click",'[component="post/parent"]',function(n){const l=$(this).attr("data-topid"),c=$('[component="topic"]>[component="post"][data-pid="'+l+'"]');if(c.length)return n.preventDefault(),v.scrollToIndex(c.attr("data-index"),!0),!1})}o.applyDropup=function(){const n=this.getBoundingClientRect(),l=this.querySelector(".dropdown-menu"),m=window.getComputedStyle(l).getPropertyValue("height").slice(0,-2),C=document.documentElement.style.getPropertyValue("--panel-offset").slice(0,-2),U=n.top+n.height-m-C>0;this.classList.toggle("dropup",U)};function M(){const n=$("#content .dropdown-menu").parent();$(n).on("shown.bs.dropdown",function(){this.querySelector(".dropdown-menu").innerHTML&&o.applyDropup.call(this)}),r.onPage("action:topic.tools.load",({element:l})=>{o.applyDropup.call(l.get(0).parentNode)}),r.onPage("action:post.tools.load",({element:l})=>{o.applyDropup.call(l.get(0).parentNode)})}function W(){$('[component="topic"]').on("click",'[component="post/reply-count"]',function(){const n=$(this);e.e(1352).then(function(){var l=[e(21352)];(function(c){c.init(n)}).apply(null,l)}).catch(e.oe)})}function t(){if(!ajaxify.data.showPostPreviewsOnHover||utils.isMobile())return;let n=0;const l={};$(window).one("action:ajaxify.start",function(){clearTimeout(n),$("#post-tooltip").remove()}),$('[component="topic"]').on("mouseenter",'[component="post"] a, [component="topic/event"] a',async function(){const c=$(this);async function m(b){const B=l[b]||await socket.emit("posts.getPostSummaryByPid",{pid:b});if($("#post-tooltip").remove(),B&&ajaxify.data.template.topic){l[b]=B;const O=await app.parseAndTranslate("partials/topic/post-preview",{post:B});O.hide().find(".timeago").timeago(),O.appendTo($("body")).fadeIn(300);const Y=c.parents('[component="topic"]').find('[component="post/content"]').first(),H=Y.offset(),Q=Y.width(),V=c.offset();O.css({top:V.top+30,left:H.left,width:Q})}}const C=c.attr("href"),U=utils.urlToLocation(C),L=U.pathname,N=C&&C!=="#"&&window.location.hostname===U.hostname;$("#post-tooltip").remove();const K=N&&L&&L.match(/\/post\/([\d]+)/),F=N&&L&&L.match(/\/topic\/([\d]+)/);if(K){const b=K[1];if(parseInt(c.parents('[component="post"]').attr("data-pid"),10)===parseInt(b,10))return;n=setTimeout(async()=>{m(b)},300)}else F&&(n=setTimeout(async()=>{const b=F[1],B=await k.get("/topics/"+b,{});m(B.mainPid)},300))}).on("mouseleave",'[component="post"] a, [component="topic/event"] a',function(){clearTimeout(n),$("#post-tooltip").remove()})}function g(){const n=x.get("navbar/title").find("span");$(window).scrollTop()>50&&n.hasClass("hidden")?n.html(ajaxify.data.title).removeClass("hidden"):$(window).scrollTop()<=50&&!n.hasClass("hidden")&&n.html("").addClass("hidden"),$(window).scrollTop()>300&&I.remove("bookmark")}o.navigatorCallback=function(n,l){if(!ajaxify.data.template.topic||v.scrollActive)return;const c="topic/"+ajaxify.data.slug+(n>1?"/"+n:"");if(c!==d&&(d=c,n>=l&&app.user.uid&&socket.emit("topics.markAsRead",[ajaxify.data.tid]),j(n),o.replaceURLTimeout=0,ajaxify.data.updateUrlWithPostIndex&&history.replaceState)){let m=window.location.search||"";config.usePagination||(m=m&&!/^\?page=\d+$/.test(m)?m:""),history.replaceState({url:c+m},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+c+m)}};function j(n){const l="topic:"+ajaxify.data.tid+":bookmark",c=ajaxify.data.bookmark||u.getItem(l);config.topicPostSort==="newest_to_oldest"&&(n=Math.max(1,ajaxify.data.postcount-n+2)),ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(!c||parseInt(n,10)>parseInt(c,10)||ajaxify.data.postcount<parseInt(c,10))&&(app.user.uid?socket.emit("topics.bookmark",{tid:ajaxify.data.tid,index:n},function(m){if(m)return I.error(m);ajaxify.data.bookmark=n+1}):u.setItem(l,n)),(!c||parseInt(n,10)>=parseInt(c,10))&&I.remove("bookmark")}return o}.apply(R,P),h!==void 0&&(T.exports=h)},91748:(T,R,e)=>{var P,h;P=[e(54939),e(60392),e(60447),e(47720),e(7237),e(32230),e(59006),e(85233)],h=function(s,f,p,A,y,v,D,x){const u={},r={"event:user_status_change":k,"event:voted":I,"event:bookmarked":o,"event:topic_deleted":f.setDeleteState,"event:topic_restored":f.setDeleteState,"event:topic_purged":i,"event:topic_locked":f.setLockedState,"event:topic_unlocked":f.setLockedState,"event:topic_pinned":f.setPinnedState,"event:topic_unpinned":f.setPinnedState,"event:topic_moved":d,"event:post_edited":a,"event:post_purged":E,"event:post_deleted":w,"event:post_restored":w,"posts.bookmark":S,"posts.unbookmark":S,"posts.upvote":M,"posts.downvote":M,"posts.unvote":M,"event:new_notification":W,"event:new_post":p.onNewPost};u.init=function(){u.removeListeners();for(const t in r)r.hasOwnProperty(t)&&socket.on(t,r[t])},u.removeListeners=function(){for(const t in r)r.hasOwnProperty(t)&&socket.removeListener(t,r[t])};function k(t){app.updateUserStatus($('[data-uid="'+t.uid+'"] [component="user/status"]'),t.status)}function I(t){const g=$('[data-pid="'+t.post.pid+'"] [component="post/vote-count"]').filter(function(n,l){return parseInt($(l).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}),j=$('.reputation[data-uid="'+t.post.uid+'"]');g.html(t.post.votes).attr("data-votes",t.post.votes),j.html(t.user.reputation).attr("data-reputation",t.user.reputation)}function o(t){$('[data-pid="'+t.post.pid+'"] .bookmarkCount').filter(function(g,j){return parseInt($(j).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}).html(t.post.bookmarks).attr("data-bookmarks",t.post.bookmarks)}function i(t){ajaxify.data.category&&ajaxify.data.category.slug&&parseInt(t.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("category/"+ajaxify.data.category.slug,null,!0)}function d(t){t&&t.slug&&parseInt(t.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("topic/"+t.slug,null,!0)}function a(t){if(!t||!t.post||parseInt(t.post.tid,10)!==parseInt(ajaxify.data.tid,10))return;const g=y.get("post/content",t.post.pid).filter(function(m,C){return parseInt($(C).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}),j=$('[data-pid="'+t.post.pid+'"] [component="post/editor"]').filter(function(m,C){return parseInt($(C).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}),n=y.get("topic/title"),l=y.get("navbar/title").find("span"),c=y.get("breadcrumb/current");if(t.topic.rescheduled)return ajaxify.go("topic/"+t.topic.slug,null,!0);if(n.length&&t.topic.title&&t.topic.renamed){ajaxify.data.title=t.topic.title;const m="topic/"+t.topic.slug+(window.location.search?window.location.search:"");history.replaceState({url:m},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+m),n.fadeOut(250,function(){n.html(t.topic.title).fadeIn(250)}),c.fadeOut(250,function(){c.html(t.topic.title).fadeIn(250)}),l.fadeOut(250,function(){l.html(t.topic.title).fadeIn(250)})}t.post.changed?g.fadeOut(250,function(){g.html(v.unescape(t.post.content)),g.find("img:not(.not-responsive)").addClass("img-responsive"),A.wrapImagesInLinks(g.parent()),p.addBlockquoteEllipses(g.parent()),g.fadeIn(250);const m={editor:t.editor,editedISO:utils.toISOString(t.post.edited)};app.parseAndTranslate("partials/topic/post-editor",m,function(C){j.replaceWith(C),$('[data-pid="'+t.post.pid+'"] [component="post/editor"] .timeago').timeago(),x.fire("action:posts.edited",t)})}):x.fire("action:posts.edited",t),t.topic.tags&&t.topic.tagsupdated&&D.render("partials/topic/tags",{tags:t.topic.tags}).then(function(m){const C=$(".tags");C.fadeOut(250,function(){C.html(m).fadeIn(250)})}),s.removeMenu(y.get("post","pid",t.post.pid))}function E(t){!t||parseInt(t.tid,10)!==parseInt(ajaxify.data.tid,10)||(y.get("post","pid",t.pid).fadeOut(500,function(){$(this).remove(),p.showBottomPostBar()}),ajaxify.data.postcount-=1,s.updatePostCount(ajaxify.data.postcount),e.e(1352).then(function(){var g=[e(21352)];(function(j){j.onPostPurged(t)}).apply(null,g)}).catch(e.oe))}function w(t){const g=y.get("post","pid",t.pid);if(!g.length)return;g.toggleClass("deleted");const j=g.hasClass("deleted");s.toggle(t.pid,j),!ajaxify.data.privileges.isAdminOrMod&&parseInt(t.uid,10)!==parseInt(app.user.uid,10)&&(g.find('[component="post/tools"]').toggleClass("hidden",j),j?g.find('[component="post/content"]').translateHtml("[[topic:post_is_deleted]]"):g.find('[component="post/content"]').html(v.unescape(t.content)))}function S(t){const g=$('[data-pid="'+t.post.pid+'"] [component="post/bookmark"]').filter(function(j,n){return parseInt($(n).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)});g.length&&(g.attr("data-bookmarked",t.isBookmarked),g.find('[component="post/bookmark/on"]').toggleClass("hidden",!t.isBookmarked),g.find('[component="post/bookmark/off"]').toggleClass("hidden",t.isBookmarked))}function M(t){const g=$('[data-pid="'+t.post.pid+'"]');g.find('[component="post/upvote"]').filter(function(j,n){return parseInt($(n).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}).toggleClass("upvoted",t.upvote),g.find('[component="post/downvote"]').filter(function(j,n){return parseInt($(n).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}).toggleClass("downvoted",t.downvote)}function W(t){const g=ajaxify.data.tid;t&&t.tid&&parseInt(t.tid,10)===parseInt(g,10)&&socket.emit("topics.markTopicNotificationsRead",[g])}return u}.apply(R,P),h!==void 0&&(T.exports=h)},60392:(T,R,e)=>{var P,h;P=[e(7237),e(32230),e(66044),e(60447),e(74344),e(85233),e(31369),e(7927)],h=function(s,f,p,A,y,v,D,x){const u={};u.init=function(o,i){r(i),i.on("click",'[component="topic/delete"]',function(){return k("del","/state","delete"),!1}),i.on("click",'[component="topic/restore"]',function(){return k("put","/state","restore"),!1}),i.on("click",'[component="topic/purge"]',function(){return k("del","","purge"),!1}),i.on("click",'[component="topic/lock"]',function(){return k("put","/lock","lock"),!1}),i.on("click",'[component="topic/unlock"]',function(){return k("del","/lock","unlock"),!1}),i.on("click",'[component="topic/pin"]',function(){return k("put","/pin","pin"),!1}),i.on("click",'[component="topic/unpin"]',function(){return k("del","/pin","unpin"),!1}),i.on("click",'[component="topic/event/delete"]',function(){const a=$(this).attr("data-topic-event-id"),E=$(this).parents('[component="topic/event"]');D.confirm("[[topic:delete-event-confirm]]",w=>{w&&y.del(`/topics/${o}/events/${a}`,{}).then(function(){E.remove()}).catch(x.error)})}),i.on("click",'[component="topic/mark-unread"]',function(){return socket.emit("topics.markUnread",o,function(a){if(a)return x.error(a);app.previousUrl&&!app.previousUrl.match("^/topic")?ajaxify.go(app.previousUrl,function(){p.onBackClicked(!0)}):ajaxify.data.category&&ajaxify.go("category/"+ajaxify.data.category.slug,p.onBackClicked),x.success("[[topic:mark_unread.success]]")}),!1}),i.on("click",'[component="topic/mark-unread-for-all"]',function(){const a=$(this);return socket.emit("topics.markAsUnreadForAll",[o],function(E){if(E)return x.error(E);x.success("[[topic:markAsUnreadForAll.success]]"),a.parents(".thread-tools.open").find(".dropdown-toggle").trigger("click")}),!1}),i.on("click",'[component="topic/move"]',function(){return e.e(7378).then(function(){var a=[e(57378)];(function(E){E.init([o],ajaxify.data.cid)}).apply(null,a)}).catch(e.oe),!1}),i.on("click",'[component="topic/delete/posts"]',function(){e.e(5253).then(function(){var a=[e(55253)];(function(E){E.init()}).apply(null,a)}).catch(e.oe)}),i.on("click",'[component="topic/fork"]',function(){e.e(5636).then(function(){var a=[e(25636)];(function(E){E.init()}).apply(null,a)}).catch(e.oe)}),i.on("click",'[component="topic/move-posts"]',function(){e.e(3094).then(function(){var a=[e(53094)];(function(E){E.init()}).apply(null,a)}).catch(e.oe)}),i.on("click",'[component="topic/following"]',function(){d("follow")}),i.on("click",'[component="topic/not-following"]',function(){d("follow",0)}),i.on("click",'[component="topic/ignoring"]',function(){d("ignore")});function d(a,E=1){return y[E?"put":"del"](`/topics/${o}/${a}`,{},()=>{let S="";a==="follow"?S=E?"[[topic:following_topic.message]]":"[[topic:not_following_topic.message]]":a==="ignore"&&(S=E?"[[topic:ignoring_topic.message]]":"[[topic:not_following_topic.message]]"),E||(a="unfollow"),I(a),x.alert({alert_id:"follow_thread",message:S,type:"success",timeout:5e3}),v.fire("action:topics.changeWatching",{tid:o,type:a})},()=>{x.alert({type:"danger",alert_id:"topic_follow",title:"[[global:please_log_in]]",message:"[[topic:login_to_subscribe]]",timeout:5e3})}),!1}};function r(o){o.on("show.bs.dropdown",".thread-tools",function(){const d=$(this).find(".dropdown-menu");d.html()||(d.toggleClass("hidden",!0),socket.emit("topics.loadTopicTools",{tid:ajaxify.data.tid,cid:ajaxify.data.cid},function(a,E){if(a)return x.error(a);app.parseAndTranslate("partials/topic/topic-menu-list",E,function(w){d.html(w),d.toggleClass("hidden",!1),v.fire("action:topic.tools.load",{element:d})})}))})}function k(o,i,d,a){a||(a=function(){});const E=ajaxify.data.tid,w={},S=function(M){M&&y[o](`/topics/${E}${i}`,w).then(a).catch(x.error)};switch(d){case"delete":case"restore":case"purge":D.confirm(`[[topic:thread_tools.${d}_confirm]]`,S);break;case"pin":u.requestPinExpiry(w,S.bind(null,!0));break;default:S(!0);break}}u.requestPinExpiry=function(o,i){app.parseAndTranslate("modals/set-pin-expiry",{},function(d){const a=D.dialog({title:"[[topic:thread_tools.pin]]",message:d,onEscape:!0,size:"small",buttons:{cancel:{label:"[[modules:bootbox.cancel]]",className:"btn-link"},save:{label:"[[global:save]]",className:"btn-primary",callback:function(){let w=a.get(0).querySelector("#expiry").value;if(w==="")return i();w=new Date(w),w&&w.getTime()>Date.now()?(o.expiry=w.getTime(),i()):x.error("[[error:invalid-date]]")}}}})})},u.setLockedState=function(o){const i=s.get("topic");if(parseInt(o.tid,10)!==parseInt(i.attr("data-tid"),10))return;const d=o.isLocked&&!ajaxify.data.privileges.isAdminOrMod;s.get("topic/lock").toggleClass("hidden",o.isLocked).parent().attr("hidden",o.isLocked?"":null),s.get("topic/unlock").toggleClass("hidden",!o.isLocked).parent().attr("hidden",o.isLocked?null:"");const a=!!((o.isLocked||ajaxify.data.deleted)&&!ajaxify.data.privileges.isAdminOrMod);s.get("topic/reply/container").toggleClass("hidden",a),s.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!o.isLocked||ajaxify.data.deleted),i.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",a),i.find('[component="post/edit"], [component="post/delete"]').toggleClass("hidden",d),i.find('[component="post"][data-uid="'+app.user.uid+'"].deleted [component="post/tools"]').toggleClass("hidden",d),$('[component="topic/labels"] [component="topic/locked"]').toggleClass("hidden",!o.isLocked),$('[component="post/tools"] .dropdown-menu').html(""),ajaxify.data.locked=o.isLocked,A.addTopicEvents(o.events)},u.setDeleteState=function(o){const i=s.get("topic");if(parseInt(o.tid,10)!==parseInt(i.attr("data-tid"),10))return;s.get("topic/delete").toggleClass("hidden",o.isDelete).parent().attr("hidden",o.isDelete?"":null),s.get("topic/restore").toggleClass("hidden",!o.isDelete).parent().attr("hidden",o.isDelete?null:""),s.get("topic/purge").toggleClass("hidden",!o.isDelete).parent().attr("hidden",o.isDelete?null:""),s.get("topic/deleted/message").toggleClass("hidden",!o.isDelete),o.isDelete&&app.parseAndTranslate("partials/topic/deleted-message",{deleter:o.user,deleted:!0,deletedTimestampISO:utils.toISOString(Date.now())},function(a){s.get("topic/deleted/message").replaceWith(a),a.find(".timeago").timeago()});const d=o.isDelete&&!ajaxify.data.privileges.isAdminOrMod;s.get("topic/reply/container").toggleClass("hidden",d),s.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!ajaxify.data.locked||o.isDelete),i.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",d),i.toggleClass("deleted",o.isDelete),ajaxify.data.deleted=o.isDelete?1:0,A.addTopicEvents(o.events)},u.setPinnedState=function(o){const i=s.get("topic");if(parseInt(o.tid,10)!==parseInt(i.attr("data-tid"),10))return;s.get("topic/pin").toggleClass("hidden",o.pinned).parent().attr("hidden",o.pinned?"":null),s.get("topic/unpin").toggleClass("hidden",!o.pinned).parent().attr("hidden",o.pinned?null:"");const d=$('[component="topic/labels"] [component="topic/pinned"]');d.toggleClass("hidden",!o.pinned),o.pinned&&d.translateAttr("title",o.pinExpiry&&o.pinExpiryISO?"[[topic:pinned-with-expiry, "+o.pinExpiryISO+"]]":"[[topic:pinned]]"),ajaxify.data.pinned=o.pinned,A.addTopicEvents(o.events)};function I(o){const i={follow:"[[topic:watching]]",unfollow:"[[topic:not-watching]]",ignore:"[[topic:ignoring]]"};f.translate(i[o],function(a){$('[component="topic/watch"] button').attr("title",a).tooltip("fixTitle")});let d=s.get("topic/following/menu");d.toggleClass("hidden",o!=="follow"),s.get("topic/following/check").toggleClass("fa-check",o==="follow"),d=s.get("topic/not-following/menu"),d.toggleClass("hidden",o!=="unfollow"),s.get("topic/not-following/check").toggleClass("fa-check",o==="unfollow"),d=s.get("topic/ignoring/menu"),d.toggleClass("hidden",o!=="ignore"),s.get("topic/ignoring/check").toggleClass("fa-check",o==="ignore")}return u}.apply(R,P),h!==void 0&&(T.exports=h)},66044:(T,R,e)=>{var P,h;P=[e(7237),e(66603),e(42840),e(78989)],h=function(s,f,p,A){const y={};let v;y.init=function(u){v=u,D(),$(window).off("action:popstate",x).on("action:popstate",x)},y.onBackClicked=x;function D(){$('[component="category"]').on("click",'[component="topic/header"]',function(){const u=$(this).parents("[data-index]").attr("data-index"),r=$(window).scrollTop();$('[component="category/topic"]').each(function(k,I){if($(I).offset().top-r>0)return f.setItem("category:bookmark",$(I).attr("data-index")),f.setItem("category:bookmark:clicked",u),f.setItem("category:bookmark:offset",$(I).offset().top-r),!1})})}function x(u){const r=u&&ajaxify.data.template.unread;if(ajaxify.data.template.category||ajaxify.data.template.recent||ajaxify.data.template.popular||r){let k=f.getItem("category:bookmark"),I=f.getItem("category:bookmark:clicked");if(f.removeItem("category:bookmark"),f.removeItem("category:bookmark:clicked"),!utils.isNumber(k))return;if(k=Math.max(0,parseInt(k,10)||0),I=Math.max(0,parseInt(I,10)||0),config.usePagination){const o=Math.ceil((parseInt(k,10)+1)/config.topicsPerPage);parseInt(o,10)!==ajaxify.data.pagination.currentPage?A.loadPage(o,function(){y.scrollToTopic(k,I)}):y.scrollToTopic(k,I)}else{if(k===0){y.scrollToTopic(k,I);return}$('[component="category"]').empty(),v(Math.max(0,k-1)+1,function(){y.scrollToTopic(k,I)})}}}return y.highlightTopic=function(u){const r=s.get("category/topic","index",u);r.length&&!r.hasClass("highlight")&&(r.addClass("highlight"),setTimeout(function(){r.removeClass("highlight")},5e3))},y.scrollToTopic=function(u,r){if(!utils.isNumber(u))return;const k=s.get("category/topic","index",u);if(k.length){const I=f.getItem("category:bookmark:offset");f.removeItem("category:bookmark:offset"),$(window).scrollTop(k.offset().top-I),y.highlightTopic(r),p.update()}},y}.apply(R,P),h!==void 0&&(T.exports=h)},69241:(T,R,e)=>{var P,h;P=[e(7237),e(74344)],h=function(s,f){const p={};return p.handleSort=function(A,y){const v=s.get("thread/sort");v.find("i").removeClass("fa-check"),v.find('a[data-sort="'+config[A]+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a').on("click",'[component="thread/sort"] a',function(){function x(r,k){config[A]=r;const I=decodeURIComponent($.param(k));ajaxify.go(y+(I?"?"+I:""))}const u=$(this).attr("data-sort");if(app.user.uid){const r={settings:{}};r.settings[A]=u,f.put(`/users/${app.user.uid}/settings`,r).then(()=>{x(u,utils.params())})}else{const r=utils.params();r.sort=u,x(u,r)}})},p}.apply(R,P),h!==void 0&&(T.exports=h)},66603:(T,R,e)=>{var P;P=function(){function h(){this._store={},this._keys=[]}h.prototype.isMock=!0,h.prototype.setItem=function(p,A){p=String(p),this._keys.indexOf(p)===-1&&this._keys.push(p),this._store[p]=A},h.prototype.getItem=function(p){return p=String(p),this._keys.indexOf(p)===-1?null:this._store[p]},h.prototype.removeItem=function(p){p=String(p),this._keys=this._keys.filter(function(A){return A!==p}),this._store[p]=null},h.prototype.clear=function(){this._keys=[],this._store={}},h.prototype.key=function(p){return p=parseInt(p,10)||0,this._keys[p]},Object.defineProperty&&Object.defineProperty(h.prototype,"length",{get:function(){return this._keys.length}});let s;const f=Date.now().toString();try{if(s=window.localStorage,s.setItem(f,f),s.getItem(f)!==f)throw Error("localStorage behaved unexpectedly");return s.removeItem(f),s}catch(p){console.warn(p),console.warn("localStorage failed, falling back on sessionStorage");try{if(s=window.sessionStorage,s.setItem(f,f),s.getItem(f)!==f)throw Error("sessionStorage behaved unexpectedly");return s.removeItem(f),s}catch(A){return console.warn(A),console.warn("sessionStorage failed, falling back on memory storage"),new h}}}.call(R,e,R,T),P!==void 0&&(T.exports=P)}}]);

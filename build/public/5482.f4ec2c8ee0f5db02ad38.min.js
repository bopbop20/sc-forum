(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5482,2735,882,3034,3564],{45482:(b,E,c)=>{b.exports=c(35729)},83713:(b,E,c)=>{b.exports=c(51077)},38259:(b,E,c)=>{b.exports=c(65616)},27145:(b,E,c)=>{"use strict";b=c.nmd(b);var m,g;m=[c(59006),c(32230),c(85233)],g=function(v,a,l){const t={};t.init=function(){const e=this;v.render("modules/taskbar",{}).then(function(o){e.taskbar=$(o),e.tasklist=e.taskbar.find("ul"),$(document.body).append(e.taskbar),e.taskbar.on("click","li",async function(){const s=$(this),u=s.attr("data-module"),h=s.attr("data-uuid"),p=await app.require(u);return s.hasClass("active")?p.minimize(h):(i(),p.load(h),t.toggleNew(h,!1),t.tasklist.removeClass("active"),s.addClass("active")),!1})}),$(window).on("action:app.loggedOut",function(){t.closeAll()})},t.close=async function(e,o){const s=t.tasklist.find('[data-module="'+b+'"][data-uuid="'+o+'"]');let u="close";if(e==="chat"&&(u="closeByUUID"),s.length){const h=await app.require(e);h&&typeof h[u]=="function"&&h[u](o)}},t.closeAll=function(e){let o="[data-uuid]";e&&(o='[data-module="'+e+'"]'+o),t.tasklist.find(o).each(function(s,u){t.close(e||u.getAttribute("data-module"),u.getAttribute("data-uuid"))})},t.discard=function(e,o){t.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]').remove(),d()},t.push=function(e,o,s,u){u=u||function(){};const h=t.tasklist.find('li[data-uuid="'+o+'"]'),p={module:e,uuid:o,options:s,element:h};l.fire("filter:taskbar.push",p),!h.length&&p.module?r(p,u):u(h)},t.get=function(e){return $('[data-module="'+e+'"]').map(function(s,u){return $(u).data()})},t.minimize=function(e,o){t.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]').toggleClass("active",!1)},t.toggleNew=function(e,o,s){t.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",o),s||l.fire("action:taskbar.toggleNew",e)},t.updateActive=function(e){const o=t.tasklist.find("li");o.removeClass("active"),o.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},t.isActive=function(e){return t.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function d(){t.tasklist.find("li").length>0?t.taskbar.attr("data-active","1"):t.taskbar.removeAttr("data-active")}function i(){t.tasklist.find(".active").removeClass("active")}function r(e,o){a.translate(e.options.title,function(s){const u=$("<div></div>").text(s||"NodeBB Task").html(),h=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+u+'" component="taskbar/title">'+u+"</span></a>").attr({title:u,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&i(),t.tasklist.append(h),d(),e.element=h,h.data(e),l.fire("action:taskbar.pushed",e),o(h)})}const n=function(e,o,s){switch(o){case"title":e.find('[component="taskbar/title"]').text(s);break;case"icon":e.find("i").attr("class","fa fa-"+s);break;case"image":e.find("a").css("background-image",s?'url("'+s.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",s);break}};return t.update=function(e,o,s){const u=t.tasklist.find('[data-module="'+e+'"][data-uuid="'+o+'"]');if(!u.length)return;const h=u.data();Object.keys(s).forEach(function(p){h[p]=s[p],n(u,p,s[p])}),u.data(h)},t}.apply(E,m),g!==void 0&&(b.exports=g)},62023:(b,E,c)=>{"use strict";var m,g;m=[c(74344),c(31369),c(7927),c(50431),c(59006),c(32230),c(62526)],g=function(v,a,l,t,d,i){const r={};return r.get=n=>v.get(`/topics/${n}/thumbs`,{}),r.getByPid=n=>v.get(`/posts/${n}`,{}).then(e=>r.get(e.tid)),r.delete=(n,e)=>v.del(`/topics/${n}/thumbs`,{path:e}),r.deleteAll=n=>{r.get(n).then(e=>{Promise.all(e.map(o=>r.delete(n,o.url)))})},r.upload=n=>new Promise(e=>{t.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${n}/thumbs`},function(o){e(o)})}),r.modal={},r.modal.open=function(n){const{id:e,pid:o}=n;let{modal:s}=n,u;return new Promise(h=>{Promise.all([r.get(e),o?r.getByPid(o):[]]).then(p=>new Promise(z=>{const F=p.reduce((y,f)=>y.concat(f));u=F.length,z(F)})).then(p=>d.render("modals/topic-thumbs",{thumbs:p})).then(p=>{s?i.translate(p,function(z){s.find(".bootbox-body").html(z),r.modal.handleSort({modal:s,numThumbs:u})}):(s=a.dialog({title:"[[modules:thumbs.modal.title]]",message:p,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(r.upload(e).then(()=>{r.modal.open({...n,modal:s}),Promise.all([c.e(1006),c.e(2265),c.e(9915),c.e(7804)]).then(function(){var z=[c(44541)];(F=>{F.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),h()}).apply(null,z)}).catch(c.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),r.modal.handleDelete({...n,modal:s}),r.modal.handleSort({modal:s,numThumbs:u}))})})},r.modal.handleDelete=n=>{n.modal.get(0).addEventListener("click",o=>{o.target.closest('button[data-action="remove"]')&&a.confirm("[[modules:thumbs.modal.confirm-remove]]",s=>{if(!s)return;const u=o.target.closest(".media[data-id]").getAttribute("data-id"),h=o.target.closest(".media[data-path]").getAttribute("data-path");v.del(`/topics/${u}/thumbs`,{path:h}).then(()=>{r.modal.open(n)}).catch(l.error)})})},r.modal.handleSort=({modal:n,numThumbs:e})=>{if(e>1){const o=n.find(".topic-thumbs-modal");o.sortable({items:"[data-id]"}),o.on("sortupdate",r.modal.handleSortChange)}},r.modal.handleSortChange=(n,e)=>{const o=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(o).forEach((s,u)=>{const h=s.getAttribute("data-id");let p=s.getAttribute("data-path");p=p.replace(new RegExp(`^${config.upload_url}`),""),v.put(`/topics/${h}/thumbs/order`,{path:p,order:u}).catch(l.error)})},r}.apply(E,m),g!==void 0&&(b.exports=g)},50431:(b,E,c)=>{"use strict";var m,g;m=[c(86569)],g=function(){const v={};v.show=function(i,r){const n=i.hasOwnProperty("fileSize")&&i.fileSize!==void 0?parseInt(i.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:i.hasOwnProperty("showHelp")&&i.showHelp!==void 0?i.showHelp:!0,fileSize:n,title:i.title||"[[global:upload_file]]",description:i.description||"",button:i.button||"[[global:upload]]",accept:i.accept?i.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const o=e.find("#uploadForm");o.attr("action",i.route),o.find("#params").val(JSON.stringify(i.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),o.submit()}),o.submit(function(){return a(e,n,r),!1})})},v.hideAlerts=function(i){$(i).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function a(i,r,n){l(i,"status","[[uploads:uploading-file]]"),i.find("#upload-progress-bar").css("width","0%"),i.find("#upload-progress-box").show().removeClass("hide");const e=i.find("#fileInput");if(!e.val())return l(i,"error","[[uploads:select-file-to-upload]]");if(!d(e[0],r))return l(i,"error","[[error:file-too-big, "+r+"]]");v.ajaxSubmit(i,n)}function l(i,r,n){v.hideAlerts(i),r==="error"&&i.find("#fileUploadSubmitBtn").removeClass("disabled"),i.find("#alert-"+r).translateText(n).removeClass("hide")}v.ajaxSubmit=function(i,r){i.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=t(e),l(i,"error",e.responseJSON?e.responseJSON.error||e.statusText:"error uploading, code : "+e.status)},uploadProgress:function(e,o,s,u){i.find("#upload-progress-bar").css("width",u+"%")},success:function(e){let o=t(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(o=e.response.images),r(o[0].url),l(i,"success","[[uploads:upload-success]]"),setTimeout(function(){v.hideAlerts(i),i.modal("hide")},750)}})};function t(i){if(typeof i=="string")try{return $.parseJSON(i)}catch{return{error:"[[error:parse-error]]"}}return i}function d(i,r){return window.FileReader&&r?i.files[0].size<=r*1e3:!0}return v}.apply(E,m),g!==void 0&&(b.exports=g)},35729:(b,E,c)=>{"use strict";var m,g;m=[c(83713),c(38259),c(62023),c(10577)],g=function(v,a,l,t){var d={},i={picture:function(){var n=this;n.find("#files").click()},upload:function(){var n=this;n.find("#files").click()},thumbs:function(){d.exitFullscreen();var n=this;Promise.all([c.e(1006),c.e(2265),c.e(9915),c.e(7913)]).then(function(){var e=[c(44541)];(function(o){const s=n.get(0).getAttribute("data-uuid"),u=o.posts[s];(u.action==="topics.post"||u.action==="posts.edit"&&u.isMain)&&l.modal.open({id:s,pid:u.pid}).then(()=>{n.trigger("thumb.uploaded"),o.updateThumbCount(s,n)})}).apply(null,e)}).catch(c.oe)},tags:function(){var n=this;n.find(".tags-container").toggleClass("hidden")},zen:function(){var n=this;$(window).one("resize",function(){function e(){t.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),a.reposition(n),$(window).off("resize",e))}t.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),n.find(".write").focus(),$(window).on("resize",e),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",t.exit))}),t.toggle(n.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:n})}},r=[];return d.exitFullscreen=function(){t.isEnabled&&t.isFullscreen&&t.exit()},d.addComposerButtons=function(){for(var n=0,e=r.length;n<e;n++)$(".formatting-bar .formatting-group #fileForm").before('<li tabindex="-1" data-format="'+r[n].name+'" title="'+(r[n].title||"")+'"><i class="'+r[n].iconClass+'"></i></li>')},d.addButton=function(n,e,o,s){s=s||n.replace("fa fa-",""),i[s]=e,r.push({name:s,iconClass:n,title:o})},d.getDispatchTable=function(){return i},d.addButtonDispatch=function(n,e){i[n]=e},d.addHandler=function(n){n.on("click",".formatting-bar li",function(e){var o=$(this).attr("data-format"),s=$(this).parents('[component="composer"]').find("textarea")[0];i.hasOwnProperty(o)&&(i[o].call(n,s,s.selectionStart,s.selectionEnd,e),v.render(n))})},d}.apply(E,m),g!==void 0&&(b.exports=g)},51077:(b,E,c)=>{"use strict";var m,g;m=[c(85233)],g=function(v){var a={};return a.render=function(l,t){if(t=t||function(){},!l.find(".preview-container").is(":visible"))return t();var d=l.find("textarea");socket.emit("plugins.composer.renderPreview",d.val(),function(i,r){i||(r=$("<div>"+r+"</div>"),r.find("img:not(.not-responsive)").addClass("img-responsive"),l.find(".preview").html(r),v.fire("action:composer.preview"),t())})},a.matchScroll=function(l){if(l.find(".preview-container").is(":visible")){var t=l.find("textarea"),d=l.find(".preview");if(t.length&&d.length){var i=t[0].scrollHeight-t.height();if(i===0)return;var r=t.scrollTop()/i;d.scrollTop(Math.max(d[0].scrollHeight-d.height(),0)*r)}}},a.handleToggler=function(l){a.env=utils.findBootstrapEnvironment();var t=l.find(".write-container .toggle-preview"),d=l.find(".preview-container .toggle-preview"),i=$(".preview-container"),r=$(".write-container");function n(){o(!1),a.env!=="xs"&&a.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function e(){o(!0),a.env!=="xs"&&a.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function o(s){a.env==="xs"||a.env==="sm"?(i.toggleClass("hide",!1),r.toggleClass("maximized",!1),t.toggleClass("hide",!0),i.toggleClass("hidden-xs hidden-sm",!s),r.toggleClass("hidden-xs hidden-sm",s),s&&a.render(l)):(i.toggleClass("hide",!s),r.toggleClass("maximized",!s),t.toggleClass("hide",s)),a.matchScroll(l)}a.toggle=o,d.on("click",function(){n(),l.find(".write").focus()}),t.on("click",function(){e(),l.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||a.env==="xs"||a.env==="sm"?n():e()},a}.apply(E,m),g!==void 0&&(b.exports=g)},65616:(b,E,c)=>{"use strict";var m,g;m=[c(27145)],g=function(v){var a={},l=0,t=.3,d=.05,i=992,r=$("body"),n=$(window),e=$('[component="navbar"]'),o=document.body,s=e[0];function u(){return localStorage.getItem("composer:resizeRatio")||.5}function h(f){localStorage.setItem("composer:resizeRatio",Math.min(f,1))}function p(){var f;s?f=s.getBoundingClientRect():f={bottom:0};var w=Math.max(f.bottom,0),A={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return A.width=A.right,A.height=A.bottom,A.boundedTop=w,A.boundedHeight=A.bottom-w,A}function z(f,w){var A=p(),S=f[0],D=window.getComputedStyle(S),I=parseInt(D.getPropertyValue("min-height"),10),N=Math.max(I/window.innerHeight,t);if(A.width>=i){const T=(A.height-A.boundedHeight)/A.height;w=Math.min(Math.max(w,N+T),1);var B=w*A.boundedHeight/A.height;S.style.top=((1-B)*100).toString()+"%";var k=S.getBoundingClientRect();o.style.paddingBottom=(k.bottom-k.top).toString()+"px"}else f.removeAttr("style"),o.style.paddingBottom=0;f.ratio=w,S.style.visibility="visible",v.updateActive(f.attr("data-uuid"))}var F=z,y=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return y&&(F=function(f,w){y(function(){z(f,w),setTimeout(function(){n.trigger("action:composer.resize"),f.trigger("action:composer.resize")},0)})}),a.reposition=function(f){var w=u();w>=1-d&&(w=1,f.addClass("maximized")),F(f,w)},a.maximize=function(f,w){w?F(f,1):a.reposition(f)},a.handleResize=function(f){var w=0,A=0,S=0,D=f.find(".resizer"),I=D[0];function N(x){var P=I.getBoundingClientRect(),C=(P.top+P.bottom)/2;w=(C-x.clientY)/2,A=x.clientY,n.on("mousemove",B),n.on("mouseup",k),r.on("touchmove",T)}function B(x){var P=x.clientY-w,C=p(),R=(C.height-P)/C.boundedHeight;F(f,R)}function k(x){x.preventDefault(),S=x.clientY,f.find("textarea").focus(),n.off("mousemove",B),n.off("mouseup",k),r.off("touchmove",T);var P=S-w,C=p(),R=(C.height-P)/C.boundedHeight;S-A===0&&f.hasClass("maximized")?(f.removeClass("maximized"),R=!l||l>=1-d?.5:l,F(f,R)):S-A===0||R>=1-d?(F(f,1),f.addClass("maximized"),l=R):f.removeClass("maximized"),h(R)}function T(x){x.preventDefault(),B(x.touches[0])}D.on("mousedown",function(x){x.preventDefault(),N(x)}).on("touchstart",function(x){x.preventDefault(),N(x.touches[0])}).on("touchend",k)},a}.apply(E,m),g!==void 0&&(b.exports=g)},10577:b=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var E=typeof window<"u"&&typeof window.document<"u"?window.document:{},c=b.exports,m=function(){for(var a,l=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],t=0,d=l.length,i={};t<d;t++)if(a=l[t],a&&a[1]in E){for(t=0;t<a.length;t++)i[l[0][t]]=a[t];return i}return!1}(),g={change:m.fullscreenchange,error:m.fullscreenerror},v={request:function(a,l){return new Promise(function(t,d){var i=function(){this.off("change",i),t()}.bind(this);this.on("change",i),a=a||E.documentElement;var r=a[m.requestFullscreen](l);r instanceof Promise&&r.then(i).catch(d)}.bind(this))},exit:function(){return new Promise(function(a,l){if(!this.isFullscreen){a();return}var t=function(){this.off("change",t),a()}.bind(this);this.on("change",t);var d=E[m.exitFullscreen]();d instanceof Promise&&d.then(t).catch(l)}.bind(this))},toggle:function(a,l){return this.isFullscreen?this.exit():this.request(a,l)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(a,l){var t=g[a];t&&E.addEventListener(t,l,!1)},off:function(a,l){var t=g[a];t&&E.removeEventListener(t,l,!1)},raw:m};if(!m){c?b.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(v,{isFullscreen:{get:function(){return Boolean(E[m.fullscreenElement])}},element:{enumerable:!0,get:function(){return E[m.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(E[m.fullscreenEnabled])}}}),c?b.exports=v:window.screenfull=v})()}}]);

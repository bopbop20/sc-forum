(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6851],{66485:(S,x,u)=>{"use strict";var p,h;p=[u(74344),u(7927)],h=function(w,r){var i={},o;i.init=function(t,l){var e=t.find(".draft-icon");function n(){c(),o=setTimeout(function(){v(t,e,l)},1e3)}t.on("keyup","textarea, input.handle, input.title",n),t.on("click",'input[type="checkbox"]',n),t.on("thumb.uploaded",n),e.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){var a=[];try{a=localStorage.getItem("drafts:open"),a=JSON.parse(a)||[]}catch{console.warn("[composer/drafts] Could not read list of open/available drafts"),a=[]}a.length&&a.forEach(function(f){i.updateVisibility("open",f)})}),i.migrateGuest(),i.migrateThumbs(...arguments)};function c(){o&&(clearTimeout(o),o=0)}i.getDraft=function(t){return console.warn("[composer/drafts] drafts.getDraft is deprecated! Use drafts.get() instead."),localStorage.getItem(t)};function g(t){return parseInt(t,10)>0?localStorage:sessionStorage}i.get=function(t){var l=t.split(":")[1],e=g(l),n={text:e.getItem(t)};return["cid","title","tags","uuid"].forEach(function(a){const f=e.getItem(t+":"+a);f&&(n[a]=f)}),parseInt(l,10)||(n.handle=e.getItem(t+":handle")),$(window).trigger("action:composer.drafts.get",{save_id:t,draft:n,storage:e}),n};function v(t,l,e){if(s(app.user.uid?"localStorage":"sessionStorage")&&e&&e.save_id&&t.length){const R=t.find("input.title"),m=R&&R.val();var n=t.find("textarea").val(),a=g(app.user.uid);if(e.hasOwnProperty("cid")&&!e.save_id.endsWith(":cid:"+e.cid)&&(i.removeDraft(e.save_id),e.save_id=e.save_id.replace(/cid:\d+$/,"cid:"+e.cid)),n.length||m&&m.length){if(a.setItem(e.save_id,n),a.setItem(`${e.save_id}:uuid`,t.attr("data-uuid")),e.hasOwnProperty("cid")){const z=t.find("input.tags").val();a.setItem(e.save_id+":tags",z),a.setItem(e.save_id+":title",m)}if(!app.user.uid){var f=t.find("input.handle").val();a.setItem(e.save_id+":handle",f)}$(window).trigger("action:composer.drafts.save",{storage:a,postData:e,postContainer:t}),l.toggleClass("active",!0)}else i.removeDraft(e.save_id)}}i.removeDraft=function(t){if(!t)return;c(),i.updateVisibility("available",t),i.updateVisibility("open",t);var l=t.split(":")[1],e=g(l);Object.keys(e).filter(a=>a.startsWith(t)).forEach(a=>e.removeItem(a))},i.updateVisibility=function(t,l,e){if(!(!s(app.user.uid?"localStorage":"sessionStorage")||!l)){var n=[];try{n=localStorage.getItem("drafts:"+t),n=n?JSON.parse(n):[]}catch{console.warn("[composer/drafts] Could not read list of open drafts"),n=[]}var a=n.indexOf(l);e&&a===-1?n.push(l):!e&&a!==-1&&n.splice(a,1),localStorage.setItem("drafts:"+t,JSON.stringify(n))}},i.migrateGuest=function(){if(s("localStorage")&&app.user.uid){var t=/^composer:\d+:\w+:\d+(:\w+)?$/,l=Object.keys(sessionStorage).filter(function(a){return t.test(a)}),e=new Set([]),n=l.map(function(a){var f=a.split(":");return f[1]=app.user.uid,e.add(f.slice(0,4).join(":")),f.join(":")});return l.forEach(function(a,f){localStorage.setItem(n[f],sessionStorage.getItem(a)),sessionStorage.removeItem(a)}),e.forEach(function(a){i.updateVisibility("available",a,1)}),e}},i.migrateThumbs=function(t,l){if(!app.uid)return;const e=t.attr("data-uuid"),n=i.get(l.save_id);n&&n.uuid&&w.put(`/topics/${n.uuid}/thumbs`,{tid:e}).then(()=>{Promise.all([u.e(6177),u.e(2526),u.e(1006),u.e(2265),u.e(9915),u.e(5482)]).then(function(){var a=[u(44541)];(function(f){f.updateThumbCount(e,t)}).apply(null,a)}).catch(u.oe)})},i.loadOpen=function(){if(!(ajaxify.data.template.login||ajaxify.data.template.register)){var t,l=[];try{t=localStorage.getItem("drafts:available"),l=localStorage.getItem("drafts:open"),t=JSON.parse(t)||[],l=JSON.parse(l)||[]}catch{console.warn("[composer/drafts] Could not read list of open/available drafts"),t=[],l=[]}t.length&&t.forEach(function(e){if(e){var n=e.split(":"),a=n[1],f=n[2],R=n[3],m=i.get(e);if(l.indexOf(e)===-1&&parseInt(app.user.uid,10)===parseInt(a,10)){if(!m||m.text&&m.title&&!m.text.title&&!m.text.length){i.updateVisibility("available",e),i.updateVisibility("open",e);return}Promise.all([u.e(6177),u.e(2526),u.e(1006),u.e(2265),u.e(9915),u.e(5482)]).then(function(){var z=[u(44541)];(function(d){f==="cid"?d.newTopic({cid:R,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(m.handle),title:utils.escapeHTML(m.title),body:utils.escapeHTML(m.text),tags:String(m.tags||"").split(",")}):f==="tid"?w.get("/topics/"+R,{},function(E,b){if(E)return r.error(E);d.newReply(R,void 0,b.title,utils.escapeHTML(m.text))}):f==="pid"&&d.editPost(R)}).apply(null,z)}).catch(u.oe)}}})}};function s(t){var l;try{l=window[t];var e="__storage_test__";return l.setItem(e,e),l.removeItem(e),!0}catch(n){return n instanceof DOMException&&(n.code===22||n.code===1014||n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED")&&l&&l.length!==0}}return i}.apply(x,p),h!==void 0&&(S.exports=h)},35729:(S,x,u)=>{"use strict";var p,h;p=[u(83713),u(38259),u(62023),u(10577)],h=function(w,r,i,o){var c={},g={picture:function(){var s=this;s.find("#files").click()},upload:function(){var s=this;s.find("#files").click()},thumbs:function(){c.exitFullscreen();var s=this;Promise.all([u.e(1006),u.e(2265),u.e(9915),u.e(7913)]).then(function(){var t=[u(44541)];(function(l){const e=s.get(0).getAttribute("data-uuid"),n=l.posts[e];(n.action==="topics.post"||n.action==="posts.edit"&&n.isMain)&&i.modal.open({id:e,pid:n.pid}).then(()=>{s.trigger("thumb.uploaded"),l.updateThumbCount(e,s)})}).apply(null,t)}).catch(u.oe)},tags:function(){var s=this;s.find(".tags-container").toggleClass("hidden")},zen:function(){var s=this;$(window).one("resize",function(){function t(){o.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),r.reposition(s),$(window).off("resize",t))}o.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),s.find(".write").focus(),$(window).on("resize",t),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",o.exit))}),o.toggle(s.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:s})}},v=[];return c.exitFullscreen=function(){o.isEnabled&&o.isFullscreen&&o.exit()},c.addComposerButtons=function(){for(var s=0,t=v.length;s<t;s++)$(".formatting-bar .formatting-group #fileForm").before('<li tabindex="-1" data-format="'+v[s].name+'" title="'+(v[s].title||"")+'"><i class="'+v[s].iconClass+'"></i></li>')},c.addButton=function(s,t,l,e){e=e||s.replace("fa fa-",""),g[e]=t,v.push({name:e,iconClass:s,title:l})},c.getDispatchTable=function(){return g},c.addButtonDispatch=function(s,t){g[s]=t},c.addHandler=function(s){s.on("click",".formatting-bar li",function(t){var l=$(this).attr("data-format"),e=$(this).parents('[component="composer"]').find("textarea")[0];g.hasOwnProperty(l)&&(g[l].call(s,e,e.selectionStart,e.selectionEnd,t),w.render(s))})},c}.apply(x,p),h!==void 0&&(S.exports=h)},51077:(S,x,u)=>{"use strict";var p,h;p=[u(85233)],h=function(w){var r={};return r.render=function(i,o){if(o=o||function(){},!i.find(".preview-container").is(":visible"))return o();var c=i.find("textarea");socket.emit("plugins.composer.renderPreview",c.val(),function(g,v){g||(v=$("<div>"+v+"</div>"),v.find("img:not(.not-responsive)").addClass("img-responsive"),i.find(".preview").html(v),w.fire("action:composer.preview"),o())})},r.matchScroll=function(i){if(i.find(".preview-container").is(":visible")){var o=i.find("textarea"),c=i.find(".preview");if(o.length&&c.length){var g=o[0].scrollHeight-o.height();if(g===0)return;var v=o.scrollTop()/g;c.scrollTop(Math.max(c[0].scrollHeight-c.height(),0)*v)}}},r.handleToggler=function(i){r.env=utils.findBootstrapEnvironment();var o=i.find(".write-container .toggle-preview"),c=i.find(".preview-container .toggle-preview"),g=$(".preview-container"),v=$(".write-container");function s(){l(!1),r.env!=="xs"&&r.env!=="sm"&&localStorage.setItem("composer:previewToggled",!0)}function t(){l(!0),r.env!=="xs"&&r.env!=="sm"&&localStorage.removeItem("composer:previewToggled")}function l(e){r.env==="xs"||r.env==="sm"?(g.toggleClass("hide",!1),v.toggleClass("maximized",!1),o.toggleClass("hide",!0),g.toggleClass("hidden-xs hidden-sm",!e),v.toggleClass("hidden-xs hidden-sm",e),e&&r.render(i)):(g.toggleClass("hide",!e),v.toggleClass("maximized",!e),o.toggleClass("hide",e)),r.matchScroll(i)}r.toggle=l,c.on("click",function(){s(),i.find(".write").focus()}),o.on("click",function(){t(),i.find(".write").focus()}),localStorage.getItem("composer:previewToggled")||r.env==="xs"||r.env==="sm"?s():t()},r}.apply(x,p),h!==void 0&&(S.exports=h)},65616:(S,x,u)=>{"use strict";var p,h;p=[u(27145)],h=function(w){var r={},i=0,o=.3,c=.05,g=992,v=$("body"),s=$(window),t=$('[component="navbar"]'),l=document.body,e=t[0];function n(){return localStorage.getItem("composer:resizeRatio")||.5}function a(d){localStorage.setItem("composer:resizeRatio",Math.min(d,1))}function f(){var d;e?d=e.getBoundingClientRect():d={bottom:0};var E=Math.max(d.bottom,0),b={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return b.width=b.right,b.height=b.bottom,b.boundedTop=E,b.boundedHeight=b.bottom-E,b}function R(d,E){var b=f(),A=d[0],D=window.getComputedStyle(A),N=parseInt(D.getPropertyValue("min-height"),10),B=Math.max(N/window.innerHeight,o);if(b.width>=g){const C=(b.height-b.boundedHeight)/b.height;E=Math.min(Math.max(E,B+C),1);var T=E*b.boundedHeight/b.height;A.style.top=((1-T)*100).toString()+"%";var M=A.getBoundingClientRect();l.style.paddingBottom=(M.bottom-M.top).toString()+"px"}else d.removeAttr("style"),l.style.paddingBottom=0;d.ratio=E,A.style.visibility="visible",w.updateActive(d.attr("data-uuid"))}var m=R,z=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return z&&(m=function(d,E){z(function(){R(d,E),setTimeout(function(){s.trigger("action:composer.resize"),d.trigger("action:composer.resize")},0)})}),r.reposition=function(d){var E=n();E>=1-c&&(E=1,d.addClass("maximized")),m(d,E)},r.maximize=function(d,E){E?m(d,1):r.reposition(d)},r.handleResize=function(d){var E=0,b=0,A=0,D=d.find(".resizer"),N=D[0];function B(y){var P=N.getBoundingClientRect(),I=(P.top+P.bottom)/2;E=(I-y.clientY)/2,b=y.clientY,s.on("mousemove",T),s.on("mouseup",M),v.on("touchmove",C)}function T(y){var P=y.clientY-E,I=f(),F=(I.height-P)/I.boundedHeight;m(d,F)}function M(y){y.preventDefault(),A=y.clientY,d.find("textarea").focus(),s.off("mousemove",T),s.off("mouseup",M),v.off("touchmove",C);var P=A-E,I=f(),F=(I.height-P)/I.boundedHeight;A-b===0&&d.hasClass("maximized")?(d.removeClass("maximized"),F=!i||i>=1-c?.5:i,m(d,F)):A-b===0||F>=1-c?(m(d,1),d.addClass("maximized"),i=F):d.removeClass("maximized"),a(F)}function C(y){y.preventDefault(),T(y.touches[0])}D.on("mousedown",function(y){y.preventDefault(),B(y)}).on("touchstart",function(y){y.preventDefault(),B(y.touches[0])}).on("touchend",M)},r}.apply(x,p),h!==void 0&&(S.exports=h)},62095:(S,x,u)=>{"use strict";var p,h;p=[u(7237),u(44541),u(2585),u(74344),u(7927),u(33371),u(42441)],h=function(w,r,i,o,c,g,v){var s={};return s.init=function(){var t=w.get("topic/quickreply/text"),l={element:t,strategies:[],options:{style:{"z-index":100}}};$(window).trigger("composer:autocomplete:init",l),i._active.persona_qr=i.setup(l),v.bind("ctrl+return",n=>{n.target===t.get(0)&&w.get("topic/quickreply/button").get(0).click()}),g.init({dragDropAreaEl:$('[component="topic/quickreply/container"] .quickreply-message'),pasteEl:t,uploadFormEl:$('[component="topic/quickreply/upload"]'),inputEl:t,route:"/api/post/upload",callback:function(n){let a=t.val();n.forEach(f=>{a=a+(a?`
`:"")+(f.isImage?"!":"")+`[${f.filename}](${f.url})`}),t.val(a)}});var e=!0;w.get("topic/quickreply/button").on("click",function(n){if(n.preventDefault(),!!e){var a=w.get("topic/quickreply/text").val(),f={tid:ajaxify.data.tid,handle:void 0,content:a};e=!1,o.post(`/topics/${ajaxify.data.tid}`,f,function(R,m){if(e=!0,R)return c.error(R);m&&m.queued&&c.alert({type:"success",title:"[[global:alert.success]]",message:m.message,timeout:1e4,clickfn:function(){ajaxify.go(`/post-queue/${m.id}`)}}),w.get("topic/quickreply/text").val(""),i._active.persona_qr.hide()})}}),w.get("topic/quickreply/expand").on("click",n=>{n.preventDefault();const a=w.get("topic/quickreply/text");r.newReply(ajaxify.data.tid,void 0,ajaxify.data.title,utils.escapeHTML(a.val())),a.val("")})},s}.apply(x,p),h!==void 0&&(S.exports=h)},10577:S=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var x=typeof window<"u"&&typeof window.document<"u"?window.document:{},u=S.exports,p=function(){for(var r,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],o=0,c=i.length,g={};o<c;o++)if(r=i[o],r&&r[1]in x){for(o=0;o<r.length;o++)g[i[0][o]]=r[o];return g}return!1}(),h={change:p.fullscreenchange,error:p.fullscreenerror},w={request:function(r,i){return new Promise(function(o,c){var g=function(){this.off("change",g),o()}.bind(this);this.on("change",g),r=r||x.documentElement;var v=r[p.requestFullscreen](i);v instanceof Promise&&v.then(g).catch(c)}.bind(this))},exit:function(){return new Promise(function(r,i){if(!this.isFullscreen){r();return}var o=function(){this.off("change",o),r()}.bind(this);this.on("change",o);var c=x[p.exitFullscreen]();c instanceof Promise&&c.then(o).catch(i)}.bind(this))},toggle:function(r,i){return this.isFullscreen?this.exit():this.request(r,i)},onchange:function(r){this.on("change",r)},onerror:function(r){this.on("error",r)},on:function(r,i){var o=h[r];o&&x.addEventListener(o,i,!1)},off:function(r,i){var o=h[r];o&&x.removeEventListener(o,i,!1)},raw:p};if(!p){u?S.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(w,{isFullscreen:{get:function(){return Boolean(x[p.fullscreenElement])}},element:{enumerable:!0,get:function(){return x[p.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(x[p.fullscreenEnabled])}}}),u?S.exports=w:window.screenfull=w})()}}]);

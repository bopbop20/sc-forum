"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9764,3564],{99764:(x,C,f)=>{var k,h;k=[f(50431),f(42441),f(85233),f(7927),f(18340)],h=function(m,S,c,y,v){const s={};s.populateTOC=function(){const n=$(".settings-header");if(n.length>1){n.each(function(){const a=$(this).text(),o=a.toLowerCase().replace(/ /g,"-").trim();$(this).prepend('<a name="'+o+'"></a>'),$(".section-content ul").append('<li><a href="#'+o+'">'+a+"</a></li>")});const i=$('a[name="'+window.location.hash.replace("#","")+'"]');i.length&&$("html, body").animate({scrollTop:i.offset().top+"px"},400)}else $(".content-header").parents(".row").remove()},s.prepare=function(n){const i=$("#content [data-field]"),a=i.length,o=$("#save"),u=$("#revert");let r,p,d,g;i.on("change",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const R=["text","hidden","password","textarea","number"];for(r=0;r<a;r+=1)if(g=i.eq(r),p=g.attr("data-field"),d=g.attr("type"),app.config.hasOwnProperty(p))if(g.is("input")&&d==="checkbox"){const A=parseInt(app.config[p],10)===1;g.prop("checked",A),g.parents(".mdl-switch").toggleClass("is-checked",A)}else(g.is("textarea")||g.is("select")||g.is("input")&&R.indexOf(d)!==-1)&&g.val(app.config[p]);u.off("click").on("click",function(){ajaxify.refresh()}),o.off("click").on("click",function(A){A.preventDefault(),v.check(document.querySelectorAll("#content [data-field]"))&&t(i,function(P){if(P)return y.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${P.message}]]`,type:"danger"});app.flags._unsaved=!1,y.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-saved]]",message:"[[admin/admin:changes-saved-message]]",type:"success"}),c.fire("action:admin.settingsSaved")})}),S.bind("ctrl+s",function(A){o.click(),A.preventDefault()}),l(),e(),$("#clear-sitemap-cache").off("click").on("click",function(){return socket.emit("admin.settings.clearSitemapCache",function(){y.success("Sitemap Cache Cleared!")}),!1}),typeof n=="function"&&n(),setTimeout(function(){c.fire("action:admin.settingsLoaded")},0)};function l(){$('#content input[data-action="upload"]').each(function(){const n=$(this);n.on("click",function(){m.show({title:n.attr("data-title"),description:n.attr("data-description"),route:n.attr("data-route"),params:{},showHelp:n.attr("data-help")?n.attr("data-help")===1:void 0,accept:n.attr("data-accept")},function(i){$("#"+n.attr("data-target")).val(i)})})})}function e(){$('[data-field-type="tagsinput"]').tagsinput({confirmKeys:[13,44],trimValue:!0}),app.flags._unsaved=!1}s.remove=function(n){socket.emit("admin.config.remove",n)};function t(n,i){const a={};n.each(function(){const o=$(this),u=o.attr("data-field");let r,p;if(o.is("input"))switch(p=o.attr("type"),p){case"text":case"password":case"hidden":case"textarea":case"number":r=o.val();break;case"checkbox":r=o.prop("checked")?"1":"0";break}else(o.is("textarea")||o.is("select"))&&(r=o.val());a[u]=r}),socket.emit("admin.config.setMultiple",a,function(o){if(o)return i(o);for(const u in a)a.hasOwnProperty(u)&&(app.config[u]=a[u]);i()})}return s}.apply(C,k),h!==void 0&&(x.exports=h)},18340:(x,C,f)=>{var k,h;k=[f(85233),f(7927)],h=function(m,S){let c,y=[],v=0,s;function l(e,t){typeof e!="string"&&(e=$(e),e=e.data("type")||e.attr("type")||e.prop("tagName"));const n=c.plugins[e.toLowerCase()];if(n==null)return;const i=n[t];return typeof i=="function"?i:null}return s={deepClone:function(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e},createElement:function(e,t,n){const i=document.createElement(e);for(const a in t)t.hasOwnProperty(a)&&i.setAttribute(a,t[a]);return n&&i.appendChild(document.createTextNode(n)),i},initElement:function(e){const t=l(e,"init");t?.call(c,$(e))},destructElement:function(e){const t=l(e,"destruct");t?.call(c,$(e))},createElementOfType:function(e,t,n){let i;const a=l(e,"create");return a!=null?i=$(a.call(c,e,t,n)):(n==null&&(n={}),e!=null&&(n.type=e),i=$(s.createElement(t||"input",n))),i.data("type",e),s.initElement(i),i},cleanArray:function(e,t,n){const i=[];if(!t&&n)return e;for(let a=0;a<e.length;a+=1){let o=e[a];t&&(o===!!o?o=+o:o&&typeof o.trim=="function"&&(o=o.trim())),(n||o!=null&&o.length)&&i.push(o)}return i},isTrue:function(e){return e==="true"||+e==1},isFalse:function(e){return e==="false"||+e==0},readValue:function(e){let t=!s.isFalse(e.data("empty"));const n=!s.isFalse(e.data("trim")),i=e.data("split"),a=l(e,"get");let o;if(a!=null)return a.call(c,e,n,t);if(i!=null){t=s.isTrue(e.data("empty")),o=e.val();const u=o!=null&&o.split(i||",")||[];return s.cleanArray(u,n,t)}if(o=e.val(),n&&o!=null&&typeof o.trim=="function"&&(o=o.trim()),t||o!==void 0&&(o==null||o.length!==0))return o},fillField:function(e,t){const n=l(e,"set");let i=e.data("trim");if(i=i!=="false"&&+i!=0,n!=null)return n.call(c,e,t,i);t instanceof Array&&(t=t.join(e.data("split")||(i?", ":","))),i&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),i&&(t=t.trim())):t="",t!==void 0&&e.val(t)},initFields:function(e){$("[data-key]",e).each(function(t,n){n=$(n);const i=l(n,"init"),a=n.data("key").split(".");let o=c.get();i?.call(c,n);for(let u=0;u<a.length;u+=1){const r=a[u];r&&o!=null&&(o=o[r])}s.fillField(n,o)})},registerReadyJobs:function(e){return v+=e,v},beforeReadyJobsDecreased:function(e){if(e==null&&(e=1),v>0&&(v-=e,v<=0)){for(let t=0;t<y.length;t+=1)y[t]();y=[]}},whenReady:function(e){v<=0?e():y.push(e)},serializeForm:function(e){const t=e.serializeObject();return e.find('input[type="checkbox"]').each(function(n,i){i=$(i),i.is(":checked")||(t[i.attr("name")]="off")}),e.find("select[multiple]").each(function(n,i){i=$(i),t[i.attr("name")]=JSON.stringify(i.val())}),t},persistSettings:function(e,t,n,i){t!=null&&t._!=null&&typeof t._!="string"&&(t=s.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:e,values:t},function(a){n&&(a?S.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${a.message}]]`,timeout:5e3}):S.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof i=="function"&&i(a)})},use:function(e){try{e._=JSON.parse(e._)}catch{}c.cfg=e}},c={helper:s,plugins:{},cfg:{},get:function(){return c.cfg!=null&&c.cfg._!==void 0?c.cfg._:c.cfg},registerPlugin:function(e,t){t==null?t=e.types:e.types=t,typeof e.use=="function"&&e.use.call(c);for(let n=0;n<t.length;n+=1){const i=t[n].toLowerCase();c.plugins[i]==null&&(c.plugins[i]=e)}},set:function(e,t,n,i,a){a==null&&(a=!0),s.whenReady(function(){s.use(t),s.initFields(n||"form"),s.persistSettings(e,t,a,i)})},sync:function(e,t,n){socket.emit("admin.settings.get",{hash:e},function(i,a){i?typeof n=="function"&&n(i):s.whenReady(function(){s.use(a),s.initFields(t||"form"),typeof n=="function"&&n()})})},persist:function(e,t,n,i){const a=[],o=$("[data-key]",t||"form").toArray();i==null&&(i=!0);for(let u=0;u<o.length;u+=1){const r=$(o[u]),p=s.readValue(r);let d=c.get();const g=r.data("key").split("."),R=g[g.length-1];if(g.length>1)for(let A=0;A<g.length-1;A+=1){const F=g[A];F&&d!=null&&(d=d[F])}d!=null?p!=null?d[R]=p:delete d[R]:a.push(r.data("key"))}a.length&&S.alert({title:"Attributes Not Saved",message:"'"+a.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),s.persistSettings(e,c.cfg,i,n)},load:function(e,t,n){n=n||function(){};const i=t.attr("data-socket-get");socket.emit(i||"admin.settings.get",{hash:e},function(a,o){if(a)return n(a);$(t).find("select[multiple]").each(function(r,p){const d=$(p).attr("name");if(d&&o.hasOwnProperty(d))try{o[d]=JSON.parse(o[d])}catch{}}),ajaxify.data[i?e:"settings"]=o,s.whenReady(function(){$(t).find("[data-sorted-list]").each(function(r,p){l(p,"get").call(c,$(p),e)})}),$(t).deserialize(o),$(t).find('input[type="checkbox"]').each(function(){$(this).parents(".mdl-switch").toggleClass("is-checked",$(this).is(":checked"))}),m.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const u=document.getElementById("save");u&&f.e(2441).then(function(){var r=[f(42441)];(function(p){p.bind("ctrl+s",function(d){u.click(),d.preventDefault()})}).apply(null,r)}).catch(f.oe),n(null,o)})},save:function(e,t,n){t=$(t);const i=t.get(0).elements;if(c.check(i)&&t.length){const o=s.serializeForm(t);s.whenReady(function(){const r=t.find("[data-sorted-list]");r.length&&r.each((p,d)=>{l(d,"set").call(c,$(d),o)})});const u=t.attr("data-socket-set");socket.emit(u||"admin.settings.set",{hash:e,values:o},function(r){app.flags._unsaved=!1,ajaxify.data[u?e:"settings"]=o,typeof n=="function"?n(r):r?S.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${r.message}]]`,type:"error",timeout:2500}):S.alert({title:"[[admin/admin:changes-saved]]",type:"success",timeout:2500})})}},check:function(e){const t=n=>{const i=n.target.closest(".form-group");i&&i.classList.add("has-error"),n.target.removeEventListener("invalid",t)};return Array.prototype.map.call(e,n=>{const i=n.closest(".form-group");return i&&i.classList.remove("has-error"),n.addEventListener("invalid",t),n.reportValidity()}).every(Boolean)}},s.registerReadyJobs(1),Promise.all([f.e(6177),f.e(2526),f.e(6069)]).then(function(){var e=[f(16631),f(73143),f(7448),f(15101),f(846),f(88839),f(53411),f(66370)];(function(){for(let t=0;t<arguments.length;t+=1)c.registerPlugin(arguments[t]);s.beforeReadyJobsDecreased()}).apply(null,e)}).catch(f.oe),c}.apply(C,k),h!==void 0&&(x.exports=h)},50431:(x,C,f)=>{var k,h;k=[f(86569)],h=function(){const m={};m.show=function(s,l){const e=s.hasOwnProperty("fileSize")&&s.fileSize!==void 0?parseInt(s.fileSize,10):!1;app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:s.hasOwnProperty("showHelp")&&s.showHelp!==void 0?s.showHelp:!0,fileSize:e,title:s.title||"[[global:upload_file]]",description:s.description||"",button:s.button||"[[global:upload]]",accept:s.accept?s.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const n=t.find("#uploadForm");n.attr("action",s.route),n.find("#params").val(JSON.stringify(s.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return S(t,e,l),!1})})},m.hideAlerts=function(s){$(s).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function S(s,l,e){c(s,"status","[[uploads:uploading-file]]"),s.find("#upload-progress-bar").css("width","0%"),s.find("#upload-progress-box").show().removeClass("hide");const t=s.find("#fileInput");if(!t.val())return c(s,"error","[[uploads:select-file-to-upload]]");if(!v(t[0],l))return c(s,"error","[[error:file-too-big, "+l+"]]");m.ajaxSubmit(s,e)}function c(s,l,e){m.hideAlerts(s),l==="error"&&s.find("#fileUploadSubmitBtn").removeClass("disabled"),s.find("#alert-"+l).translateText(e).removeClass("hide")}m.ajaxSubmit=function(s,l){s.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=y(t),c(s,"error",t.responseJSON?t.responseJSON.error||t.statusText:"error uploading, code : "+t.status)},uploadProgress:function(t,n,i,a){s.find("#upload-progress-bar").css("width",a+"%")},success:function(t){let n=y(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(n=t.response.images),l(n[0].url),c(s,"success","[[uploads:upload-success]]"),setTimeout(function(){m.hideAlerts(s),s.modal("hide")},750)}})};function y(s){if(typeof s=="string")try{return $.parseJSON(s)}catch{return{error:"[[error:parse-error]]"}}return s}function v(s,l){return window.FileReader&&l?s.files[0].size<=l*1e3:!0}return m}.apply(C,k),h!==void 0&&(x.exports=h)}}]);
